/*! For license information please see query.esm.js.LICENSE.txt */
!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/min/",r(r.s=275)}({0:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"e",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return c}));var n={SPREADSHEET:"spreadsheet",PROXY:"proxy",AODOCS:"aodocs",EXCEL:"ms_excel",_LEGACY:"legacy"},i={"google.com":"google.com",[n.SPREADSHEET]:"google.com",[n.PROXY]:"google.com",[n.AODOCS]:"google.com",[n.EXCEL]:"microsoft.com",[n._LEGACY]:"google.com"},o={TABLE:"Table",CARDS:"Cards",MAPS:"Maps",MAPS_WITH_TABLE:"MapsWithTable",GEOCHART:"Geochart",GANTT:"Gantt",BI:"BI",SLIDESHOW:"SlideShow",ORG_CHART:"OrgChart",_LEGACY:"legacy"},a={BOOLEAN:"BOOLEAN",ENUM:"ENUM",STRING:"STRING",NUMBER:"NUMBER",LIST:"LIST"},s={SPS_URL_NOT_VALID:"SPS_URL_NOT_VALID",BLACKLIST_IS_DISPLAYED:0},c={filtersChart:'{"d":"v","e":["filters","chart"]}',leftFiltersChart:'{"d":"h","e":["filters","chart"]}',chartFilters:'{"d":"v","e":["chart","filters"]}',mapFiltersTable:'{"d":"v","e":["map","filters","chart"]}',tableFiltersMap:'{"d":"v","e":["chart","filters","map"]}',filtersMapTable:'{"d":"v","e":["filters","map","chart"]}',filtersTableMap:'{"d":"v","e":["filters","chart","map"]}',leftFiltersMapTable:'{"d":"h","e":["filters",{"d":"v","e":["map","chart"]}]}',leftFiltersTableMap:'{"d":"h","e":["filters",{"d":"v","e":["chart","map"]}]}'}},1:function(e,t,r){"use strict";r.r(t),r.d(t,"CARDS_COLOR",(function(){return n})),r.d(t,"CARDS_CONTENT",(function(){return i})),r.d(t,"MAPS_LAT",(function(){return o})),r.d(t,"MAPS_LONG",(function(){return a})),r.d(t,"MAPS_TOOLTIP",(function(){return s})),r.d(t,"MAPS_MARKER",(function(){return c})),r.d(t,"TOOLTIP",(function(){return u})),r.d(t,"LATITUDE",(function(){return l})),r.d(t,"LONGITUDE",(function(){return d})),r.d(t,"GEOCHART_LOCATION",(function(){return h})),r.d(t,"GEOCHART_COLORS",(function(){return f})),r.d(t,"GEOCHART_MARKERS_SIZE",(function(){return p})),r.d(t,"GEOCHART_VALUE",(function(){return m})),r.d(t,"SLIDE_IMAGE",(function(){return g})),r.d(t,"SLIDE_LINK",(function(){return _})),r.d(t,"SLIDE_TITLE",(function(){return v})),r.d(t,"SLIDE_TEXT",(function(){return y})),r.d(t,"SLIDE_CONTENT",(function(){return b})),r.d(t,"BI_COUNT",(function(){return w})),r.d(t,"BI_TOP_RESULTS",(function(){return S})),r.d(t,"BI_WORD_CLOUD",(function(){return A})),r.d(t,"BI_COLUMN_CHART",(function(){return E})),r.d(t,"BI_AGGREGATE",(function(){return T})),r.d(t,"BI_BAR_CHART",(function(){return O})),r.d(t,"BI_LINE_CHART",(function(){return R})),r.d(t,"BI_AREA_CHART",(function(){return k})),r.d(t,"BI_HISTOGRAM",(function(){return I})),r.d(t,"BI_CANDLESTICK_CHART",(function(){return C})),r.d(t,"BI_PIE",(function(){return P})),r.d(t,"PIE_CHART",(function(){return D})),r.d(t,"DONUT_CHART",(function(){return x})),r.d(t,"DIMENSION_PIE_CHART",(function(){return N})),r.d(t,"DIMENSION_DONUT_CHART",(function(){return M})),r.d(t,"LINE_CHART",(function(){return L})),r.d(t,"SMOOTH_LINE_CHART",(function(){return j})),r.d(t,"COMBO_CHART",(function(){return U})),r.d(t,"BUBBLE_CHART",(function(){return F})),r.d(t,"COLUMN_CHART",(function(){return q})),r.d(t,"STACKED_COLUMN_CHART",(function(){return B})),r.d(t,"PERCENT_STACKED_COLUMN_CHART",(function(){return H})),r.d(t,"BAR_CHART",(function(){return G})),r.d(t,"STACKED_BAR_CHART",(function(){return V})),r.d(t,"PERCENT_STACKED_BAR_CHART",(function(){return W})),r.d(t,"AREA_CHART",(function(){return z})),r.d(t,"STACKED_AREA_CHART",(function(){return K})),r.d(t,"STEPPED_AREA_CHART",(function(){return Y})),r.d(t,"STACKED_STEPPED_AREA_CHART",(function(){return J})),r.d(t,"PERCENT_STACKED_AREA_CHART",(function(){return $})),r.d(t,"PERCENT_STACKED_STEPPED_AREA_CHART",(function(){return Q})),r.d(t,"SCATTER_CHART",(function(){return X})),r.d(t,"GANTT_GROUP",(function(){return Z})),r.d(t,"GANTT_LABEL",(function(){return ee})),r.d(t,"GANTT_TOOL_TIP",(function(){return te})),r.d(t,"GANTT_START_DATE",(function(){return re})),r.d(t,"GANTT_END_DATE",(function(){return ne})),r.d(t,"COLUMN_ROLE_HIDDEN",(function(){return ie})),r.d(t,"COLUMN_ROLE_SIDEBAR",(function(){return oe})),r.d(t,"DATA_CSV",(function(){return ae})),r.d(t,"TYPE_POPUP",(function(){return se})),r.d(t,"TYPE_HYPERLINK",(function(){return ce})),r.d(t,"TYPE_IMAGE",(function(){return ue})),r.d(t,"TYPE_ICON",(function(){return le})),r.d(t,"TYPE_RATING",(function(){return de})),r.d(t,"TYPE_BUTTON",(function(){return he})),r.d(t,"TYPE_LIST",(function(){return fe})),r.d(t,"TYPE_NUMBEREDLIST",(function(){return pe})),r.d(t,"TYPE_COLOR",(function(){return me})),r.d(t,"FILTER_NONE",(function(){return ge})),r.d(t,"FILTER_NUMBERRANGE",(function(){return _e})),r.d(t,"FILTER_DATE",(function(){return ve})),r.d(t,"FILTER_DATERANGE",(function(){return ye})),r.d(t,"FILTER_STRING",(function(){return be})),r.d(t,"FILTER_CATEGORY",(function(){return we})),r.d(t,"FILTER_CSV",(function(){return Se})),r.d(t,"FILTER_CSV_OR",(function(){return Ae})),r.d(t,"FILTER_CSV_AND",(function(){return Ee})),r.d(t,"ORG_CHART_NAME",(function(){return Te})),r.d(t,"ORG_CHART_REPORTS_TO",(function(){return Oe})),r.d(t,"ORG_CHART_CARD_CONTENT",(function(){return Re}));var n="cardscolor",i="cardscontent",o="mapslat",a="mapslong",s="mapstooltip",c="mapsmarker",u="tooltip",l="latitude",d="longitude",h="geochartlocation",f="geochartcolor",p="geochartmarkersize",m="geochartvalue",g="slideimage",_="slidelink",v="slidetitle",y="slidetext",b="slidecontent",w="bicount",S="bitopresults",A="biwordcloud",E="bicolumnchart",T="biaggregate",O="bibarchart",R="bilinechart",k="biareachart",I="histogram",C="waterfallchart",P="bipie",D="piechart",x="donutchart",N="3dpiechart",M="3ddonutchart",L="linechart",j="smoothlinechart",U="combochart",F="bubblechart",q="columnchart",B="stackedcolumnchart",H="100stackedcolumnchart",G="barchart",V="stackedbarchart",W="100stackedbarchart",z="areachart",K="stackedareachart",Y="steppedareachart",J="stackedsteppedareachart",$="100stackedareachart",Q="100stackedsteppedareachart",X="scatterchart",Z="ganttgroup",ee="ganttlabel",te="gantttooltip",re="ganttstartdate",ne="ganttenddate",ie="hidden",oe="sidebar",ae="csvdata",se="popuptype",ce="hyperlinktype",ue="imagetype",le="icontype",de="ratingtype",he="buttontype",fe="listtype",pe="numberedlisttype",me="colortype",ge="nofilter",_e="numberrangefilter",ve="datefilter",ye="daterangefilter",be="stringfilter",we="categoryfilter",Se={name:"csvfilter",regex:"csvfilter(?!or)(?!and)"},Ae="csvfilteror",Ee="csvfilterand",Te="orgchartname",Oe="orgchartparent",Re="cardscontent"},10:function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var c,u=[],l=!1,d=-1;function h(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&f())}function f(){if(!l){var e=s(h);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||l||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},11:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"j",(function(){return f})),r.d(t,"i",(function(){return p})),r.d(t,"h",(function(){return m})),r.d(t,"g",(function(){return g}));var n=r(2),i="Awesome Table Graph API",o="microsoftAzure",a="/redirect",s=n.b.ms_client_id,c={AUTH:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",GRANT:"https://login.microsoftonline.com/common/oauth2/v2.0/token"},u="https://graph.microsoft.com/v1.0/",l="user.read",d="offline_access",h="files.read.all",f=[l,d],p=[l,h,d],m=[l,h,"files.readwrite.all"],g={ADMIN_CONSENT:"admin_consent",CONSENT:"consent",LOGIN:"login",NONE:"none",SELECT_ACCOUNT:"select_account"}},12:function(e,t,r){"use strict";r.d(t,"e",(function(){return n})),r.d(t,"g",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"d",(function(){return s})),r.d(t,"h",(function(){return c})),r.d(t,"a",(function(){return u})),r.d(t,"c",(function(){return l}));var n=["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/spreadsheets","https://spreadsheets.google.com/feeds"],i=["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://spreadsheets.google.com/feeds"],o="offline_access",a="google";const s="56088344336-mes14nget7f5jb0pfmi0scngbb82l0qa.apps.googleusercontent.com",c="https://api.awesome-table.com",u="https://awesometable-billing.appspot.com",l="https://us-central1-awesome-table-server.cloudfunctions.net/loggerService"},15:function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(n){"object"==typeof window&&(r=window)}e.exports=r},151:function(e,t,r){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},152:function(e,t,r){"use strict";var n=r(20);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var a=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},153:function(e,t,r){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},154:function(e,t,r){"use strict";(function(t){var n=r(20),i=r(260),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(s=r(155)),s),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){c.headers[e]=n.merge(o)})),e.exports=c}).call(this,r(10))},155:function(e,t,r){"use strict";var n=r(20),i=r(261),o=r(263),a=r(152),s=r(264),c=r(267),u=r(268),l=r(156);e.exports=function(e){return new Promise((function(t,r){var d=e.data,h=e.headers;n.isFormData(d)&&delete h["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";h.Authorization="Basic "+btoa(p+":"+m)}var g=s(e.baseURL,e.url);if(f.open(e.method.toUpperCase(),a(g,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?c(f.getAllResponseHeaders()):null,o={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};i(t,r,o),f=null}},f.onabort=function(){f&&(r(l("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){r(l("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(l(t,e,"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var _=(e.withCredentials||u(g))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;_&&(h[e.xsrfHeaderName]=_)}if("setRequestHeader"in f&&n.forEach(h,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete h[t]:f.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),e.responseType)try{f.responseType=e.responseType}catch(v){if("json"!==e.responseType)throw v}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),r(e),f=null)})),d||(d=null),f.send(d)}))}},156:function(e,t,r){"use strict";var n=r(262);e.exports=function(e,t,r,i,o){var a=new Error(e);return n(a,t,r,i,o)}},157:function(e,t,r){"use strict";var n=r(20);e.exports=function(e,t){t=t||{};var r={},i=["url","method","data"],o=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function c(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function u(i){n.isUndefined(t[i])?n.isUndefined(e[i])||(r[i]=c(void 0,e[i])):r[i]=c(e[i],t[i])}n.forEach(i,(function(e){n.isUndefined(t[e])||(r[e]=c(void 0,t[e]))})),n.forEach(o,u),n.forEach(a,(function(i){n.isUndefined(t[i])?n.isUndefined(e[i])||(r[i]=c(void 0,e[i])):r[i]=c(void 0,t[i])})),n.forEach(s,(function(n){n in t?r[n]=c(e[n],t[n]):n in e&&(r[n]=c(void 0,e[n]))}));var l=i.concat(o).concat(a).concat(s),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===l.indexOf(e)}));return n.forEach(d,u),r}},158:function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},161:function(e,t,r){e.exports=r(255)},17:function(e,t,r){"use strict";var n=function(e,t){var r={},n=r.lib={},i=function(){},o=n.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=n.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var i=0;i<e;i++)t[n+i>>>2]|=(r[i>>>2]>>>24-i%4*8&255)<<24-(n+i)%4*8;else if(65535<r.length)for(i=0;i<e;i+=4)t[n+i>>>2]=r[i>>>2];else t.push.apply(t,r);return this.sigBytes+=e,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r=[],n=0;n<t;n+=4)r.push(4294967296*e.random()|0);return new a.init(r,t)}}),s=r.enc={},c=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;n<e;n++){var i=t[n>>>2]>>>24-n%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(r,t/2)}};s.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp(),e=[];for(var i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;4>a&&i+.75*a<r;a++)e.push(n.charAt(o>>>6*(3-a)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,r=this._map;(n=r.charAt(64))&&(-1!=(n=e.indexOf(n))&&(t=n));for(var n=[],i=0,o=0;o<t;o++)if(o%4){var a=r.indexOf(e.charAt(o-1))<<o%4*2,s=r.indexOf(e.charAt(o))>>>6-o%4*2;n[i>>>2]|=(a|s)<<24-i%4*8,i++}return WordArray.create(n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};var u=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],n=0;n<e;n++)r.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return r.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(r,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},d=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,o=this.blockSize,s=i/(4*o);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,i=e.min(4*t,i),t){for(var c=0;c<t;c+=o)this._doProcessBlock(n,c);c=n.splice(0,t),r.sigBytes-=i}return new a.init(c,i)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});n.Hasher=d.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new h.HMAC.init(e,r).finalize(t)}}});var h=r.algo={};return r}(Math);!function(e){for(var t=n,r=(o=t.lib).WordArray,i=o.Hasher,o=t.algo,a=[],s=[],c=function(e){return 4294967296*(e-(0|e))|0},u=2,l=0;64>l;){var d;e:{d=u;for(var h=e.sqrt(d),f=2;f<=h;f++)if(!(d%f)){d=!1;break e}d=!0}d&&(8>l&&(a[l]=c(e.pow(u,.5))),s[l]=c(e.pow(u,1/3)),l++),u++}var p=[];o=o.SHA256=i.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],c=r[4],u=r[5],l=r[6],d=r[7],h=0;64>h;h++){if(16>h)p[h]=0|e[t+h];else{var f=p[h-15],m=p[h-2];p[h]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+p[h-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+p[h-16]}f=d+((c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25))+(c&u^~c&l)+s[h]+p[h],m=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&i^n&o^i&o),d=l,l=u,u=c,c=a+f|0,a=o,o=i,i=n,n=f+m|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+c|0,r[5]=r[5]+u|0,r[6]=r[6]+l|0,r[7]=r[7]+d|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(o),t.HmacSHA256=i._createHmacHelper(o)}(Math),t.a=n},18:function(e,t,r){"use strict";function n(e){for(var t="",r=0,n=0;n<6&&(0==(r=e%26)?(t="Z"+t,e=e/26-1):(t=String.fromCharCode(64+r)+t,e=(e-r)/26),!(e<=0));n++);return t}function i(e){return(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function o(e,t,r){r=r||"GET";var n=null,i={};t&&"body"in t&&(n="string"==typeof t.body?t.body:JSON.stringify(t.body),delete t.body),t&&"headers"in t&&(i=t.headers,delete t.headers);var o=[];for(var a in t)t.hasOwnProperty(a)&&o.push("".concat(a,"=").concat(t[a]));var s=o.join("&");return new Promise((function(t,o){var a=new XMLHttpRequest;for(var c in a.open(r,e+(s&&(-1!==e.indexOf("?")?"&":"?")+s||"")),i)a.setRequestHeader(c,i[c]);a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE)if(a.responseText){var e;try{e=JSON.parse(a.responseText)}catch(r){e=a.responseText}t(e)}else o()},a.send(n)}))}function a(e){return(e<10?"0":"")+e}r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return a}))},2:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));const n={apiKey:"AIzaSyAPCgK_J99eBCsm0Ub6vnivt3_GVFcXqVM",probeApiKey:"AIzaSyBDId7dThnefJgka1uaGBdxSe-cjoCZyL0",drivePickerApiKey:"AIzaSyBuWzhHYV2jlP2IohuLqGnh8Re9qyHXIKA",rootDomain:"awesome-table",rootDomainComplete:"app.awesome-table.com",authDomain:"app.awesome-table.com",viewDomainComplete:"view-awesome-table.com",domainProtocol:"https://",gaPrefix:"",mapsApiConfig:{key:"AIzaSyBPUXgscOP1VyMgpZWPWR1xCHnKIn4_9fQ"},beamer:{segment:""},stripeJsApiConfig:{key:"pk_live_ZIRAXuX7OUAEM25pCyQmWmiJ"},links:{pricing:"https://awesome-table.com/pricing",termsOfService:"https://awesome-table.com/terms-of-service",privacyPolicy:"https://awesome-table.com/privacy-policy"},module:!0},i={ms_client_id:"82434634-75ef-43e7-ac03-f8b2ae09b5e7",ms_oauth_proxy_url:"https://us-central1-awesometable-dev.cloudfunctions.net/oauthproxy"};n.viewDomainHost=n.viewDomainComplete.split("/")[0],n.rootSite=n.domainProtocol+n.rootDomainComplete,n.viewSite=n.domainProtocol+n.viewDomainComplete,n.authDomain=n.authDomain||null,n.beamerProductID=n.beamer.productID||"AZasvKVc19194",n.beamerSegment=n.beamer.segment||"",n.drivePickerApiKey=n.drivePickerApiKey||{key:"AIzaSyBuWzhHYV2jlP2IohuLqGnh8Re9qyHXIKA"},n.mapsApiConfig=n.mapsApiConfig||{key:"AIzaSyBPUXgscOP1VyMgpZWPWR1xCHnKIn4_9fQ"},n.probeApiKey=n.probeApiKey||n.apiKey,n.stripeJsApiConfig=n.stripeJsApiConfig||{key:"pk_test_ZFTe1NKHFl6uLoWIka22IyYd"},n.links=n.links,t.a=n},20:function(e,t,r){"use strict";var n=r(151),i=Object.prototype.toString;function o(e){return"[object Array]"===i.call(e)}function a(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===i.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isPlainObject:c,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:u,isStream:function(e){return s(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:l,merge:function e(){var t={};function r(r,n){c(t[n])&&c(r)?t[n]=e(t[n],r):c(r)?t[n]=e({},r):o(r)?t[n]=r.slice():t[n]=r}for(var n=0,i=arguments.length;n<i;n++)l(arguments[n],r);return t},extend:function(e,t,r){return l(t,(function(t,i){e[i]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},24:function(e,t,r){"use strict";var n,i,o,a,s,c,u=r(17),l=r(2),d=!1;n=window,i=document,o="script",a="ga",d||(d=!0,n.GoogleAnalyticsObject=a,n.ga=n.ga||function(){(n.ga.q=n.ga.q||[]).push(arguments)},n.ga.l=1*new Date,s=i.createElement(o),c=i.getElementsByTagName(o)[0],s.async=1,s.src="https://www.google-analytics.com/analytics.js",c.parentNode.insertBefore(s,c));class h{constructor(e,t){this.name=t,ga("create",e,"auto",{name:this.name})}setUserId(e){ga(this.name+".set","userId",function(e){return u.a.SHA256(e).toString(u.a.enc.Base64)}(e))}setCustomD(e){ga(this.name+".set",e)}sendStats(e,t){e.action||e.category||(t=e,e=void 0),t=t||{},e&&e.category&&(t.eventCategory=e.category),e&&e.action&&(t.eventAction=e.action),t.hitType||(t.hitType="event"),t.eventLabel||(t.eventLabel=l.a.rootDomain),ga(this.name+".send",t)}sendPageView(){if(this._lastLocation!==window.location.href){this._lastLocation=window.location.href;var e={hitType:"pageview",location:window.location.href,page:window.location.pathname.replace(/\/([^\/]+)\/(?:edit|settings|view|preview|print)/,(e,t)=>e.replace(t,"$VIEWID"))};ga(this.name+".send",e)}}sendTiming(e,t){if(e.hitType="timing",t)for(var r in t)e[r]=t[r];ga(this.name+".send",e)}static getTemplateUsage(e){if(!e)return"none";var t=e.split("!");return 1===(t=t[t.length-1].split(":")).length||t[0]===t[1]?"basic":"advanced"}}h.EVENT={creation:{category:"creation",action:"new"},edition:{category:"edition",action:"normal"},suppression:{category:"suppression",action:"normal"},clickRateApp:{category:"clickToast",action:"rateApp"},clickInstallApp:{category:"clickToast",action:"installApp"},showRateApp:{category:"showToast",action:"rateApp"},showInstallApp:{category:"showToast",action:"installApp"}},t.a=h},25:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i}));var n={GOOGLE:"google",MICROSOFT:"microsoft"},i=2592e6},255:function(e,t,r){"use strict";var n=r(20),i=r(151),o=r(256),a=r(157);function s(e){var t=new o(e),r=i(o.prototype.request,t);return n.extend(r,o.prototype,t),n.extend(r,t),r}var c=s(r(154));c.Axios=o,c.create=function(e){return s(a(c.defaults,e))},c.Cancel=r(158),c.CancelToken=r(269),c.isCancel=r(153),c.all=function(e){return Promise.all(e)},c.spread=r(270),c.isAxiosError=r(271),e.exports=c,e.exports.default=c},256:function(e,t,r){"use strict";var n=r(20),i=r(152),o=r(257),a=r(258),s=r(157);function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},c.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,r){return this.request(s(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,r,n){return this.request(s(n||{},{method:e,url:t,data:r}))}})),e.exports=c},257:function(e,t,r){"use strict";var n=r(20);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},258:function(e,t,r){"use strict";var n=r(20),i=r(259),o=r(153),a=r(154);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(s(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},259:function(e,t,r){"use strict";var n=r(20);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},26:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e){e=e||{},this.data={},this.data.dataTable=e.data&&e.data.dataTable||null,this.data.signature=e.data&&e.data.signature||null,this.settings={columns:e.settings&&e.settings.columns||{},signature:e.settings&&e.settings.signature||""},this.template={templates:e.template&&e.template.templates||[],signature:e.template&&e.template.signature||null,onlyDisplay:e.template&&e.template.onlyDisplay||null,noAutoAdd:!e.template||void 0===e.template.noAutoAdd||e.template.noAutoAdd}}get hasData(){return this.data&&!!this.data.dataTable}get hasTemplate(){return this.template&&this.template.templates&&!!this.template.templates.length}}},260:function(e,t,r){"use strict";var n=r(20);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},261:function(e,t,r){"use strict";var n=r(156);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},262:function(e,t,r){"use strict";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},263:function(e,t,r){"use strict";var n=r(20);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},264:function(e,t,r){"use strict";var n=r(265),i=r(266);e.exports=function(e,t){return e&&!n(t)?i(e,t):t}},265:function(e,t,r){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},266:function(e,t,r){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},267:function(e,t,r){"use strict";var n=r(20),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,a={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}})),a):a}},268:function(e,t,r){"use strict";var n=r(20);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},269:function(e,t,r){"use strict";var n=r(158);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},27:function(e,t,r){(function(n,i){var o;Object.create||(Object.create=function(){function e(){}return function(t){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Object.keys||(Object.keys=function(e,t,r){for(t in r=[],e)r.hasOwnProperty.call(e,t)&&r.push(t);return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(null==this)throw new TypeError;var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var n=arguments.length>=2?arguments[1]:void 0,i=0;i<r;i++)i in t&&e.call(n,t[i],i,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var r=[];return this.forEach((function(n,i,o){e.call(t||void 0,n,i,o)&&r.push(n)})),r}),Array.prototype.map||(Array.prototype.map=function(e,t){var r=[];return this.forEach((function(n,i,o){r.push(e.call(t||void 0,n,i,o))})),r}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"object"!=typeof window||"object"!=typeof window.location||window.location.assign||(window.location.assign=function(e){window.location=e}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function t(){}var r=[].slice,n=r.call(arguments,1),i=this,o=function(){return i.apply(this instanceof t?this:e||window,n.concat(r.call(arguments)))};return t.prototype=this.prototype,o.prototype=new t,o});var a=function e(t){return e.use(t)};(a.utils={extend:function(e){return Array.prototype.slice.call(arguments,1).forEach((function(t){if(Array.isArray(e)&&Array.isArray(t))Array.prototype.push.apply(e,t);else if(e&&(e instanceof Object||"object"==typeof e)&&t&&(t instanceof Object||"object"==typeof t)&&e!==t)for(var r in t)e[r]=a.utils.extend(e[r],t[r]);else Array.isArray(t)&&(t=t.slice(0)),e=t})),e}}).extend(a,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(e){var t=Object.create(this);return t.settings=Object.create(this.settings),e&&(t.settings.default_service=e),t.utils.Event.call(t),t},init:function(e,t){var r=this.utils;if(!e)return this.services;for(var n in e)e.hasOwnProperty(n)&&"object"!=typeof e[n]&&(e[n]={id:e[n]});return r.extend(this.services,e),t&&(r.extend(this.settings,t),"redirect_uri"in t&&(this.settings.redirect_uri=r.url(t.redirect_uri).href)),this},login:function(){var e,t=this,r=t.utils,n=r.error,i=r.Promise(),o=r.args({network:"s",options:"o",callback:"f"},arguments),s=r.diffKey(o.options,t.settings),c=o.options=r.merge(t.settings,o.options||{});function u(e,t){a.emit(e,t)}if(c.popup=r.merge(t.settings.popup,o.options.popup||{}),o.network=o.network||t.settings.default_service,i.proxy.then(o.callback,o.callback),i.proxy.then(u.bind(this,"auth.login auth"),u.bind(this,"auth.failed auth")),"string"!=typeof o.network||!(o.network in t.services))return i.reject(n("invalid_network","The provided network was not recognized"));var l=t.services[o.network],d=r.globalEvent((function(e){e?"string"==typeof e&&(e=JSON.parse(e)):e=n("cancelled","The authentication was not completed"),e.error?i.reject(e):(r.store(e.network,e),i.fulfill({network:e.network,authResponse:e}))})),h=r.url(c.redirect_uri).href,f=l.oauth.response_type||c.response_type;/\bcode\b/.test(f)&&!l.oauth.grant&&(f=f.replace(/\bcode\b/,"token")),o.qs=r.merge(s,{client_id:encodeURIComponent(l.id),response_type:encodeURIComponent(f),redirect_uri:encodeURIComponent(h),state:{client_id:l.id,network:o.network,display:c.display,callback:d,state:c.state,redirect_uri:h}});var p=r.store(o.network),m=/[,\s]+/,g=t.settings.scope?[t.settings.scope.toString()]:[],_=r.merge(t.settings.scope_map,l.scope||{});if(c.scope&&g.push(c.scope.toString()),p&&"scope"in p&&p.scope instanceof String&&g.push(p.scope),g=g.join(",").split(m),g=r.unique(g).filter(S),o.qs.state.scope=g.join(","),g=(g=g.map((function(e){return e in _?_[e]:e}))).join(",").split(m),g=r.unique(g).filter(S),o.qs.scope=g.join(l.scope_delim||","),!1===c.force&&p&&"access_token"in p&&p.access_token&&"expires"in p&&p.expires>(new Date).getTime()/1e3){var v=r.diff((p.scope||"").split(m),(o.qs.state.scope||"").split(m));if(0===v.length)return i.fulfill({unchanged:!0,network:o.network,authResponse:p}),i}if("page"===c.display&&c.page_uri&&(o.qs.state.page_uri=r.url(c.page_uri).href),"login"in l&&"function"==typeof l.login&&l.login(o),(!/\btoken\b/.test(f)||parseInt(l.oauth.version,10)<2||"none"===c.display&&l.oauth.grant&&p&&p.refresh_token)&&(o.qs.state.oauth=l.oauth,o.qs.state.oauth_proxy=c.oauth_proxy),o.qs.state=encodeURIComponent(JSON.stringify(o.qs.state)),1===parseInt(l.oauth.version,10)?e=r.qs(c.oauth_proxy,o.qs,w):"none"===c.display&&l.oauth.grant&&p&&p.refresh_token?(o.qs.refresh_token=p.refresh_token,e=r.qs(c.oauth_proxy,o.qs,w)):e=r.qs(l.oauth.auth,o.qs,w),u("auth.init",o),"none"===c.display)r.iframe(e,h);else if("popup"===c.display)var y=r.popup(e,h,c.popup),b=setInterval((function(){if((!y||y.closed)&&(clearInterval(b),!i.state)){var e=n("cancelled","Login has been cancelled");y||(e=n("blocked","Popup was blocked")),e.network=o.network,i.reject(e)}}),100);else window.location=e;return i.proxy;function w(e){return e}function S(e){return!!e}},logout:function(){var e=this,t=e.utils,r=t.error,n=t.Promise(),i=t.args({name:"s",options:"o",callback:"f"},arguments);function o(e,t){a.emit(e,t)}if(i.options=i.options||{},n.proxy.then(i.callback,i.callback),n.proxy.then(o.bind(this,"auth.logout auth"),o.bind(this,"error")),i.name=i.name||this.settings.default_service,i.authResponse=t.store(i.name),i.name&&!(i.name in e.services))n.reject(r("invalid_network","The network was unrecognized"));else if(i.name&&i.authResponse){var s=function(e){t.store(i.name,null),n.fulfill(a.utils.merge({network:i.name},e||{}))},c={};if(i.options.force){var u=e.services[i.name].logout;if(u)if("function"==typeof u&&(u=u(s,i)),"string"==typeof u)t.iframe(u),c.force=null,c.message="Logout success on providers site was indeterminate";else if(void 0===u)return n.proxy}s(c)}else n.reject(r("invalid_session","There was no session to remove"));return n.proxy},getAuthResponse:function(e){return(e=e||this.settings.default_service)&&e in this.services&&this.utils.store(e)||null},events:{}}),a.utils.extend(a.utils,{error:function(e,t){return{error:{code:e,message:t}}},qs:function(e,t,r){if(t)for(var n in r=r||encodeURIComponent,t){var i=new RegExp("([\\?\\&])"+n+"=[^\\&]*");e.match(i)&&(e=e.replace(i,"$1"+n+"="+r(t[n])),delete t[n])}return this.isEmpty(t)?e:e+(e.indexOf("?")>-1?"&":"?")+this.param(t,r)},param:function(e,t){var r,n,i={};if("string"==typeof e){if(t=t||decodeURIComponent,n=e.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var o=0;o<n.length;o++)i[(r=n[o].match(/([^=]+)=(.*)/))[1]]=t(r[2]);return i}t=t||encodeURIComponent;var a=e;for(var s in i=[],a)a.hasOwnProperty(s)&&a.hasOwnProperty(s)&&i.push([s,"?"===a[s]?"?":t(a[s])].join("="));return i.join("&")},store:function(){for(var e,t=["localStorage","sessionStorage"],r=-1;t[++r];)try{(e=window[t[r]]).setItem("test"+r,r),e.removeItem("test"+r);break}catch(i){e=null}if(!e){var n=null;e={getItem:function(e){e+="=";for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var i=t[r].replace(/(^\s+|\s+$)/,"");if(i&&0===i.indexOf(e))return i.substr(e.length)}return n},setItem:function(e,t){n=t,document.cookie=e+"="+t}},n=e.getItem("hello")}return function(t,r,n){var o=function(){var t={};try{t=JSON.parse(e.getItem("hello"))||{}}catch(i){}return t}();if(t&&void 0===r)return o[t]||null;if(t&&null===r)try{delete o[t]}catch(i){o[t]=null}else{if(!t)return o;o[t]=r}return function(t){e.setItem("hello",JSON.stringify(t))}(o),o||null}}(),append:function(e,t,r){var n="string"==typeof e?document.createElement(e):e;if("object"==typeof t)if("tagName"in t)r=t;else for(var i in t)if(t.hasOwnProperty(i))if("object"==typeof t[i])for(var o in t[i])t[i].hasOwnProperty(o)&&(n[i][o]=t[i][o]);else"html"===i?n.innerHTML=t[i]:/^on/.test(i)?n[i]=t[i]:n.setAttribute(i,t[i]);return"body"===r?function e(){document.body?document.body.appendChild(n):setTimeout(e,16)}():"object"==typeof r?r.appendChild(n):"string"==typeof r&&document.getElementsByTagName(r)[0].appendChild(n),n},iframe:function(e){this.append("iframe",{src:e,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},args:function(e,t){var r={},n=0,i=null,o=null;for(o in e)if(e.hasOwnProperty(o))break;if(1===t.length&&"object"==typeof t[0]&&"o!"!=e[o])for(o in t[0])if(e.hasOwnProperty(o)&&o in e)return t[0];for(o in e)if(e.hasOwnProperty(o))if(i=typeof t[n],"function"==typeof e[o]&&e[o].test(t[n])||"string"==typeof e[o]&&(e[o].indexOf("s")>-1&&"string"===i||e[o].indexOf("o")>-1&&"object"===i||e[o].indexOf("i")>-1&&"number"===i||e[o].indexOf("a")>-1&&"object"===i||e[o].indexOf("f")>-1&&"function"===i))r[o]=t[n++];else if("string"==typeof e[o]&&e[o].indexOf("!")>-1)return!1;return r},url:function(e){if(e){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(e,window.location);var t=document.createElement("a");return t.href=e,t.cloneNode(!1)}return window.location},diff:function(e,t){return t.filter((function(t){return-1===e.indexOf(t)}))},diffKey:function(e,t){if(e||!t){var r={};for(var n in e)n in t||(r[n]=e[n]);return r}return e},unique:function(e){return Array.isArray(e)?e.filter((function(t,r){return e.indexOf(t)===r})):[]},isEmpty:function(e){if(!e)return!0;if(Array.isArray(e))return!e.length;if("object"==typeof e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},Promise:function(){var e=function e(t){if(!(this instanceof e))return new e(t);this.id="Thenable/1.0.6",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},"function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this))};e.prototype={fulfill:function(e){return t(this,1,"fulfillValue",e)},reject:function(e){return t(this,2,"rejectReason",e)},then:function(t,n){var i=new e;return this.onFulfilled.push(a(t,i,"fulfill")),this.onRejected.push(a(n,i,"reject")),r(this),i.proxy}};var t=function(e,t,n,i){return 0===e.state&&(e.state=t,e[n]=i,r(e)),e},r=function(e){1===e.state?o(e,"onFulfilled",e.fulfillValue):2===e.state&&o(e,"onRejected",e.rejectReason)},o=function(e,t,r){if(0!==e[t].length){var o=e[t];e[t]=[];var a=function(){for(var e=0;e<o.length;e++)o[e](r)};"object"==typeof n&&"function"==typeof n.nextTick?n.nextTick(a):"function"==typeof i?i(a):setTimeout(a,0)}},a=function(e,t,r){return function(n){if("function"!=typeof e)t[r].call(t,n);else{var i;try{i=e(n)}catch(o){return void t.reject(o)}s(t,i)}}},s=function e(t,r){if(t!==r&&t.proxy!==r){var n;if("object"==typeof r&&null!==r||"function"==typeof r)try{n=r.then}catch(o){return void t.reject(o)}if("function"!=typeof n)t.fulfill(r);else{var i=!1;try{n.call(r,(function(n){i||(i=!0,n===r?t.reject(new TypeError("circular thenable chain")):e(t,n))}),(function(e){i||(i=!0,t.reject(e))}))}catch(o){i||t.reject(o)}}}else t.reject(new TypeError("cannot resolve promise with itself"))};return e}(),Event:function(){var e=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(t,r){if(r&&"function"==typeof r)for(var n=t.split(e),i=0;i<n.length;i++)this.events[n[i]]=[r].concat(this.events[n[i]]||[]);return this},this.off=function(e,t){return this.findEvents(e,(function(e,r){t&&this.events[e][r]!==t||(this.events[e][r]=null)})),this},this.emit=function(e){var t=Array.prototype.slice.call(arguments,1);t.push(e);for(var r=function(r,n){t[t.length-1]="*"===r?e:r,this.events[r][n].apply(this,t)},n=this;n&&n.findEvents;)n.findEvents(e+",*",r),n=n.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout((function(){e.emit.apply(e,t)}),0),this},this.findEvents=function(t,r){var n=t.split(e);for(var i in this.events)if(this.events.hasOwnProperty(i)&&n.indexOf(i)>-1)for(var o=0;o<this.events[i].length;o++)this.events[i][o]&&r.call(this,i,o)},this},globalEvent:function(e,t){return t=t||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[t]=function(){try{e.apply(this,arguments)&&delete window[t]}catch(r){}},t},popup:function(e,t,r){var n=document.documentElement;if(r.height&&void 0===r.top){var i=void 0!==window.screenTop?window.screenTop:screen.top,o=screen.height||window.innerHeight||n.clientHeight;r.top=parseInt((o-r.height)/2,10)+i}if(r.width&&void 0===r.left){var a=void 0!==window.screenLeft?window.screenLeft:screen.left,s=screen.width||window.innerWidth||n.clientWidth;r.left=parseInt((s-r.width)/2,10)+a}var c=[];Object.keys(r).forEach((function(e){var t=r[e];c.push(e+(null!==t?"="+t:""))})),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(e=t+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(e)));var u=window.open(e,"_blank",c.join(","));return u&&u.focus&&u.focus(),u},responseHandler:function(e,t){var r,n=this,i=e.location;if((r=n.param(i.search))&&r.state&&(r.code||r.oauth_token)){var o=JSON.parse(r.state);r.redirect_uri=o.redirect_uri||i.href.replace(/[\?\#].*$/,"");var a=n.qs(o.oauth_proxy,r);i.assign(a)}else if((r=n.merge(n.param(i.search||""),n.param(i.hash||"")))&&"state"in r){try{var s=JSON.parse(r.state);n.extend(r,s)}catch(g){var c=decodeURIComponent(r.state);try{var u=JSON.parse(c);n.extend(r,u)}catch(g){}}if("access_token"in r&&r.access_token&&r.network)r.expires_in&&0!==parseInt(r.expires_in,10)||(r.expires_in=0),r.expires_in=parseInt(r.expires_in,10),r.expires=(new Date).getTime()/1e3+(r.expires_in||31536e3),f(r,e,t);else if("error"in r&&r.error&&r.network)r.error={code:r.error,message:r.error_message||r.error_description},f(r,e,t);else if(r.callback&&r.callback in t){var l=!(!("result"in r)||!r.result)&&JSON.parse(r.result);p(t,r.callback)(l),m()}r.page_uri&&h(r.page_uri)&&i.assign(r.page_uri)}else if("oauth_redirect"in r){var d=decodeURIComponent(r.oauth_redirect);return void(h(d)&&i.assign(d))}function h(e){return/^https?:/.test(e)}function f(e,t,r){var i=e.callback,o=e.network;if(n.store(o,e),!("display"in e)||"page"!==e.display){if(r&&i&&i in r){try{delete e.callback}catch(g){}n.store(o,e);var a=JSON.stringify(e);try{p(r,i)(a)}catch(g){}}m()}}function p(e,t){return 0!==t.indexOf("_hellojs_")?function(){throw"Could not execute callback "+t}:e[t]}function m(){if(e.frameElement)t.document.body.removeChild(e.frameElement);else{try{e.close()}catch(g){}e.addEventListener&&e.addEventListener("load",(function(){e.close()}))}}}}),a.utils.Event.call(a),function(e){var t={},r={};e.on("auth.login, auth.logout",(function(r){r&&"object"==typeof r&&r.network&&(t[r.network]=e.utils.store(r.network)||{})})),function n(){var i=(new Date).getTime()/1e3,o=function(t){e.emit("auth."+t,{network:a,authResponse:s})};for(var a in e.services)if(e.services.hasOwnProperty(a)){if(!e.services[a].id)continue;var s=e.utils.store(a)||{},c=e.services[a],u=t[a]||{};if(s&&"callback"in s){var l=s.callback;try{delete s.callback}catch(h){}e.utils.store(a,s);try{window[l](s)}catch(h){}}if(s&&"expires"in s&&s.expires<i){var d=c.refresh||s.refresh_token;d&&(!(a in r)||r[a]<i)?(e.emit("notice",a+" has expired trying to resignin"),e.login(a,{display:"none",force:!1}),r[a]=i+600):d||a in r||(o("expired"),r[a]=!0);continue}if(u.access_token===s.access_token&&u.expires===s.expires)continue;!s.access_token&&u.access_token?o("logout"):s.access_token&&!u.access_token?o("login"):s.expires!==u.expires&&o("update"),t[a]=s,a in r&&delete r[a]}setTimeout(n,1e3)}()}(a),a.api=function(){var e=this,t=e.utils,r=t.error,n=t.Promise(),i=t.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);i.method=(i.method||"get").toLowerCase(),i.headers=i.headers||{},i.query=i.query||{},"get"!==i.method&&"delete"!==i.method||(t.extend(i.query,i.data),i.data={});var o=i.data=i.data||{};if(n.then(i.callback,i.callback),!i.path)return n.reject(r("invalid_path","Missing the path parameter from the request"));i.path=i.path.replace(/^\/+/,"");var a=(i.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(a in e.services){i.network=a;var s=new RegExp("^"+a+":?/?");i.path=i.path.replace(s,"")}i.network=e.settings.default_service=i.network||e.settings.default_service;var c=e.services[i.network];if(!c)return n.reject(r("invalid_network","Could not match the service requested: "+i.network));if(i.method in c&&i.path in c[i.method]&&!1===c[i.method][i.path])return n.reject(r("invalid_path","The provided path is not available on the selected network"));i.oauth_proxy||(i.oauth_proxy=e.settings.oauth_proxy),"proxy"in i||(i.proxy=i.oauth_proxy&&c.oauth&&1===parseInt(c.oauth.version,10)),"timeout"in i||(i.timeout=e.settings.timeout),"formatResponse"in i||(i.formatResponse=!0),i.authResponse=e.getAuthResponse(i.network),i.authResponse&&i.authResponse.access_token&&(i.query.access_token=i.authResponse.access_token);var u,l=i.path;i.options=t.clone(i.query),i.data=t.clone(o);var d=c[{delete:"del"}[i.method]||i.method]||{};if("get"===i.method){var h=l.split(/[\?#]/)[1];h&&(t.extend(i.query,t.param(h)),l=l.replace(/\?.*?(#|$)/,"$1"))}return(u=l.match(/#(.+)/,""))?(l=l.split("#")[0],i.path=u[1]):l in d?(i.path=l,l=d[l]):"default"in d&&(l=d.default),i.redirect_uri=e.settings.redirect_uri,i.xhr=c.xhr,i.jsonp=c.jsonp,i.form=c.form,"function"==typeof l?l(i,f):f(l),n.proxy;function f(e){(e=e.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,(function(e,t,o){var a=o?o.replace(/^\|/,""):"";return t in i.query?(a=i.query[t],delete i.query[t]):i.data&&t in i.data?(a=i.data[t],delete i.data[t]):o||n.reject(r("missing_attribute","The attribute "+t+" is missing from the request")),a}))).match(/^https?:\/\//)||(e=c.base+e),i.url=e,t.request(i,(function(e,r){if(i.formatResponse){if(!0===e?e={success:!0}:e||(e={}),"delete"===i.method&&(e=!e||t.isEmpty(e)?{success:!0}:e),c.wrap&&(i.path in c.wrap||"default"in c.wrap)){var o=i.path in c.wrap?i.path:"default",a=((new Date).getTime(),c.wrap[o](e,r,i));a&&(e=a)}e&&"paging"in e&&e.paging.next&&("?"===e.paging.next[0]?e.paging.next=i.path+e.paging.next:e.paging.next+="#"+i.path),!e||"error"in e?n.reject(e):n.fulfill(e)}else("object"==typeof r?r.statusCode>=400:"object"==typeof e&&"error"in e)?n.reject(e):n.fulfill(e)}))}},a.utils.extend(a.utils,{request:function(e,t){var r=this,n=r.error;if(r.isEmpty(e.data)||"FileList"in window||!r.hasBinary(e.data)||(e.xhr=!1,e.jsonp=!1),this.request_cors((function(){return void 0===e.xhr||e.xhr&&("function"!=typeof e.xhr||e.xhr(e,e.query))})))a(e,(function(n){var i=r.xhr(e.method,n,e.headers,e.data,t);i.onprogress=e.onprogress||null,i.upload&&e.onuploadprogress&&(i.upload.onprogress=e.onuploadprogress)}));else{var i,o=e.query;if(e.query=r.clone(e.query),e.callbackID=r.globalEvent(),!1!==e.jsonp){if(e.query.callback=e.callbackID,"function"==typeof e.jsonp&&e.jsonp(e,e.query),"get"===e.method)return void a(e,(function(n){r.jsonp(n,t,e.callbackID,e.timeout)}));e.query=o}if(!1!==e.form&&(e.query.redirect_uri=e.redirect_uri,e.query.state=JSON.stringify({callback:e.callbackID}),"function"==typeof e.form&&(i=e.form(e,e.query)),"post"===e.method&&!1!==i))return void a(e,(function(n){r.post(n,e.data,i,t,e.callbackID,e.timeout)}));t(n("invalid_request","There was no mechanism for handling this request"))}function a(e,t){var n;e.authResponse&&e.authResponse.oauth&&1===parseInt(e.authResponse.oauth.version,10)&&(n=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(r.extend(e.query,e.data),e.data=null);var i=r.qs(e.url,e.query);e.proxy&&(i=r.qs(e.oauth_proxy,{path:i,access_token:n||"",then:e.proxy_response_type||("get"===e.method.toLowerCase()?"redirect":"proxy"),method:e.method.toLowerCase(),suppress_response_codes:e.suppress_response_codes||!0})),t(i)}},request_cors:function(e){return"withCredentials"in new XMLHttpRequest&&e()},domInstance:function(e,t){var r="HTML"+(e||"").replace(/^[a-z]/,(function(e){return e.toUpperCase()}))+"Element";return!!t&&(window[r]?t instanceof window[r]:window.Element?t instanceof window.Element&&(!e||t.tagName&&t.tagName.toLowerCase()===e):!(t instanceof Object||t instanceof Array||t instanceof String||t instanceof Number)&&t.tagName&&t.tagName.toLowerCase()===e)},clone:function(e){if(null===e||"object"!=typeof e||e instanceof Date||"nodeName"in e||this.isBinary(e)||"function"==typeof FormData&&e instanceof FormData)return e;if(Array.isArray(e))return e.map(this.clone.bind(this));var t={};for(var r in e)t[r]=this.clone(e[r]);return t},xhr:function(e,t,r,n,i){var o,a=new XMLHttpRequest,s=this.error,c=!1;if("blob"===e&&(c=e,e="GET"),e=e.toUpperCase(),a.onload=function(t){var r=a.response;try{r=JSON.parse(a.responseText)}catch(o){401===a.status&&(r=s("access_denied",a.statusText))}var n=function(e){var t,r={},n=/([a-z\-]+):\s?(.*);?/gi;for(;t=n.exec(e);)r[t[1]]=t[2];return r}(a.getAllResponseHeaders());n.statusCode=a.status,i(r||("GET"===e?s("empty_response","Could not get resource"):{}),n)},a.onerror=function(e){var t=a.responseText;try{t=JSON.parse(a.responseText)}catch(r){}i(t||s("access_denied","Could not get resource"))},"GET"===e||"DELETE"===e)n=null;else if(n&&"string"!=typeof n&&!(n instanceof FormData)&&!(n instanceof File)&&!(n instanceof Blob)){var u=new FormData;for(o in n)n.hasOwnProperty(o)&&(n[o]instanceof HTMLInputElement?"files"in n[o]&&n[o].files.length>0&&u.append(o,n[o].files[0]):n[o]instanceof Blob?u.append(o,n[o],n.name):u.append(o,n[o]));n=u}if(a.open(e,t,!0),c&&("responseType"in a?a.responseType=c:a.overrideMimeType("text/plain; charset=x-user-defined")),r)for(o in r)a.setRequestHeader(o,r[o]);return a.send(n),a},jsonp:function(e,t,r,n){var i,o=this.error,a=0,s=document.getElementsByTagName("head")[0],c=o("server_error","server_error"),u=function(){a++||window.setTimeout((function(){t(c),s.removeChild(l)}),0)};r=this.globalEvent((function(e){return c=e,!0}),r),e=e.replace(new RegExp("=\\?(&|$)"),"="+r+"$1");var l=this.append("script",{id:r,name:r,src:e,async:!0,onload:u,onerror:u,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&u()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(i=this.append("script",{text:"document.getElementById('"+r+"').onerror();"}),l.async=!1),n&&window.setTimeout((function(){c=o("timeout","timeout"),u()}),n),s.appendChild(l),i&&s.appendChild(i)},post:function(e,t,r,n,i,o){var a,s,c=this.error,u=document,l=null,d=[],h=0,f=null,p=0,m=function(e){p++||n(e)};this.globalEvent(m,i);try{s=u.createElement('<iframe name="'+i+'">')}catch(y){s=u.createElement("iframe")}if(s.name=i,s.id=i,s.style.display="none",r&&r.callbackonload&&(s.onload=function(){m({response:"posted",message:"Content was posted"})}),o&&setTimeout((function(){m(c("timeout","The post operation timed out"))}),o),u.body.appendChild(s),this.domInstance("form",t)){for(l=t.form,h=0;h<l.elements.length;h++)l.elements[h]!==t&&l.elements[h].setAttribute("disabled",!0);t=l}if(this.domInstance("form",t))for(l=t,h=0;h<l.elements.length;h++)l.elements[h].disabled||"file"!==l.elements[h].type||(l.encoding=l.enctype="multipart/form-data",l.elements[h].setAttribute("name","file"));else{for(f in t)t.hasOwnProperty(f)&&this.domInstance("input",t[f])&&"file"===t[f].type&&((l=t[f].form).encoding=l.enctype="multipart/form-data");var g;for(f in l||(l=u.createElement("form"),u.body.appendChild(l),a=l),t)if(t.hasOwnProperty(f)){var _=this.domInstance("input",t[f])||this.domInstance("textArea",t[f])||this.domInstance("select",t[f]);if(_&&t[f].form===l)_&&t[f].name!==f&&(t[f].setAttribute("name",f),t[f].name=f);else{var v=l.elements[f];if(g)for(v instanceof NodeList||(v=[v]),h=0;h<v.length;h++)v[h].parentNode.removeChild(v[h]);(g=u.createElement("input")).setAttribute("type","hidden"),g.setAttribute("name",f),_?g.value=t[f].value:this.domInstance(null,t[f])?g.value=t[f].innerHTML||t[f].innerText:g.value=t[f],l.appendChild(g)}}for(h=0;h<l.elements.length;h++)(g=l.elements[h]).name in t||!0===g.getAttribute("disabled")||(g.setAttribute("disabled",!0),d.push(g))}l.setAttribute("method","POST"),l.setAttribute("target",i),l.target=i,l.setAttribute("action",e),setTimeout((function(){l.submit(),setTimeout((function(){try{a&&a.parentNode.removeChild(a)}catch(y){}for(var e=0;e<d.length;e++)d[e]&&(d[e].setAttribute("disabled",!1),d[e].disabled=!1)}),0)}),100)},hasBinary:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var t=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,r=e.match(t);if(!r)return e;for(var n=atob(e.replace(t,"")),i=[],o=0;o<n.length;o++)i.push(n.charCodeAt(o));return new Blob([new Uint8Array(i)],{type:r[1]})}}),function(e){var t=e.api,r=e.utils;r.extend(r,{dataToJSON:function(e){var t=window,r=e.data;if(this.domInstance("form",r)?r=this.nodeListToJSON(r.elements):"NodeList"in t&&r instanceof NodeList?r=this.nodeListToJSON(r):this.domInstance("input",r)&&(r=this.nodeListToJSON([r])),("File"in t&&r instanceof t.File||"Blob"in t&&r instanceof t.Blob||"FileList"in t&&r instanceof t.FileList)&&(r={file:r}),!("FormData"in t&&r instanceof t.FormData))for(var n in r)if(r.hasOwnProperty(n))if("FileList"in t&&r[n]instanceof t.FileList)1===r[n].length&&(r[n]=r[n][0]);else{if(this.domInstance("input",r[n])&&"file"===r[n].type)continue;this.domInstance("input",r[n])||this.domInstance("select",r[n])||this.domInstance("textArea",r[n])?r[n]=r[n].value:this.domInstance(null,r[n])&&(r[n]=r[n].innerHTML||r[n].innerText)}return e.data=r,r},nodeListToJSON:function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];!n.disabled&&n.name&&("file"===n.type?t[n.name]=n:t[n.name]=n.value||n.innerHTML)}return t}}),e.api=function(){var e=r.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return e.data&&r.dataToJSON(e),t.call(this,e)}}(a),a.utils.responseHandler(window,window.opener||window.parent),"object"==typeof chrome&&"object"==typeof chrome.identity&&chrome.identity.launchWebAuthFlow&&function(){a.utils.popup=function(e){return t(e,!0)},a.utils.iframe=function(e){t(e,!1)},a.utils.request_cors=function(e){return e(),!0};var e={};function t(e,r){var n={closed:!1};return chrome.identity.launchWebAuthFlow({url:e,interactive:r},(function(e){if(void 0!==e){var r=a.utils.url(e),i={location:{assign:function(e){t(e,!1)},search:r.search,hash:r.hash,href:r.href},close:function(){}};a.utils.responseHandler(i,window)}else n.closed=!0})),n}chrome.storage.local.get("hello",(function(t){e=t.hello||{}})),a.utils.store=function(t,r){return 0===arguments.length?e:1===arguments.length?e[t]||null:r?(e[t]=r,chrome.storage.local.set({hello:e}),r):null===r?(delete e[t],chrome.storage.local.set({hello:e}),null):void 0}}(),function(){if(/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova){a.utils.iframe=function(e,t){a.utils.popup(e,t,{hidden:"yes"})};var e=a.utils.popup;a.utils.popup=function(t,r,n){var i=e.call(this,t,r,n);try{if(i&&i.addEventListener){var o=a.utils.url(r),s=o.origin||o.protocol+"//"+o.hostname;i.addEventListener("loadstart",(function(e){var t=e.url;if(0===t.indexOf(s)){var r=a.utils.url(t),n={location:{assign:function(e){i.executeScript({code:'window.location.href = "'+e+';"'})},search:r.search,hash:r.hash,href:r.href},close:function(){if(i.close){i.close();try{i.closed=!0}catch(e){}}}};a.utils.responseHandler(n,window)}}))}}catch(c){}return i}}}(),function(e){var t={version:"1.0",auth:"https://www.dropbox.com/1/oauth/authorize",request:"https://api.dropbox.com/1/oauth/request_token",token:"https://api.dropbox.com/1/oauth/access_token"},r={version:2,auth:"https://www.dropbox.com/1/oauth2/authorize",grant:"https://api.dropbox.com/1/oauth2/token"};function n(e){e&&"error"in e&&(e.error={code:"server_error",message:e.error.message||e.error})}function i(t,r,n){if(!("object"!=typeof t||"undefined"!=typeof Blob&&t instanceof Blob||"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"error"in t)){var i=("app_folder"!==t.root?t.root:"")+t.path.replace(/\&/g,"%26");i=i.replace(/^\//,""),t.thumb_exists&&(t.thumbnail=n.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/thumbnails/auto/"+i+"?format=jpeg&size=m")+"&access_token="+n.options.access_token),t.type=t.is_dir?"folder":t.mime_type,t.name=t.path.replace(/.*\//g,""),t.is_dir?t.files=i.replace(/^\//,""):(t.downloadLink=e.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/files/auto/"+i)+"&access_token="+n.options.access_token,t.file="https://api-content.dropbox.com/1/files/auto/"+i),t.id||(t.id=t.path.replace(/^\//,""))}}function o(e){return function(t,r){delete t.query.limit,r(e)}}e.init({dropbox:{name:"Dropbox",oauth:r,login:function(n){n.qs.scope="";var i=decodeURIComponent(n.qs.redirect_uri);0===i.indexOf("http:")&&0!==i.indexOf("http://localhost/")?e.services.dropbox.oauth=t:e.services.dropbox.oauth=r,n.options.popup.width=1e3,n.options.popup.height=1e3},base:"https://api.dropbox.com/1/",root:"sandbox",get:{me:"account/info","me/files":o("metadata/auto/@{parent|}"),"me/folder":o("metadata/auto/@{id}"),"me/folders":o("metadata/auto/"),default:function(e,t){e.path.match("https://api-content.dropbox.com/1/files/")&&(e.method="blob"),t(e.path)}},post:{"me/files":function(t,r){var n=t.data.parent,i=t.data.name;t.data={file:t.data.file},"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),r("https://api-content.dropbox.com/1/files_put/auto/"+n+"/"+i)},"me/folders":function(t,r){var n=t.data.name;t.data={},r("fileops/create_folder?root=@{root|sandbox}&"+e.utils.param({path:n}))}},del:{"me/files":"fileops/delete?root=@{root|sandbox}&path=@{id}","me/folder":"fileops/delete?root=@{root|sandbox}&path=@{id}"},wrap:{me:function(e){if(n(e),!e.uid)return e;e.name=e.display_name;var t=e.name.split(" ");return e.first_name=t.shift(),e.last_name=t.join(" "),e.id=e.uid,delete e.uid,delete e.display_name,e},default:function(e,t,r){return n(e),e.is_dir&&e.contents&&(e.data=e.contents,delete e.contents,e.data.forEach((function(n){n.root=e.root,i(n,t,r)}))),i(e,t,r),e.is_deleted&&(e.success=!0),e}},xhr:function(e){if(e.data&&e.data.file){var t=e.data.file;t&&(t.files?e.data=t.files[0]:e.data=t)}return"delete"===e.method&&(e.method="post"),!0},form:function(e,t){delete t.state,delete t.redirect_uri}}})}(a),function(e){e.init({facebook:{name:"Facebook",oauth:{version:2,auth:"https://www.facebook.com/v2.9/dialog/oauth/",grant:"https://graph.facebook.com/oauth/access_token"},scope:{basic:"public_profile",email:"email",share:"user_posts",birthday:"user_birthday",events:"user_events",photos:"user_photos",videos:"user_videos",friends:"user_friends",files:"user_photos,user_videos",publish_files:"user_photos,user_videos,publish_actions",publish:"publish_actions",offline_access:""},refresh:!1,login:function(e){e.options.force&&(e.qs.auth_type="reauthenticate"),e.qs.display=e.options.display||"popup"},logout:function(t,r){var n=e.utils.globalEvent(t),i=encodeURIComponent(e.settings.redirect_uri+"?"+e.utils.param({callback:n,result:JSON.stringify({force:!0}),state:"{}"})),o=(r.authResponse||{}).access_token;if(e.utils.iframe("https://www.facebook.com/logout.php?next="+i+"&access_token="+o),!o)return!1},base:"https://graph.facebook.com/v2.9/",get:{me:"me?fields=email,first_name,last_name,name,timezone,verified","me/friends":"me/friends","me/following":"me/friends","me/followers":"me/friends","me/share":"me/feed","me/like":"me/likes","me/files":"me/albums","me/albums":"me/albums?fields=cover_photo,name","me/album":"@{id}/photos?fields=picture","me/photos":"me/photos","me/photo":"@{id}","friend/albums":"@{id}/albums","friend/photos":"@{id}/photos"},post:{"me/share":"me/feed","me/photo":"@{id}"},wrap:{me:r,"me/friends":n,"me/following":n,"me/followers":n,"me/albums":i,"me/photos":i,"me/files":i,default:i},xhr:function(t,r){return"get"!==t.method&&"post"!==t.method||(r.suppress_response_codes=!0),"post"===t.method&&t.data&&"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),!0},jsonp:function(t,r){var n=t.method;"get"===n||e.utils.hasBinary(t.data)?"delete"===t.method&&(r.method="delete",t.method="post"):(t.data.method=n,t.method="get")},form:function(e){return{callbackonload:!0}}}});var t="https://graph.facebook.com/";function r(e){return e.id&&(e.thumbnail=e.picture="https://graph.facebook.com/"+e.id+"/picture"),e}function n(e){return"data"in e&&e.data.forEach(r),e}function i(e,r,n){if("boolean"==typeof e&&(e={success:e}),e&&"data"in e){var i=n.query.access_token;if(!(e.data instanceof Array)){var o=e.data;delete e.data,e.data=[o]}e.data.forEach((function(e){e.picture&&(e.thumbnail=e.picture),e.pictures=(e.images||[]).sort((function(e,t){return e.width-t.width})),e.cover_photo&&e.cover_photo.id&&(e.thumbnail=t+e.cover_photo.id+"/picture?access_token="+i),"album"===e.type&&(e.files=e.photos=t+e.id+"/photos"),e.can_upload&&(e.upload_location=t+e.id+"/photos")}))}return e}}(a),function(e){function t(t,r,n){var i=(n?"":"flickr:")+"?method="+t+"&api_key="+e.services.flickr.id+"&format=json";for(var o in r)r.hasOwnProperty(o)&&(i+="&"+o+"="+r[o]);return i}function r(r,n){return n||(n={}),function(i,o){var a,s;a=function(e){n.user_id=e,o(t(r,n,!0))},s=e.getAuthResponse("flickr"),a(s&&s.user_nsid?s.user_nsid:null)}}function n(e,t){var r="https://www.flickr.com/images/buddyicon.gif";return e.nsid&&e.iconserver&&e.iconfarm&&(r="https://farm"+e.iconfarm+".staticflickr.com/"+e.iconserver+"/buddyicons/"+e.nsid+(t?"_"+t:"")+".jpg"),r}function i(e,t,r,n,i){return"https://farm"+t+".staticflickr.com/"+r+"/"+e+"_"+n+(i=i?"_"+i:"")+".jpg"}function o(e){e&&e.stat&&"ok"!=e.stat.toLowerCase()&&(e.error={code:"invalid_request",message:e.message})}function a(e){if(e.photoset||e.photos){l(e=c(e,"photoset"in e?"photoset":"photos")),e.data=e.photo,delete e.photo;for(var t=0;t<e.data.length;t++){var r=e.data[t];r.name=r.title,r.picture=i(r.id,r.farm,r.server,r.secret,""),r.pictures=s(r.id,r.farm,r.server,r.secret),r.source=i(r.id,r.farm,r.server,r.secret,"b"),r.thumbnail=i(r.id,r.farm,r.server,r.secret,"m")}}return e}function s(e,t,r,n){return[{id:"t",max:100},{id:"m",max:240},{id:"n",max:320},{id:"",max:500},{id:"z",max:640},{id:"c",max:800},{id:"b",max:1024},{id:"h",max:1600},{id:"k",max:2048},{id:"o",max:2048}].map((function(o){return{source:i(e,t,r,n,o.id),width:o.max,height:o.max}}))}function c(e,t){return t in e?e=e[t]:"error"in e||(e.error={code:"invalid_request",message:e.message||"Failed to get data from Flickr"}),e}function u(e){if(o(e),e.contacts){l(e=c(e,"contacts")),e.data=e.contact,delete e.contact;for(var t=0;t<e.data.length;t++){var r=e.data[t];r.id=r.nsid,r.name=r.realname||r.username,r.thumbnail=n(r,"m")}}return e}function l(e){e.page&&e.pages&&e.page!==e.pages&&(e.paging={next:"?page="+ ++e.page})}e.init({flickr:{name:"Flickr",oauth:{version:"1.0a",auth:"https://www.flickr.com/services/oauth/authorize?perms=read",request:"https://www.flickr.com/services/oauth/request_token",token:"https://www.flickr.com/services/oauth/access_token"},base:"https://api.flickr.com/services/rest",get:{me:r("flickr.people.getInfo"),"me/friends":r("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/following":r("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/followers":r("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/albums":r("flickr.photosets.getList",{per_page:"@{limit|50}"}),"me/album":r("flickr.photosets.getPhotos",{photoset_id:"@{id}"}),"me/photos":r("flickr.people.getPhotos",{per_page:"@{limit|50}"})},wrap:{me:function(e){if(o(e),(e=c(e,"person")).id){if(e.realname){e.name=e.realname._content;var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=n(e,"l"),e.picture=n(e,"l")}return e},"me/friends":u,"me/followers":u,"me/following":u,"me/albums":function(e){return o(e),l(e=c(e,"photosets")),e.photoset&&(e.data=e.photoset,e.data.forEach((function(e){e.name=e.title._content,e.photos="https://api.flickr.com/services/rest"+t("flickr.photosets.getPhotos",{photoset_id:e.id},!0)})),delete e.photoset),e},"me/photos":function(e){return o(e),a(e)},default:function(e){return o(e),a(e)}},xhr:!1,jsonp:function(e,t){"get"==e.method&&(delete t.callback,t.jsoncallback=e.callbackID)}}})}(a),function(e){function t(e){!e.meta||400!==e.meta.code&&401!==e.meta.code||(e.error={code:"access_denied",message:e.meta.errorDetail})}function r(e){e&&e.id&&(e.thumbnail=e.photo.prefix+"100x100"+e.photo.suffix,e.name=e.firstName+" "+e.lastName,e.first_name=e.firstName,e.last_name=e.lastName,e.contact&&e.contact.email&&(e.email=e.contact.email))}function n(e,t){var r=t.access_token;return delete t.access_token,t.oauth_token=r,t.v=20121125,!0}e.init({foursquare:{name:"Foursquare",oauth:{version:2,auth:"https://foursquare.com/oauth2/authenticate",grant:"https://foursquare.com/oauth2/access_token"},refresh:!0,base:"https://api.foursquare.com/v2/",get:{me:"users/self","me/friends":"users/self/friends","me/followers":"users/self/friends","me/following":"users/self/friends"},wrap:{me:function(e){return t(e),e&&e.response&&r(e=e.response.user),e},default:function(e){return t(e),e&&"response"in e&&"friends"in e.response&&"items"in e.response.friends&&(e.data=e.response.friends.items,e.data.forEach(r),delete e.response),e}},xhr:n,jsonp:n}})}(a),function(e){function t(e,t){var r=t?t.statusCode:e&&"meta"in e&&"status"in e.meta&&e.meta.status;401!==r&&403!==r||(e.error={code:"access_denied",message:e.message||(e.data?e.data.message:"Could not get response")},delete e.message)}function r(e){e.id&&(e.thumbnail=e.picture=e.avatar_url,e.name=e.login)}e.init({github:{name:"GitHub",oauth:{version:2,auth:"https://github.com/login/oauth/authorize",grant:"https://github.com/login/oauth/access_token",response_type:"code"},scope:{email:"user:email"},base:"https://api.github.com/",get:{me:"user","me/friends":"user/following?per_page=@{limit|100}","me/following":"user/following?per_page=@{limit|100}","me/followers":"user/followers?per_page=@{limit|100}","me/like":"user/starred?per_page=@{limit|100}"},wrap:{me:function(e,n){return t(e,n),r(e),e},default:function(e,n,i){return t(e,n),Array.isArray(e)&&(e={data:e}),e.data&&(!function(e,t,r){if(e.data&&e.data.length&&t&&t.Link){var n=t.Link.match(/<(.*?)>;\s*rel=\"next\"/);n&&(e.paging={next:n[1]})}}(e,n),e.data.forEach(r)),e}},xhr:function(e){return"get"!==e.method&&e.data&&(e.headers=e.headers||{},e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data))),!0}}})}(a),function(e){var t="https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}";function r(e){return parseInt(e,10)}function n(e){return l(e),e.data=e.items,delete e.items,e}function i(e){if(!e.error)return e.name||(e.name=e.title||e.message),e.picture||(e.picture=e.thumbnailLink),e.thumbnail||(e.thumbnail=e.thumbnailLink),"application/vnd.google-apps.folder"===e.mimeType&&(e.type="folder",e.files="https://www.googleapis.com/drive/v2/files?q=%22"+e.id+"%22+in+parents"),e}function o(e){return{source:e.url,width:e.width,height:e.height}}function a(e){if(l(e),"feed"in e&&"entry"in e.feed)e.data=e.feed.entry.map(u),delete e.feed;else{if("entry"in e)return u(e.entry);"items"in e?(e.data=e.items.map(i),delete e.items):i(e)}return e}function s(e){e.name=e.displayName||e.name,e.picture=e.picture||(e.image?e.image.url:null),e.thumbnail=e.picture}function c(e,t,r){l(e);if("feed"in e&&"entry"in e.feed){for(var n=r.query.access_token,i=0;i<e.feed.entry.length;i++){var o=e.feed.entry[i];if(o.id=o.id.$t,o.name=o.title.$t,delete o.title,o.gd$email&&(o.email=o.gd$email&&o.gd$email.length>0?o.gd$email[0].address:null,o.emails=o.gd$email,delete o.gd$email),o.updated&&(o.updated=o.updated.$t),o.link){var a=o.link.length>0?o.link[0].href:null;a&&o.link[0].gd$etag&&(a+=(a.indexOf("?")>-1?"&":"?")+"access_token="+n,o.picture=a,o.thumbnail=a),delete o.link}o.category&&delete o.category}e.data=e.feed.entry,delete e.feed}return e}function u(e){var t,r=e.media$group,n=r.media$content.length?r.media$content[0]:{},i=r.media$content||[],a=r.media$thumbnail||[],s=i.concat(a).map(o).sort((function(e,t){return e.width-t.width})),c=0,u={id:e.id.$t,name:e.title.$t,description:e.summary.$t,updated_time:e.updated.$t,created_time:e.published.$t,picture:n?n.url:null,pictures:s,images:[],thumbnail:n?n.url:null,width:n.width,height:n.height};if("link"in e)for(c=0;c<e.link.length;c++){var l=e.link[c];if(l.rel.match(/\#feed$/)){u.upload_location=u.files=u.photos=l.href;break}}if("category"in e&&e.category.length)for(t=e.category,c=0;c<t.length;c++)t[c].scheme&&t[c].scheme.match(/\#kind$/)&&(u.type=t[c].term.replace(/^.*?\#/,""));return"media$thumbnail"in r&&r.media$thumbnail.length&&(t=r.media$thumbnail,u.thumbnail=t[0].url,u.images=t.map(o)),(t=r.media$content)&&t.length&&u.images.push(o(t[0])),u}function l(e){if("feed"in e&&e.feed.openSearch$itemsPerPage){var t=r(e.feed.openSearch$itemsPerPage.$t),n=r(e.feed.openSearch$startIndex.$t);n+t<r(e.feed.openSearch$totalResults.$t)&&(e.paging={next:"?start="+(n+t)})}else"nextPageToken"in e&&(e.paging={next:"?pageToken="+e.nextPageToken})}function d(){var e=[],t=(1e10*Math.random()).toString(32),r=0,n="\r\n--"+t,i=function(){},o=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;function a(e){var t=new FileReader;t.onload=function(t){s(btoa(t.target.result),e.type+"\r\nContent-Transfer-Encoding: base64")},t.readAsBinaryString(e)}function s(t,n){e.push("\r\nContent-Type: "+n+"\r\n\r\n"+t),r--,i()}this.append=function(e,t){"string"!=typeof e&&"length"in Object(e)||(e=[e]);for(var n=0;n<e.length;n++){r++;var i=e[n];if("undefined"!=typeof File&&i instanceof File||"undefined"!=typeof Blob&&i instanceof Blob)a(i);else if("string"==typeof i&&i.match(o)){var c=i.match(o);s(i.replace(o,""),c[1]+"\r\nContent-Transfer-Encoding: base64")}else s(i,t)}},this.onready=function(o){(i=function(){0===r&&(e.unshift(""),e.push("--"),o(e.join(n),t),e=[])})()}}function h(e,t){var r,n={};if(e.data&&"undefined"!=typeof HTMLInputElement&&e.data instanceof HTMLInputElement&&(e.data={file:e.data}),!e.data.name&&Object(Object(e.data.file).files).length&&"post"===e.method&&(e.data.name=e.data.file.files[0].name),"post"===e.method?e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],file:e.data.file}:(n=e.data,e.data={},n.parent&&(e.data.parents=[{id:e.data.parent||"root"}]),n.file&&(e.data.file=n.file),n.name&&(e.data.title=n.name)),!("file"in e.data)||(r=e.data.file,delete e.data.file,"object"==typeof r&&"files"in r&&(r=r.files),r&&r.length)){var i=new d;i.append(JSON.stringify(e.data),"application/json"),r&&i.append(r),i.onready((function(r,i){e.headers["content-type"]='multipart/related; boundary="'+i+'"',e.data=r,t("upload/drive/v2/files"+(n.id?"/"+n.id:"")+"?uploadType=multipart")}))}else t({error:{code:"request_invalid",message:"There were no files attached with this request to upload"}})}e.init({google:{name:"Google Sign-In",oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/v2/auth",grant:"https://www.googleapis.com/oauth2/v4/token"},scope:{basic:"openid profile",email:"email",birthday:"",events:"",photos:"https://picasaweb.google.com/data/",videos:"http://gdata.youtube.com",files:"https://www.googleapis.com/auth/drive.readonly",publish:"",publish_files:"https://www.googleapis.com/auth/drive",share:"",create_event:"",offline_access:""},scope_delim:" ",login:function(e){"code"===e.qs.response_type?e.qs.access_type="offline":e.qs.response_type.indexOf("id_token")>-1&&(e.qs.nonce=parseInt(1e12*Math.random(),10).toString(36)),e.options.force&&(e.qs.approval_prompt="force")},base:"https://www.googleapis.com/",get:{me:"oauth2/v3/userinfo?alt=json","me/following":t,"me/followers":t,"me/contacts":t,"me/albums":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}","me/album":function(e,t){var r=e.query.id;delete e.query.id,t(r.replace("/entry/","/feed/"))},"me/photos":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}","me/file":"drive/v2/files/@{id}","me/files":"drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}","me/folders":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}","me/folder":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}"},post:{"me/files":h,"me/folders":function(e,t){e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],mimeType:"application/vnd.google-apps.folder"},t("drive/v2/files")}},put:{"me/files":h},del:{"me/files":"drive/v2/files/@{id}","me/folder":"drive/v2/files/@{id}"},patch:{"me/file":"drive/v2/files/@{id}"},wrap:{me:function(e){return e.sub&&(e.id=e.sub),e.id&&(e.last_name=e.family_name||(e.name?e.name.familyName:null),e.first_name=e.given_name||(e.name?e.name.givenName:null),e.emails&&e.emails.length&&(e.email=e.emails[0].value),s(e)),e},"me/friends":function(e){return e.items&&(l(e),e.data=e.items,e.data.forEach(s),delete e.items),e},"me/contacts":c,"me/followers":c,"me/following":c,"me/share":n,"me/feed":n,"me/albums":a,"me/photos":function(e){"feed"in e&&(e.data="entry"in e.feed?e.feed.entry.map(u):[],delete e.feed);return e},default:a},xhr:function(t){return"post"===t.method||"put"===t.method?function(e){if("object"==typeof e.data)try{e.data=JSON.stringify(e.data),e.headers["content-type"]="application/json"}catch(t){}}(t):"patch"===t.method&&(e.utils.extend(t.query,t.data),t.data=null),!0},form:!1}})}(a),function(e){function t(e){return"string"==typeof e?{error:{code:"invalid_request",message:e}}:(e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message}),e)}function r(e){return i(e),e&&"data"in e&&e.data.forEach(n),e}function n(e){e.id&&(e.thumbnail=e.profile_picture,e.name=e.full_name||e.username)}function i(e){"pagination"in e&&(e.paging={next:e.pagination.next_url},delete e.pagination)}e.init({instagram:{name:"Instagram",oauth:{version:2,auth:"https://instagram.com/oauth/authorize/",grant:"https://api.instagram.com/oauth/access_token"},refresh:!0,scope:{basic:"basic",photos:"",friends:"relationships",publish:"likes comments",email:"",share:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.instagram.com/v1/",get:{me:"users/self","me/feed":"users/self/feed?count=@{limit|100}","me/photos":"users/self/media/recent?min_id=0&count=@{limit|100}","me/friends":"users/self/follows?count=@{limit|100}","me/following":"users/self/follows?count=@{limit|100}","me/followers":"users/self/followed-by?count=@{limit|100}","friend/photos":"users/@{id}/media/recent?min_id=0&count=@{limit|100}"},post:{"me/like":function(e,t){var r=e.data.id;e.data={},t("media/"+r+"/likes")}},del:{"me/like":"media/@{id}/likes"},wrap:{me:function(e){return t(e),"data"in e&&(e.id=e.data.id,e.thumbnail=e.data.profile_picture,e.name=e.data.full_name||e.data.username),e},"me/friends":r,"me/following":r,"me/followers":r,"me/photos":function(e){return t(e),i(e),"data"in e&&(e.data=e.data.filter((function(e){return"image"===e.type})),e.data.forEach((function(e){e.name=e.caption?e.caption.text:null,e.thumbnail=e.images.thumbnail.url,e.picture=e.images.standard_resolution.url,e.pictures=Object.keys(e.images).map((function(t){return function(e){return{source:e.url,width:e.width,height:e.height}}(e.images[t])})).sort((function(e,t){return e.width-t.width}))}))),e},default:function(e){return i(e=t(e)),e}},xhr:function(e,t){var r=e.method,n="get"!==r;return n&&("post"!==r&&"put"!==r||!e.query.access_token||(e.data.access_token=e.query.access_token,delete e.query.access_token),e.proxy=n),n},form:!1}})}(a),function(e){function t(e,t){var r,n;return e&&"Message"in e&&(n=e.Message,delete e.Message,"ErrorCode"in e?(r=e.ErrorCode,delete e.ErrorCode):r=function(e){switch(e.statusCode){case 400:return"invalid_request";case 403:return"stale_token";case 401:return"invalid_token";case 500:default:return"server_error"}}(t),e.error={code:r,message:n,details:e}),e}e.init({joinme:{name:"join.me",oauth:{version:2,auth:"https://secure.join.me/api/public/v1/auth/oauth2",grant:"https://secure.join.me/api/public/v1/auth/oauth2"},refresh:!1,scope:{basic:"user_info",user:"user_info",scheduler:"scheduler",start:"start_meeting",email:"",friends:"",share:"",publish:"",photos:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",login:function(e){e.options.popup.width=400,e.options.popup.height=700},base:"https://api.join.me/v1/",get:{me:"user",meetings:"meetings","meetings/info":"meetings/@{id}"},post:{"meetings/start/adhoc":function(e,t){t("meetings/start")},"meetings/start/scheduled":function(e,t){var r=e.data.meetingId;e.data={},t("meetings/"+r+"/start")},"meetings/schedule":function(e,t){t("meetings")}},patch:{"meetings/update":function(e,t){t("meetings/"+e.data.meetingId)}},del:{"meetings/delete":"meetings/@{id}"},wrap:{me:function(e,r){return t(e,r),e.email?(e.name=e.fullName,e.first_name=e.name.split(" ")[0],e.last_name=e.name.split(" ")[1],e.id=e.email,e):e},default:function(e,r){return t(e,r),e}},xhr:function(e,t){var r=t.access_token;delete t.access_token,e.headers.Authorization="Bearer "+r,"get"!==e.method&&e.data&&(e.headers["Content-Type"]="application/json","object"==typeof e.data&&(e.data=JSON.stringify(e.data)));"put"===e.method&&(e.method="patch");return!0}}})}(a),function(e){function t(e){e&&"errorCode"in e&&(e.error={code:e.status,message:e.message})}function r(e){if(!e.error)return e.first_name=e.firstName,e.last_name=e.lastName,e.name=e.formattedName||e.first_name+" "+e.last_name,e.thumbnail=e.pictureUrl,e.email=e.emailAddress,e}function n(e){return t(e),i(e),e.values&&(e.data=e.values.map(r),delete e.values),e}function i(e){"_count"in e&&"_start"in e&&e._count+e._start<e._total&&(e.paging={next:"?start="+(e._start+e._count)+"&count="+e._count})}function o(e){e.access_token&&(e.oauth2_access_token=e.access_token,delete e.access_token)}function a(e,t){e.headers["x-li-format"]="json";var r=e.data.id;e.data=("delete"!==e.method).toString(),e.method="put",t("people/~/network/updates/key="+r+"/is-liked")}e.init({linkedin:{oauth:{version:2,response_type:"code",auth:"https://www.linkedin.com/uas/oauth2/authorization",grant:"https://www.linkedin.com/uas/oauth2/accessToken"},refresh:!0,scope:{basic:"r_basicprofile",email:"r_emailaddress",files:"",friends:"",photos:"",publish:"w_share",publish_files:"w_share",share:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.linkedin.com/v1/",get:{me:"people/~:(picture-url,first-name,last-name,id,formatted-name,email-address)","me/share":"people/~/network/updates?count=@{limit|250}"},post:{"me/share":function(e,t){var r={visibility:{code:"anyone"}};e.data.id?r.attribution={share:{id:e.data.id}}:(r.comment=e.data.message,e.data.picture&&e.data.link&&(r.content={"submitted-url":e.data.link,"submitted-image-url":e.data.picture})),e.data=JSON.stringify(r),t("people/~/shares?format=json")},"me/like":a},del:{"me/like":a},wrap:{me:function(e){return t(e),r(e),e},"me/friends":n,"me/following":n,"me/followers":n,"me/share":function(e){return t(e),i(e),e.values&&(e.data=e.values.map(r),e.data.forEach((function(e){e.message=e.headline})),delete e.values),e},default:function(e,r){t(e),function(e,t){"{}"===JSON.stringify(e)&&200===t.statusCode&&(e.success=!0)}(e,r),i(e)}},jsonp:function(e,t){o(t),"get"===e.method&&(t.format="jsonp",t["error-callback"]=e.callbackID)},xhr:function(e,t){return"get"!==e.method&&(o(t),e.headers["Content-Type"]="application/json",e.headers["x-li-format"]="json",e.proxy=!0,!0)}}})}(a),function(e){function t(e,t){var r=t.access_token;return delete t.access_token,t.oauth_token=r,t["_status_code_map[302]"]=200,!0}function r(e){return e.id&&(e.picture=e.avatar_url,e.thumbnail=e.avatar_url,e.name=e.username||e.full_name),e}e.init({soundcloud:{name:"SoundCloud",oauth:{version:2,auth:"https://soundcloud.com/connect",grant:"https://soundcloud.com/oauth2/token"},base:"https://api.soundcloud.com/",get:{me:"me.json","me/friends":"me/followings.json","me/followers":"me/followers.json","me/following":"me/followings.json",default:function(e,t){t(e.path+".json")}},wrap:{me:function(e){return r(e),e},default:function(e){var t;return Array.isArray(e)&&(e={data:e.map(r)}),"next_href"in(t=e)&&(t.paging={next:t.next_href}),e}},xhr:t,jsonp:t}})}(a),function(e){function t(e){return e.id&&(e.name=e.display_name,e.thumbnail=e.images.length?e.images[0].url:null,e.picture=e.thumbnail),e}function r(e){e&&"next"in e&&(e.paging={next:e.next},delete e.next)}e.init({spotify:{name:"Spotify",oauth:{version:2,auth:"https://accounts.spotify.com/authorize",grant:"https://accounts.spotify.com/api/token"},scope_delim:" ",scope:{basic:"",photos:"",friends:"user-follow-read",publish:"user-library-read",email:"user-read-email",share:"",publish_files:"",files:"",videos:"",offline_access:""},base:"https://api.spotify.com",get:{me:"/v1/me","me/following":"/v1/me/following?type=artist","me/like":"/v1/me/tracks"},wrap:{me:t,"me/following":function(e){r(e),e&&"artists"in e&&(e.data=e.artists.items.forEach(t));return e},"me/like":function(e){return r(e),e.data=e.items,e}},xhr:function(e,t){var r=t.access_token;return delete t.access_token,e.headers.Authorization="Bearer "+r,!0},jsonp:!1}})}(a),function(e){var t="https://api.twitter.com/";function r(e){if(e.id){if(e.name){var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=e.profile_image_url_https||e.profile_image_url}return e}function n(e){return i(e),o(e),e.users&&(e.data=e.users.map(r),delete e.users),e}function i(e){if(e.errors){var t=e.errors[0];e.error={code:"request_failed",message:t.message}}}function o(e){"next_cursor_str"in e&&(e.paging={next:"?cursor="+e.next_cursor_str})}e.init({twitter:{oauth:{version:"1.0a",auth:t+"oauth/authenticate",request:t+"oauth/request_token",token:t+"oauth/access_token"},login:function(e){this.oauth.auth=this.oauth.auth.replace("?force_login=true","")+(e.options.force?"?force_login=true":"")},base:t+"1.1/",get:{me:"account/verify_credentials.json","me/friends":"friends/list.json?count=@{limit|200}","me/following":"friends/list.json?count=@{limit|200}","me/followers":"followers/list.json?count=@{limit|200}","me/share":"statuses/user_timeline.json?count=@{limit|200}","me/like":"favorites/list.json?count=@{limit|200}"},post:{"me/share":function(t,r){var n=t.data;t.data=null;var i=[];n.message&&(i.push(n.message),delete n.message),n.link&&(i.push(n.link),delete n.link),n.picture&&(i.push(n.picture),delete n.picture),i.length&&(n.status=i.join(" ")),n.file?(n["media[]"]=n.file,delete n.file,t.data=n,r("statuses/update_with_media.json")):"id"in n?r("statuses/retweet/"+n.id+".json"):(e.utils.extend(t.query,n),r("statuses/update.json?include_entities=1"))},"me/like":function(e,t){var r=e.data.id;e.data=null,t("favorites/create.json?id="+r)}},del:{"me/like":function(){p.method="post";var e=p.data.id;p.data=null,callback("favorites/destroy.json?id="+e)}},wrap:{me:function(e){return i(e),r(e),e},"me/friends":n,"me/followers":n,"me/following":n,"me/share":function(e){return i(e),o(e),!e.error&&"length"in e?{data:e}:e},default:function(e){return o(e=function(e){return Array.isArray(e)?{data:e}:e}(e)),e}},xhr:function(e){return"get"!==e.method}}})}(a),function(e){e.init({vk:{name:"Vk",oauth:{version:2,auth:"https://oauth.vk.com/authorize",grant:"https://oauth.vk.com/access_token"},scope:{email:"email",friends:"friends",photos:"photos",videos:"video",share:"share",offline_access:"offline"},refresh:!0,login:function(e){e.qs.display=window.navigator&&window.navigator.userAgent&&/ipad|phone|phone|android/.test(window.navigator.userAgent.toLowerCase())?"mobile":"popup"},base:"https://api.vk.com/method/",get:{me:function(e,t){e.query.fields="id,first_name,last_name,photo_max",t("users.get")}},wrap:{me:function(e,t,r){return function(e){if(e.error){var t=e.error;e.error={code:t.error_code,message:t.error_msg}}}(e),function(e,t){null!==e&&"response"in e&&null!==e.response&&e.response.length&&((e=e.response[0]).id=e.uid,e.thumbnail=e.picture=e.photo_max,e.name=e.first_name+" "+e.last_name,t.authResponse&&null!==t.authResponse.email&&(e.email=t.authResponse.email));return e}(e,r)}},xhr:!1,jsonp:!0,form:!1}})}(a),function(e){function t(e){return"data"in e&&e.data.forEach((function(e){e.picture&&(e.thumbnail=e.picture),e.images&&(e.pictures=e.images.map(r).sort((function(e,t){return e.width-t.width})))})),e}function r(e){return{width:e.width,height:e.height,source:e.source}}function n(e,t,r){if(e.id){var n=r.query.access_token;if(e.emails&&(e.email=e.emails.preferred),!1!==e.is_friend){var i=e.user_id||e.id;e.thumbnail=e.picture="https://apis.live.net/v5.0/"+i+"/picture?access_token="+n}}return e}function i(e,t,r){return"data"in e&&e.data.forEach((function(e){n(e,0,r)})),e}e.init({windows:{name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!0,logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:"wl.signin,wl.basic",email:"wl.emails",birthday:"wl.birthday",events:"wl.calendars",photos:"wl.photos",videos:"wl.photos",friends:"wl.contacts_emails",files:"wl.skydrive",publish:"wl.share",publish_files:"wl.skydrive_update",share:"wl.share",create_event:"wl.calendars_update,wl.events_create",offline_access:"wl.offline_access"},base:"https://apis.live.net/v5.0/",get:{me:"me","me/friends":"me/friends","me/following":"me/contacts","me/followers":"me/friends","me/contacts":"me/contacts","me/albums":"me/albums","me/album":"@{id}/files","me/photo":"@{id}","me/files":"@{parent|me/skydrive}/files","me/folders":"@{id|me/skydrive}/files","me/folder":"@{id|me/skydrive}/files"},post:{"me/albums":"me/albums","me/album":"@{id}/files/","me/folders":"@{id|me/skydrive/}","me/files":"@{parent|me/skydrive}/files"},del:{"me/album":"@{id}","me/photo":"@{id}","me/folder":"@{id}","me/files":"@{id}"},wrap:{me:n,"me/friends":i,"me/contacts":i,"me/followers":i,"me/following":i,"me/albums":function(e){"data"in e&&e.data.forEach((function(e){e.photos=e.files="https://apis.live.net/v5.0/"+e.id+"/photos"}));return e},"me/photos":t,default:t},xhr:function(t){return"get"===t.method||"delete"===t.method||e.utils.hasBinary(t.data)||("string"==typeof t.data.file?t.data.file=e.utils.toBlob(t.data.file):(t.data=JSON.stringify(t.data),t.headers={"Content-Type":"application/json"})),!0},jsonp:function(t){"get"===t.method||e.utils.hasBinary(t.data)||(t.data.method=t.method,t.method="get")}}})}(a),function(e){function t(e){e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message})}function r(e,r,o){return t(e),i(e,r,o),e.query&&e.query.results&&e.query.results.contact&&(e.data=e.query.results.contact,delete e.query,Array.isArray(e.data)||(e.data=[e.data]),e.data.forEach(n)),e}function n(e){e.id=null,!e.fields||e.fields instanceof Array||(e.fields=[e.fields]),(e.fields||[]).forEach((function(t){"email"===t.type&&(e.email=t.value),"name"===t.type&&(e.first_name=t.value.givenName,e.last_name=t.value.familyName,e.name=t.value.givenName+" "+t.value.familyName),"yahooid"===t.type&&(e.id=t.value)}))}function i(e,t,r){return e.query&&e.query.count&&r.options&&(e.paging={next:"?start="+(e.query.count+(+r.options.start||1))}),e}function o(e){return"https://query.yahooapis.com/v1/yql?q="+(e+" limit @{limit|100} offset @{start|0}").replace(/\s/g,"%20")+"&format=json"}e.init({yahoo:{oauth:{version:"1.0a",auth:"https://api.login.yahoo.com/oauth/v2/request_auth",request:"https://api.login.yahoo.com/oauth/v2/get_request_token",token:"https://api.login.yahoo.com/oauth/v2/get_token"},login:function(e){e.options.popup.width=560;try{delete e.qs.state.scope}catch(t){}},base:"https://social.yahooapis.com/v1/",get:{me:o("select * from social.profile(0) where guid=me"),"me/friends":o("select * from social.contacts(0) where guid=me"),"me/following":o("select * from social.contacts(0) where guid=me")},wrap:{me:function(e){if(t(e),e.query&&e.query.results&&e.query.results.profile){(e=e.query.results.profile).id=e.guid,e.last_name=e.familyName,e.first_name=e.givenName||e.nickname;var r=[];e.first_name&&r.push(e.first_name),e.last_name&&r.push(e.last_name),e.name=r.join(" "),e.email=e.emails&&e.emails[0]?e.emails[0].handle:null,e.thumbnail=e.image?e.image.imageUrl:null}return e},"me/friends":r,"me/following":r,default:i}}})}(a),void 0===(o=function(){return a}.call(t,r,t,e))||(e.exports=o),e.exports&&(e.exports=a)}).call(this,r(10),r(66).setImmediate)},270:function(e,t,r){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},271:function(e,t,r){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},275:function(e,t,r){"use strict";r.r(t);var n=r(36),i=r(25);function o(e){return Array.prototype.slice.call(e)}function a(e){return new Promise((function(t,r){e.onsuccess=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function s(e,t,r){var n,i=new Promise((function(i,o){a(n=e[t].apply(e,r)).then(i,o)}));return i.request=n,i}function c(e,t,r){var n=s(e,t,r);return n.then((function(e){if(e)return new p(e,n.request)}))}function u(e,t,r){r.forEach((function(r){Object.defineProperty(e.prototype,r,{get:function(){return this[t][r]}})}))}function l(e,t,r,n){n.forEach((function(n){n in r.prototype&&(e.prototype[n]=function(){return s(this[t],n,arguments)})}))}function d(e,t,r,n){n.forEach((function(n){n in r.prototype&&(e.prototype[n]=function(){return this[t][n].apply(this[t],arguments)})}))}function h(e,t,r,n){n.forEach((function(n){n in r.prototype&&(e.prototype[n]=function(){return c(this[t],n,arguments)})}))}function f(e){this.p_index=e}function p(e,t){this.p_cursor=e,this._request=t}function m(e){this.p_store=e}function g(e){this.p_tx=e,this.complete=new Promise((function(t,r){e.oncomplete=function(){t()},e.onerror=function(){r(e.error)}}))}function _(e,t,r){this.p_db=e,this.oldVersion=t,this.transaction=new g(r)}function v(e){this.p_db=e}u(f,"p_index",["name","keyPath","multiEntry","unique"]),l(f,"p_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),h(f,"p_index",IDBIndex,["openCursor","openKeyCursor"]),u(p,"p_cursor",["direction","key","primaryKey","value"]),l(p,"p_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(p.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then((function(){return t.p_cursor[e].apply(t.p_cursor,r),a(t._request).then((function(e){if(e)return new p(e,t._request)}))}))})})),m.prototype.createIndex=function(){return new f(this.p_store.createIndex.apply(this.p_store,arguments))},m.prototype.index=function(){return new f(this.p_store.index.apply(this.p_store,arguments))},u(m,"p_store",["name","keyPath","indexNames","autoIncrement"]),l(m,"p_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getAllKeys","count"]),h(m,"p_store",IDBObjectStore,["openCursor","openKeyCursor"]),d(m,"p_store",IDBObjectStore,["deleteIndex"]),g.prototype.objectStore=function(){return new m(this.p_tx.objectStore.apply(this.p_tx,arguments))},u(g,"p_tx",["objectStoreNames","mode"]),d(g,"p_tx",IDBTransaction,["abort"]),_.prototype.createObjectStore=function(){return new m(this.p_db.createObjectStore.apply(this.p_db,arguments))},u(_,"p_db",["name","version","objectStoreNames"]),d(_,"p_db",IDBDatabase,["deleteObjectStore","close"]),v.prototype.transaction=function(){return new g(this.p_db.transaction.apply(this.p_db,arguments))},u(v,"p_db",["name","version","objectStoreNames"]),d(v,"p_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[m,f].forEach((function(t){t.prototype[e.replace("open","iterate")]=function(){var t=o(arguments),r=t[t.length-1],n=this.p_store||this.p_index,i=n[e].apply(n,t.slice(0,-1));i.onsuccess=function(){r(i.result)}}}))})),[f,m].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var r=this,n=[];return new Promise((function(i){r.iterateCursor(e,(function(e){e?(n.push(e.value),void 0===t||n.length!=t?e.continue():i(n)):i(n)}))}))})}));var y=function(e,t,r){var n=s(indexedDB,"open",[e,t]),i=n.request;return i.onupgradeneeded=function(e){r&&r(new _(i.result,e.oldVersion,i.transaction))},n.then((function(e){return new v(e)}))};class b{constructor(e,t){this.dbName=e,this.storeName=t,this.oldCacheTimeOut=i.b}openIdb(){return Promise.resolve().then(()=>y(this.dbName,1,e=>{e.createObjectStore(this.storeName)}))}getValue(e){return this.openIdb().then(t=>t.transaction(this.storeName,"readonly").objectStore(this.storeName).get(e))}setValue(e,t){return this.openIdb().then(r=>{var n=r.transaction(this.storeName,"readwrite"),i=n.objectStore(this.storeName);return at_debug.log("CACHE","Storing new data for key "+e),i.put(t,e),i.put((new Date).getTime(),"ts__"+e),n.complete})}clearCache(e){return this.openIdb().then(t=>{var r=t.transaction(this.storeName,"readwrite"),n=r.objectStore(this.storeName);return at_debug.log("CACHE","clearing cache for key "+e),n.delete(e),n.delete("ts__"+e),r.complete})}clearOldCache(){return this.openIdb().then(e=>{var t=e.transaction(this.storeName,"readwrite"),r=t.objectStore(this.storeName),n=e=>{if(e)return/^ts__/.test(e.key)&&(new Date).getTime()-e.value>this.oldCacheTimeOut&&(at_debug.log("CACHE","clearing cache for key "+e.key),r.delete(e.key),r.delete(e.key.substring(4,e.key.length))),e.continue().then(n)};return r.openCursor().then(n),t.complete})}}var w=class{constructor(e,t,r){this.dbName=void 0,this.dbStore=void 0,this.key=void 0,this.persistedData=void 0,this._idb=void 0,this._oldDataCleared=!1,this._dataUpdateCallback=()=>{},this.clearCacheForKey=this.clearCacheForKey.bind(this),e&&t&&this.setDbStore(e,t,r)}_setPersistedDate(e){var t=this.persistedData;this.persistedData=e,t!==e&&this._dataUpdateCallback(e,t)}setDbStore(e,t,r){e&&t&&(e!==this.dbName||t!==this.dbStore)&&(this.dbName=e,this.dbStore=t,r&&this.setDataCallback(r),void 0!==this.persistedData&&(this.persistedData=void 0),this._idb=new b(e,t),this.key&&this.setKey(this.key))}setDataCallback(e){this._dataUpdateCallback=e}setKey(e){at_debug.log("CACHE","Attempting to load cache for key "+e),this.key=e,this.key&&void 0===this.persistedData?this._idb.getValue(e).then(t=>{void 0!==t?(at_debug.log("CACHE","found cached data for key "+e),this._setPersistedDate(t)):at_debug.log("CACHE","no cached data for key "+e)}):at_debug.log("CACHE","key is undefined or data already persisted, not cycling through cache")}setData(e){this.key&&void 0!==e&&(this._setPersistedDate(e),this._idb.setValue(this.key,e).then(()=>{this._oldDataCleared||(this._oldDataCleared=!0,setTimeout(()=>this._idb.clearOldCache(),5e3))}))}clearCacheForKey(e){this._idb&&this._idb.clearCache(e)}},S=r(24),A=r(3),E=r(2),T=r(58),O=r(7),R=r(12);var k=class{constructor(){this._eventLogged=!1,this._dataFetched=!1}setInfo(e){this._provider=e.provider,this._referrer=e.referrer,this._appId=e.appId,this._appTier=e.appTier,this._vizType=e.vizType,this._allowMapsOverusage=e.allowMapsOverusage}setReferer(e){this._initialReferrer=e}setDataFetched(){this._dataFetched=!0,this._logAppView()}setUser(e){this._userEmail=e.email,this._userId=e.id||"",this._logAppView()}_logAppView(){if(this._userEmail&&!this._eventLogged&&this._dataFetched){try{if(A.a.inPreview(window.top.location.href)||A.a.inPreview(A.a.referrer))return void at_debug.log("We are in preview|edit|settings|print, not dispatching app_display event")}catch(e){at_debug.log("Caught error while verifying origin ",e)}at_debug.log({message:"SEND VIEW EVENT",data:{email:this._userEmail,id:this._userId,appId:this._appId,referrer:this._referrer,app_tier:this._appTier,viz_type:this._vizType,allow_maps_over_usage:this._allowMapsOverusage}}),window.fetch(R.c,{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({event_type:"app_display",event_time:(new Date).getTime(),app_id:this._appId,referrer:this._initialReferrer||this._referrer,user_email:this._userEmail,user_id:this._userId,app_tier:this._appTier,viz_type:this._vizType,allow_maps_over_usage:this._allowMapsOverusage})}).then(e=>{this._eventLogged=!0}).catch(e=>{})}}},I=r(28),C=r(31),P=r(91),D=r(59),x=r(18),N=new S.a("UA-17877121-8","confStats");N.setCustomD({dimension11:E.a.version});var M,L=N;var j=class{constructor(e){this._oldUser={},this.logger=e,this.user=void 0,this.uid=void 0,this.login=this.login.bind(this),this.logout=this.logout.bind(this),this._googleLogin=this._googleLogin.bind(this),this._errorHandler=this._errorHandler.bind(this),this._onIdTokenChanged=this._onIdTokenChanged.bind(this),this.googleLogin=this.googleLogin.bind(this),this.app=n.c,this.ref=n.k,this._googleAuthHelper=new D.a,n.c.auth().onIdTokenChanged(this._onIdTokenChanged,this._errorHandler)}get _refError(){return!M&&(M=this.app.database("https://".concat(E.a.rootDomain,"-errors.firebaseio.com")).ref()),M}_errorHandler(e,t){var r=e.detail||e;if(at_debug.error(JSON.stringify(r,null,"\t")),L.sendStats({category:"error",action:r.code}),"auth/account-exists-with-different-credential"===e.code&&t)return this._fixFirebaseLogin(t).then(()=>L.sendStats({category:"error",action:"success/fix-account-exists-with-different-credential"}))}_fixFirebaseLogin(e){return Object(x.b)(R.h,{fireDomain:E.a.rootDomain,token:e,action:"register",getToken:!0,providerId:C.a[C.c.GOOGLE]}).then(e=>this.app.auth().signInAndRetrieveDataWithCustomToken(e)).then(t=>{var r=firebase.auth.GoogleAuthProvider.credential(null,e);return t.user.linkWithCredential(r)})}_onIdTokenChanged(e){if(e!==this._oldUser){if(this._oldUser=e,!e)return at_debug.log("LOGOUT"),this.user=void 0,this.uid=void 0,void this.logger.setUser({email:"anonymous"});at_debug.log("LOGIN: start"),delete e.providerData[0].gid,e.providerData[0].gid=e.providerData[0].uid,this.user=e.providerData[0],this.uid=e.uid,L.setUserId(this.uid),L.setCustomD({dimension1:this.user.email&&this.user.email.split("@")[1],dimension2:this.uid}),this.logger.setUser({email:this.user.email,id:this.uid}),e.getIdToken(!0).then(e=>{var{user:t}=this;if(!t||!t.providerId)throw"User does not have any provider Id";var r=t&&t.providerId;return Object(x.b)(R.h,{fireIdToken:e,action:"register",fireDomain:E.a.rootDomain,providerId:r})}).then(()=>{at_debug.log("LOGIN: REGISTER success")}).catch(e=>{at_debug.error("LOGIN: REGISTER",e)})}}login(e){return e&&"string"==typeof e?(at_debug.log("START LOGIN"),this.app.auth().signInAndRetrieveDataWithCredential(firebase.auth.GoogleAuthProvider.credential(null,e)).catch(t=>this._errorHandler(t,e)).then(()=>this.app.auth().currentUser)):Promise.resolve(null)}logout(){return at_debug.log("LOGOUT"),this.app.auth().signOut()}_googleLogin(e){return Object(P.c)(e,R.d,R.g).then(e=>{if(!e.access_token)throw e;return e})}googleLogin(e){try{return e?e=>(at_debug.log("Hello js login"),this._googleAuthHelper.login(e)):e=>(at_debug.log("Use Google auth"),this._googleLogin(e))}catch(t){}}},U=r(0),F=r(17),q=r(26);class B{static get API_ENDPOINT(){return"https://ao-docs.appspot.com/_ah/api/"}constructor(e,t,r){this._accessToken=e,this._domain=t,this._securityCode=r}_callAPI(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return t.headers=t.headers||{},this._accessToken&&(t.headers.Authorization="Bearer ".concat(this._accessToken)),this._securityCode&&(t.securityCode=this._securityCode),this._domain&&(t.domain=this._domain),Object(x.b)(B.API_ENDPOINT+e,t,r).catch(e=>e)}listLibraries(e){return e?this._callAPI("library/v1/plain",{},"PUT"):Promise.reject(new Error(B.ERRORS.NO_DOMAIN))}listViews(e){return e?this._callAPI("view/v1/libraries/".concat(e)):Promise.reject(new Error(B.ERRORS.NO_LIBRARY_ID))}probeLibraryAccess(e){if(!e)return Promise.reject(new Error(B.ERRORS.NO_LIBRARY_ID));var t="library/v1/".concat(e),r={include:"NONE",fields:encodeURIComponent("libraryId,name")};return this._callAPI(t,r).then(e=>{if(e.name&&e.libraryId)return{name:e.name,id:e.libraryId};throw"malformed library response"}).catch(()=>({error:{status:"PERMISSION_DENIED"}}))}loadDocumentClass(e,t){if(!e)return Promise.reject(new Error(B.ERRORS.NO_LIBRARY_ID));if(!t)return Promise.reject(new Error(B.ERRORS.NO_DOCUMENT_CLASS_ID));var r="documentType/v1/libraries/".concat(e,"/documentTypes/").concat(t),n={fields:encodeURIComponent("displayName,fields(displayName,id,type),id")};return this._callAPI(r,n).then(e=>({displayName:e.displayName,id:e.id,fields:e.fields?e.fields.map(e=>({displayName:e.displayName,id:e.id,type:e.type})):[]}))}loadDocumentClasses(e,t){return e?t?Array.isArray(t)?Promise.all(t.map(t=>this.loadDocumentClass(e,t))):Promise.reject(new Error(B.ERRORS.NOT_ARRAY_DOCUMENT_CLASSES)):Promise.reject(new Error(B.ERRORS.NO_DOCUMENT_CLASS_ID)):Promise.reject(new Error(B.ERRORS.NO_LIBRARY_ID))}loadDocument(e){if(!e)return Promise.reject(new Error(B.ERRORS.NO_DOCUMENT_ID));var t="document/v1/".concat(e),r={fields:encodeURIComponent("attachments(fileId,mimeType),categories(fieldName,multiple,values),className,fields(fieldName,multiple,type,values),id,systemFields(displayName,value),title")};return this._callAPI(t,r).then(e=>({title:e.title,className:e.className,id:e.id,attachments:e.attachments?e.attachments.map(e=>({fileId:e.fileId,mimeType:e.mimeType})):[],categories:e.categories?e.categories.map(e=>({fieldName:e.fieldName,multiple:e.multiple,type:e.type,values:e.values})):[],fields:e.fields?e.fields.map(e=>({fieldName:e.fieldName,multiple:e.multiple,type:e.type,values:e.values})):[],systemFields:e.systemFields?e.systemFields.map(e=>({displayName:e.displayName,value:e.value})):[]}))}loadDocuments(e){return e?Promise.all(e.map(e=>this.loadDocument(e))):Promise.reject(new Error(B.ERRORS.NO_DOCUMENT_ID))}countDocuments(e,t){return e?t?this._callAPI("search/v1/libraries/".concat(e,"/count"),{classId:t},"POST").then(e=>e.count):Promise.reject(new Error(B.ERRORS.NO_DOCUMENT_CLASS_ID)):Promise.reject(new Error(B.ERRORS.NO_LIBRARY_ID))}getDocumentsByView(e,t){var r="search/v1/libraries/".concat(e,"/views/").concat(t),n=encodeURIComponent("count,documents(attachments(fileId,mimeType),categories(fieldName,multiple,values),className,fields(fieldName,multiple,type,values),id,systemFields(displayName,value),title),precision");return this._callAPI(r,{offset:0,limit:100},"POST").then(e=>{var t=e.count,i=[],o=t-e.documents.length;if(i=i.concat(e.documents),o<=0)return i;for(var a=Math.ceil(o/100),s=[],c=0;c<a;c++)s.push({limit:100,offset:100*(c+1),fields:n});for(var u=0,l=e=>this._callAPI(r,e,"POST").then(e=>({precision:e.precision,count:e.count,documents:e.documents.map(e=>({title:e.title,className:e.className,id:e.id,numberOfAttachments:e.numberOfAttachments,checkOutDate:e.checkOutDate,checkOutBy:e.checkOutBy,modificationDate:e.modificationDate,updateAuthor:e.updateAuthor,creationDate:e.creationDate,initialAuthor:e.initialAuthor,fullSizeOfAttachments:e.fullSizeOfAttachments,state:e.state,stateChangeDate:e.stateChangeDate,versionName:e.versionName,folders:e.folders?e.folders.map(e=>({name:e.name})):[],stateChangeAuthors:e.stateChangeAuthors?e.stateChangeAuthors.map(e=>({displayName:e.displayName})):[],attachments:e.attachments?e.attachments.map(e=>({fileId:e.fileId,mimeType:e.mimeType})):[],categories:e.categories?e.categories.map(e=>({fieldName:e.fieldName,multiple:e.multiple,type:e.type,values:e.values})):[],fields:e.fields?e.fields.map(e=>({fieldName:e.fieldName,multiple:e.multiple,type:e.type,values:e.values})):[],systemFields:e.systemFields?e.systemFields.map(e=>({displayName:e.displayName,value:e.value})):[]}))})),d=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250,i=void 0===r?u++:r;if(i>=a)return t;var o=s[i];return l({limit:o.limit,offset:o.offset}).then(e=>{if(!e.documents)throw"retry";return t=t.concat(e.documents),{}}).catch(()=>new Promise(e=>setTimeout(e,n)).then(()=>(o.failure=(o.failure||0)+1,o.failure>=3?{}:{retryIndex:i,delay:2*n}))).then(r=>{var{retryIndex:n,delay:i}=r;return void 0!==n?e(t,n,i):e(t)})},h=[],f=0;f<5;f++)h.push(d());return Promise.all(h).then(e=>e).then(e=>i.concat(e.flat()))})}getDocsFromViews(e,t){if(!Array.isArray(t))return Promise.reject(new Error(B.ERRORS.NO_LIST_OF_VIEW_DOC_CLASS));var r=Promise.resolve(),n=[];return t.map(t=>{r=r.then(()=>this.getDocumentsByView(e,t)).then(e=>n.push(e))}),r.then(()=>n.flat())}}B.ERRORS={NO_DOCUMENT_ID:"Document ID must not be empty",NO_DOMAIN:"Domain must not be empty!",NO_LIBRARY_ID:"Library ID must not be empty!",NO_DOCUMENT_CLASS_ID:"Document Class ID must not be empty!",NO_DOCUMENT_CLASSES:"Document Classes must not be empty!",NO_VIEW_ID:"Document Class ID must not be empty!",NO_LIST_OF_VIEW_DOC_CLASS:"Not a list of pair of viewId and docClass",NOT_ARRAY_DOCUMENT_CLASSES:"Document Class IDs must be an array!"};var H=B,G=r(47),V=r(9),W=function(e){var[t,r]=e.match(/(^[A-Z]+)|([0-9]+$)/gm)||[];if(void 0===t&&void 0===r)throw"Invalid cell reference";var n={row:null,col:null};return void 0!==r&&(n.row=function(e){return+e-1}(r)),void 0!==t&&(n.col=function(e){if("string"!=typeof e)throw"Expected column label";for(var t=0,r=(e=e.toUpperCase()).length-1,n=0;r>-1;r--,n++)t+=(e.charCodeAt(r)-64)*Math.pow(26,n);return t}(t)),n},z=function(e){try{var[t,r]=e.split(":"),n=W(t),i=r&&W(r)||n;return{start:n,end:i,width:null!==n.col&&null!==i.col?i.col-n.col+1:null,height:null!==n.row&&null!==i.row?i.row-n.row+1:null}}catch(o){throw"Invalid range reference"}},K=r(1),Y=function(){var e=Object.keys(K).map(e=>K[e].regex||K[e]);return new RegExp("^\\s+|\\s+$|(?:(?:\\s*-\\s*|\\s)((".concat(e.join("|"),")(?:\\s?\\(([^)]+)\\))?)(?:\\s*-\\s*(?!\\w)|\\s(?!\\w))?)"),"ig")},J=function(e){for(var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Y(),i=(r?"":"- ")+e,o=[];null!==(t=n.exec(i));)if(t[1]){var[,,a,s]=t;o.push({keyword:a.toLowerCase(),params:s?s.split(/\s*,\s*/):null})}return o},$=function(e,t,r){var n,i=function(e){var t={};return e.cols.forEach(e=>{t[e.label.replace(Y(),"")]=J(e.label,!0)}),t}(e.data),o=Y();if(e.data.cols.forEach(e=>{e.label=e.label.replace(o,"")}),t.data){var{templateColumnsSettings:a,templates:s}=function(e,t){var r,n,i=z(t),o=null;return(r=1===i.height||1===e.rows.length?{templates:[{label:V.e,template:""+e.rows[0].c[0].v}],onlyDisplay:{[V.e]:!0},noAutoAdd:!1}:3===i.height&&3===e.rows.length?{templates:(n=[],o={},e.cols.forEach((t,r)=>{if(e.rows[2].c[r]&&null!==e.rows[2].c[r].v&&""!==e.rows[2].c[r].v){var i=""+(e.rows[0].c[r]&&e.rows[0].c[r].v||V.c).trim();n.push({label:i,template:""+(e.rows[2].c[r].v||"")}),o[i]=J(""+(e.rows[1].c[r]&&e.rows[1].c[r].v||""))}}),n),noAutoAdd:!1}:{templates:(()=>{var t=[];return e.rows.length>0&&e.cols.forEach((r,n)=>{e.rows[1].c[n]&&null!==e.rows[1].c[n].v&&""!==e.rows[1].c[n].v&&t.push({label:""+(e.rows[0].c[n]&&e.rows[0].c[n].v||V.c).trim(),template:""+(e.rows[1].c[n].v||"")})}),t})(),noAutoAdd:3!==i.height}).signature=F.a.SHA256(JSON.stringify(r)).toString(),{templateColumnsSettings:o,templates:r}}(t.data,r);n=s,a&&Object.keys(a).forEach(e=>{i[e]?a[e].forEach(t=>{var r=i[e].find(e=>e.keyword===t.keyword);r?r.params=t.params:i[e].push(t)}):i[e]=a[e]})}return new q.a({data:{dataTable:e.data,signature:e.sig||F.a.SHA256(JSON.stringify(e.data)).toString()},settings:{columns:i,signature:F.a.SHA256(JSON.stringify(i)).toString()},template:n||null})},Q={[V.f]:!0,[V.d]:!0,[V.c]:!0,[V.e]:!0};class X{constructor(e){this.name=U.a.AODOCS,this.tools=e,this.isAuth=!1,this._accessToken="",this._source=void 0,this._dateFormat="yyyy/mm/dd"}_auth(){if(at_debug.log("FETCH_DATA","start AUTH"),this.ready=new Promise((e,t)=>{this._authDone_res=e,this._authDone_rej=t}),this._accessToken)return this.isAuth=!0,void new H(this._accessToken).probeLibraryAccess(this._source.libraryId).then(()=>{this._authDone_res()}).catch(()=>{this._authDone_rej()});this._loginAuthUser(0)}_loginAuthUser(e){if(e>=X.CONSTS.AUTH_USER_MAX_TENTATIVES)return at_debug.log("FETCH_DATA","auth FAILED, waiting for manual login"),this.tools.showManualLogin(),void this.tools.sendAuthAnalytics("max tentative");at_debug.log("FETCH_DATA","login with user ".concat(e)),this.tools.login({authUser:e}).then(t=>(this._accessToken=t&&t.access_token||"",this.isAuth=!0,new H(this._accessToken,this._source.domain).probeLibraryAccess(this._source.libraryId).then(t=>{if(!t.error)return this._authDone_res();this._accessToken="",this.isAuth=!1,this._loginAuthUser(e+1)}))).then(()=>{this.tools.sendAuthAnalytics(e)}).catch(()=>{this._accessToken="",this.isAuth=!1,this._loginAuthUser(e+1)})}_extractFieldNames(e){if(!e)throw new Error(X.ERRORS.EMPTY_AODOCS_LIST);if(!Array.isArray(e))throw new Error(X.ERRORS.DOCS_NOT_ARRAY);var t=[{label:"Title",type:"string"},{label:"Class Name",type:"string"},{label:"ID",type:"string"},{label:"Description",type:"string"},{label:"Attachment number",type:"string"},{label:"Checked out date",type:"string"},{label:"Checked out by",type:"string"},{label:"Last update",type:"string"},{label:"Last update author",type:"string"},{label:"Creation date",type:"string"},{label:"Document creator",type:"string"},{label:"Folder",type:"string"},{label:"Full size",type:"string"},{label:"State",type:"string"},{label:"State change date",type:"string"},{label:"State change authors",type:"string"},{label:"Version name",type:"string"}];return e.forEach(e=>{e.fields.forEach(e=>{-1===X._findWithProperty(t,"label",e.displayName)&&t.push({label:e.displayName,type:X._convertType(e.type)})})}),t}_buildDataTable(e,t){if(!e)throw new Error(X.ERRORS.EMPTY_FIELDS);if(!t)throw new Error(X.ERRORS.EMPTY_AODOCS_LIST);if(!Array.isArray(t))throw new Error(X.ERRORS.DOCS_NOT_ARRAY);for(var r={cols:[],rows:[]},n=0;n<e.length;n++){var i={id:Object(x.c)(n+1),label:e[n].label,type:e[n].type};i.type===X.AODOCS_TYPES.DATE&&(i.pattern=this._dateFormat),r.cols.push(i)}return t.forEach(t=>{if(t){var n={c:X._createDefaultArray({v:"",f:""},e.length)};n.c[X._findWithProperty(e,"label","Title")]={v:t.title},n.c[X._findWithProperty(e,"label","Class Name")]={v:t.className},n.c[X._findWithProperty(e,"label","ID")]={v:t.id},n.c[X._findWithProperty(e,"label","Attachment number")]={v:t.numberOfAttachments},n.c[X._findWithProperty(e,"label","Checked out at")]=t.checkOutDate?this._extractDateValue([t.checkOutDate],!1):"",n.c[X._findWithProperty(e,"label","Checked out by")]={v:t.checkOutBy},n.c[X._findWithProperty(e,"label","Last update")]=t.modificationDate?this._extractDateValue([t.modificationDate],!1):"",n.c[X._findWithProperty(e,"label","Last update author")]={v:t.updateAuthor},n.c[X._findWithProperty(e,"label","Creation date")]=t.creationDate?this._extractDateValue([t.creationDate],!1):"",n.c[X._findWithProperty(e,"label","Document creator")]={v:t.initialAuthor},n.c[X._findWithProperty(e,"label","Folder")]={v:t.folders&&t.folders.map(e=>e.name).join("/")},n.c[X._findWithProperty(e,"label","Full size")]={v:t.fullSizeOfAttachments},n.c[X._findWithProperty(e,"label","State")]={v:t.state},n.c[X._findWithProperty(e,"label","State change date")]=t.stateChangeDate&&this._extractDateValue([t.stateChangeDate],!1),n.c[X._findWithProperty(e,"label","State change authors")]={v:t.stateChangeAuthors&&t.stateChangeAuthors.map(e=>e.displayName).join(", ")},n.c[X._findWithProperty(e,"label","Version name")]={v:t.versionName},t.systemFields.forEach(t=>{t.value&&(n.c[X._findWithProperty(e,"label",t.displayName)]={v:t.value})}),t.fields.forEach(t=>{var{fieldName:r,type:i,multiple:o,values:a}=t;if(a){var s=X._convertType(i),c=X._findWithProperty(e,"label",r);switch(s){case X.AT_TYPES.DATE:n.c[c]=this._extractDateValue(a,o);break;case X.AT_TYPES.NUMBER:n.c[c]=this._extractNumberValue(a,o);break;default:n.c[c]={v:o?a.join("\n"):a[0]}}}}),t.categories&&t.categories.forEach(t=>{t.values&&(n.c[X._findWithProperty(e,"label",t.fieldName)]={v:this._extractAODocsCategoryValues(t.values).slice(0,-2)})}),r.rows.push(n)}}),r}_loadTemplateSettings_fromAttachment(e){return e?this._AODocsAPI.loadDocument(e).then(e=>{if(!e.attachments)throw X.ERRORS.NO_ATTACHMENT;var t=e.attachments.filter(e=>e.mimeType===X.CONSTS.SPREADSHEET_MIME_TYPE),{"Settings Sheet Name":r,"Settings Sheet Range":n}=this._getAODocsFields(e,["Settings Sheet Name","Settings Sheet Range"]),i=r&&r.values?r.values[0]:void 0,o=n&&n.values?n.values[0]:void 0;return this._getTemplateSettingsFromSheet(t[0].fileId,i,o)}).then(e=>({templates:e.template,columnsSettings:e.settings})):{templates:void 0,columnsSettings:void 0}}_getTemplateSettingsFromSheet(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1:3",n="https://sheets.googleapis.com/v4/spreadsheets/".concat(e,"?fields=sheets/properties/title,sheets/data&ranges=").concat(t,"!").concat(r,"&key=").concat(E.a.apiKey),i={headers:{}};return this._accessToken&&(i.headers.Authorization="Bearer ".concat(this._accessToken)),Object(x.b)(n,i).then(e=>{if(!("sheets"in e&&Array.isArray(e.sheets)&&"data"in e.sheets[0]&&Array.isArray(e.sheets[0].data)&&Array.isArray(e.sheets[0].data)&&"rowData"in e.sheets[0].data[0]))throw new Error(X.ERRORS.MALFORMED_SHEET_RESPONSE);var t=e.sheets[0].data[0].rowData,r=(t[0].values||[]).map(e=>e.formattedValue),n={};return(t[1].values||[]).forEach((e,t)=>{Q[r[t]]||(n[r[t]]=J(e.formattedValue))}),{template:(t[2].values||[]).map((e,t)=>({label:r[t],template:e.formattedValue})).filter(e=>void 0!==e.template),settings:n}})}_extractNumberValue(e,t){var r=e.map(e=>+e);return{v:t?r.join("\n"):r[0]}}_extractDateValue(e,t){var r=[],n=[];return[].concat(e).forEach(e=>{var t=new Date(parseInt(e)),i=t.getDate(),o=t.getMonth(),a=t.getFullYear();r.push("Date(".concat(a,",").concat(o,",").concat(i,")")),n.push(this._dateFormat.replace(/d+/i,String(i)).replace(/m+/i,String(o)).replace(/y+/i,String(a)))}),{v:t?r.join("\n"):r[0],f:t?n.join("\n"):n[0]}}_extractAODocsCategoryValues(e){if(Array.isArray(e)){var t="";return e.forEach(e=>{t+=this._extractAODocsCategoryValues(e)}),t}return e.name?e.name+", ":""}_getAODocsFields(e,t){t=[].concat(t);var r={};return e.fields.filter(e=>t.includes(e.fieldName)).forEach(e=>{r[e.fieldName]=e}),r}static _findWithProperty(e,t,r){if(!Array.isArray(e))throw new Error(X.ERRORS.FIELD_LIST_NOT_ARRAY);return e.map(e=>e[t]).indexOf(r)}static _createDefaultArray(e,t){if(!Number.isInteger(t))throw new Error("Size must be an integer!");return new Array(t).fill(e,0,t)}static _convertType(e){switch(e.toLowerCase()){case X.AODOCS_TYPES.DECIMAL:case X.AODOCS_TYPES.INTEGER:return X.AT_TYPES.NUMBER;case X.AODOCS_TYPES.DATE:return X.AT_TYPES.DATE;case X.AODOCS_TYPES.TIME:return X.AT_TYPES.DATE_TIME;default:return X.AT_TYPES.STRING}}set(e){e.token&&(this._accessToken=e.token),this._source=new G.a(e.sourceSettings),this._auth()}getData(){return this.ready.then(()=>{var e={},t=Object.keys(this._source.views).map(t=>(e[this._source.views[t].docClass]=!0,t)),r=Object.keys(e);this._AODocsAPI=new H(this._accessToken,this._source.domain,this._source.securityCode);var n=[this._AODocsAPI.loadDocumentClasses(this._source.libraryId,r),this._AODocsAPI.getDocsFromViews(this._source.libraryId,t),this._loadTemplateSettings_fromAttachment(this._source.templateDocId)];return Promise.all(n).then(e=>{var[t,r,{templates:n,columnsSettings:i}]=e,o=this._extractFieldNames(t),a=this._buildDataTable(o,r),s=F.a.SHA256(JSON.stringify(a)).toString(),c=n&&F.a.SHA256(JSON.stringify(n)).toString(),u=i&&F.a.SHA256(JSON.stringify(i)).toString();return new q.a({data:{dataTable:a,signature:s},settings:{columns:i,signature:u},template:{templates:n,signature:c,onlyDisplay:void 0,noAutoAdd:!1}})}).catch(e=>{throw e})})}getCacheKey(){return this._source.cacheKey}buildCacheKey(e){return e.libraryId&&e.views?e.libraryId+Object.keys(e.views).join(""):JSON.stringify(e)}onManualLogin(){this.tools.login({authUser:-1,immediate:!1}).then(e=>{this._accessToken=e&&e.access_token||"",this.isAuth=!0,this.tools.loginDone(this.isAuth),this._authDone_res()}).catch(e=>{e.error&&"popup_closed_by_user"===e.error||(this._accessToken="",this.isAuth=!1,this.tools.loginDone(this.isAuth),this._authDone_rej())})}}var Z=X;X.CONSTS={AUTH_USER_MAX_TENTATIVES:6,SPREADSHEET_MIME_TYPE:"application/vnd.google-apps.spreadsheet"},X.ERRORS={EMPTY_FIELDS:"Field object must not be empty!",EMPTY_AODOCS_LIST:"AODocs document list must not be empty!",DOCS_NOT_ARRAY:"AODocs document list must be an array!",FIELD_LIST_NOT_ARRAY:"Field list must be an array!",NO_ATTACHMENT:"There must be an attachment on the document!",MALFORMED_SHEET_RESPONSE:"The sheet data response is not in the expected format!"},X.FIELD_KEYWORDS={DATE_FORMAT:"Date Format"},X.AT_TYPES={STRING:"string",DATE:"date",DATE_TIME:"datetime",NUMBER:"number"},X.AODOCS_TYPES={STRING:"string",TEXT:"text",DATE:"date",TIME:"time",DATE_TIME:"date & time",INTEGER:"integer",DECIMAL:"decimal",BOOLEAN:"boolean",PERSON:"person",GEOPOINT:"geopoint",URL:"url"};var ee=r(92),te=r(46),re=r(48);class ne{constructor(e){this.name=U.a.EXCEL,this.tools=e,this._source=void 0,this._accessToken=null,this._userProfile=null,this._isManualLogin=!1,this._promptMode=null,this._ms=new ee.a}_auth(){at_debug.log("FETCH_DATA","start MS AUTH"),this._ready=new Promise((e,t)=>{this._authDone_res=e,this._authDone_rej=t}),this._ms.onLogin(this._loggedIn.bind(this));var e=this._ms.hasValidSession();if(this._accessToken||e)return at_debug.log("Using local session cache"),this.isAuth=!0,this._accessToken=e.access_token,void this._authDone_res();this._attemptSilentAuth()}_loggedIn(){at_debug.log("User is logged in with Microsoft Account"),this._ms.hasValidSession()&&(this._accessToken=this._ms.token.access_token,this.isAuth=!0,this._authDone_res(),this.tools.loginDone(this.isAuth,this._isManualLogin))}_getSheetData(e,t){return this._ms.graph.workBookSheetByDriveAndWorkbookId(this._source.driveId,this._source.workbookId,e,t).then(t=>{if(at_debug.log("We have data for sheet '"+e+"' ",t),t.hasOwnProperty("error"))throw t.error;return t}).catch(e=>{throw at_debug.log("Error on getSheet Data !",e),e})}_attemptSilentAuth(){var e=this,t=!1,r=function(r){t||(t=!0,clearTimeout(n),e.tools.showManualLogin(i.a.MICROSOFT),e._isManualLogin=!0)},n=setTimeout(r,4e3);this._ms.login(!0).then((function(){clearTimeout(n)}),r)}_buildDataTableFromArrays(e,t,r){for(var n,i,o,a={cols:e[0].map((e,t)=>({id:Object(x.c)(t+1),label:e,type:"string",isNumber:!0,isDate:!0,isEmpty:!0})),parsedNumHeaders:1,rows:[]},s=2;s<e.length;s++){for(var c=e[s],u=t[s],l=r[s],d=[],h=0;h<c.length;h++)isNaN(c[h])&&(a.cols[h].isNumber=!1),""!=c[h]&&(a.cols[h].isEmpty=!1),null===(o=l[h]).match(/^#|([^\\])#/g)&&(o.indexOf(";@")>0||o.indexOf("AM/PM")>0||null!==o.match(/^y|([^\\])y/g)||null!==o.match(/^m|([^\\])m/g)||null!==o.match(/^d|([^\\])d/g)||null!==o.match(/^h|([^\\])h/g)||null!==o.match(/^s|([^\\])s/g)||null!==o.match(/\[\$-(.*?)]/g))?c[h]=(n=c[h],i=void 0,isNaN(n)?null:(i=n<61?new Date(1e3*Math.round(86400*(n-25568))):new Date(1e3*Math.round(86400*(n-25569))),"Date(".concat(i.getUTCFullYear(),",").concat(i.getUTCMonth(),",").concat(i.getUTCDate(),",").concat(i.getUTCHours(),",").concat(i.getUTCMinutes(),",").concat(i.getUTCSeconds(),",").concat(i.getUTCMilliseconds(),")"))):a.cols[h].isDate=!1,d.push({v:c[h],f:u[h]});a.rows.push({c:d})}for(var f=0;f<e[0].length;f++)a.cols[f].isEmpty?a.cols[f].type="string":a.cols[f].isDate?a.cols[f].type="datetime":a.cols[f].isNumber&&(a.cols[f].type="number");return a}static get templateDefault(){return{noAutoAdd:!0,onlyDisplay:null,signature:null,templates:[]}}static isTemplateNotExists(e){if(!e.length)return!0;var t=e[0];return 1===t.length&&!t[0]}_buildTemplateTableFromArrays(e,t){if(ne.isTemplateNotExists(e))return ne.templateDefault;var r,n=z(t);return(r=1===e.length?{templates:[{label:V.e,template:""+e[0][0]}],noAutoAdd:!1}:3===e.length?{templates:e[0].map((t,r)=>{if(e[2][r])return{label:(""+t||V.c).trim(),template:""+(e[2][r]||"")}}),noAutoAdd:!1}:{templates:e[0].map((t,r)=>({label:(""+t||V.c).trim(),template:""+(e[1][r]||"")})),noAutoAdd:3!==n.height}).signature=F.a.SHA256(JSON.stringify(r)).toString(),r}_getColumnsSettings(e,t){var r={};return e[0].map((t,n)=>{r[t]=J(e[1][n])}),3===t.length&&t[0].map((e,n)=>{r[e]=J(t[1][n])}),r}_getViewDataTemplate(e,t,r){var n=this._buildDataTableFromArrays(e.values,e.text,e.numberFormat),i=this._getColumnsSettings(e.values,t),o=this._buildTemplateTableFromArrays(t,r);return new q.a({data:{dataTable:n,signature:n&&F.a.SHA256(JSON.stringify(n)).toString()},settings:{columns:i,signature:F.a.SHA256(JSON.stringify(i)).toString()},template:o})}set(e){var t=!this._source;e.token&&(this._accessToken=e.token),this._source=new re.a(e.sourceSettings),t&&this._auth()}getUsedRangeForWorkSheet(e){return(t,r)=>{if(!r)return this._ms.graph.workBookSheetByDriveAndWorkbookId(e.driveId,e.workbookId,t,void 0,"address").then(e=>{var{address:t}=e;return t.split("!")[1]});if((e=>!!te.d.exec(e.split(":")[1]))(r))return r;var n=r;return this._ms.graph.workBookSheetByDriveAndWorkbookId(e.driveId,e.workbookId,t,void 0,"address").then(e=>{var{address:t}=e,r=t.split("!")[1].split(":");return 2!==r.length?null:n+(e=>{if(!e)return null;var t=te.d.exec(e);return t?t[0]:null})(r[1])})}}getData(){var{dataRange:e,dataSheet:t,templateRange:r,templateSheet:n,driveId:i,workbookId:o}=this._source,a=this.getUsedRangeForWorkSheet({driveId:i,workbookId:o});return this._ready.then(()=>Promise.all([a(t,e),(n||r)&&a(n,r)])).then(e=>{var[r,i]=e;at_debug.log("fetch ms data");var o=[this._getSheetData(t||"Data",r||void 0),i];return n&&o.push(this._getSheetData(n||"Template",i||void 0)),Promise.all(o)}).then(e=>{var[t,r,n]=e,i=n&&n.values?n.values:[];return this._getViewDataTemplate(t,i,r)}).catch(e=>{throw at_debug.error("Error thrown in getData() with error : ",e),at_debug.error("Removing session cache"),e||this._ms.logout(),e})}getCacheKey(){return this.buildCacheKey(this._source)}buildCacheKey(e){return JSON.stringify(e)}onManualLogin(){var e={};this._promptMode&&(e.prompt=this._promptMode),this._ms.login(!1,e).then(function(){at_debug.log("[onManualLogin]","Successfully logged into microsoft"),this._promptMode=null}.bind(this),(function(e){at_debug.error("[onManualLogin]","Microsoft sign in error: "+e.error.message)}))}}var ie=ne,oe={},ae=0,se={};window.__JsonpRequest_cb__=oe;class ce{static get requestCount(){return ae}static set requestCount(e){ae=e}static get callBack(){return oe}static get TIMEOUT(){return 6e4}constructor(e,t){this.timeOut=t||ce.TIMEOUT,this.resolve=null,this.reject=null,this.requestId=ce.requestCount++,se["_".concat(this.requestId)]=this,this.node=document.createElement("script"),this.callBackName="getResponse".concat(this.requestId,"_"),oe[this.callBackName]=ce._callBackFunc.bind(this),this.query=e.replace("{{callBack}}","__JsonpRequest_cb__.".concat(this.callBackName)),/{{requestId}}/.test(e)&&(this.query=this.query.replace("{{requestId}}",this.requestId))}_queryCleanUp(e){this.node&&(document.head.removeChild(this.node),delete this.node),e?oe[this.callBackName]=()=>{this._queryCleanUp()}:delete oe[this.callBackName],delete se["_"+this.requestId]}send(){var e=new Promise((e,t)=>{this.resolve=e,this.reject=t,setTimeout(t.bind(null,O.d.REQUEST_TIMEOUT),this.timeOut)});return this.node.onerror=this.reject,this.node.src=this.query,document.head.appendChild(this.node),e.then(function(){return this._queryCleanUp(),1==arguments.length?arguments[0]:arguments}.bind(this)).catch(e=>{throw this._queryCleanUp(!0),e})}static errorHandler(e){var t,r=e.filename||"",n=/__JsonpRequest_cb__\.getResponse(\d+)_/.exec(r);if(n)t=se["_".concat(n[1])];else{if("Script error."!=e.message||""!=e.filename)return;var i=Object.keys(se);if(!(t=se[i[i.length-1]]))return}t.reject()}static _callBackFunc(){this.resolve.apply(null,1==arguments.length?arguments:[arguments])}}window.addEventListener("error",ce.errorHandler);var ue=ce,le=r(37);var de=class{constructor(){this.name=U.a.PROXY,this._source=void 0}set(e){this._source=new le.a(e.sourceSettings)}getData(){return new ue("".concat(this._source.proxyUrl,"&callback={{callBack}}"),9e4).send().then(e=>{if("error"===e.status&&"not_modified"===e.reason)throw O.d.NOT_MODIFIED;return $({data:e.dataTable,sig:e.sig},{data:e.template,sig:e.sigTemplate},this._source.templateRange)})}getCacheKey(){return this.buildCacheKey(this._source)}buildCacheKey(e){return"".concat(e.proxyUrl||e.proxy,"&").concat(e.spsUrl,"headers=2&range=").concat(e.dataRange||"","&sheet=").concat(e.dataSheet||"")+(e.query?"__"+e.query:"")+(e.templateSheet&&e.templateRange?"__templateSheet=".concat(e.templateSheet,"&templateRange=").concat(e.templateRange):"")}},he=r(161),fe=r.n(he),pe={_getInstance:()=>window._sharedStackDriver||window.top._sharedStackDriver||null,sendCustomError:(e,t)=>{try{var r="object"==typeof e?e:{message:e,name:"[SPREADSHEET API] [UNKOWN]"};r.additional=t,null!==pe._getInstance()&&pe._getInstance().report(r)}catch(n){}}};function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){_e(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _e(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ve=0;class ye{static get callbackPrefix(){return"__JsonpFetchRequest_cb__.getResponse"}static get requestCount(){return ve}static set requestCount(e){ve=e}static get TIMEOUT(){return 6e4}constructor(e,t){this.timeOut=t||ye.TIMEOUT,this.requestId=ye.requestCount++,this.callBackName="".concat(ye.callbackPrefix).concat(this.requestId),this.query=e.replace("{{callBack}}",this.callBackName),/{{requestId}}/.test(e)&&(this.query=this.query.replace("{{requestId}}",this.requestId))}send(){return this._fetchWithTimeout(this.query,this.timeOut).then(e=>{if(200!==e.status)throw 429===e.status?O.d.RESOURCE_EXHAUSTED:e.statusText||e.status;return e.text()}).then(this._parseResponse.bind(this)).catch(e=>{var t=[];return"AbortError"===e.name||e.message&&"Request timed out"===e.message?t.push({message:O.d.REQUEST_TIMEOUT}):t.push({message:e}),{errors:t}})}_parseResponse(e){if(e.indexOf(this.callBackName)<0)throw"Not a Google Visualization JSONP";var t=e.substring(this._jsonpPosition(e)).slice(0,-2);try{return JSON.parse(t)}catch(r){throw"Unable to parse JSONP response"}}_jsonpPosition(e){return e.indexOf(this.callBackName)+this.callBackName.length+1}_fetchWithTimeout(e,t,r){if("undefined"==typeof AbortController)return new Promise((n,i)=>{var o=setTimeout(()=>i(new Error("Request timed out")),t);fetch(e,r).then(e=>n(e),e=>i(e)).finally(()=>clearTimeout(o))});var n=new AbortController,{signal:i}=n;return setTimeout(()=>n.abort(),t),fetch(e,ge(ge({},r),{},{signal:i}))}}var be=ye,we=r(38);function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){Ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ee(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Te{constructor(e){this.name=U.a.SPREADSHEET,this.tools=e,this._useCache=!0,this._accessToken="",this.isAuth=void 0,this._testReq={},this._isPublicSpreadsheet=void 0,this._source=void 0,window.yzxqswi=!0,window.alert=()=>{}}_auth(){if(at_debug.log("FETCH_DATA","start AUTH"),this.ready=new Promise((e,t)=>{this._authDone_res=e,this._authDone_rej=t}),this._accessToken)return this.isAuth=!0,void this._probeSheetAccess().then(e=>this._getData_success(e)).catch(e=>{at_debug.log("ERROR in _auth",e),this._accessToken="",this.isAuth=!1,Te._checkFatalError(e)?this._authDone_rej(e):this._probeSheetAccess().then(e=>this._getData_success(e)).catch(e=>{at_debug.log("ERROR in _auth step 2",e),Te._checkFatalError(e)?this._authDone_rej(e):this._isPublicSpreadsheet?this.tools.showError(this._isPublicSpreadsheet,e):this.tools.showManualLogin()})});if(this._source.domain&&this.tools.storageAccess){this.ready.then(()=>this.tools.getUserEmail(this._accessToken)).then(e=>{var t=localStorage.getItem("hints");t=(t&&-1===t.indexOf(e)?t+",":"")+e,localStorage.setItem("hints",t)}).catch(()=>{}),at_debug.log("FETCH_DATA","login with domain");for(var e,t=localStorage.hints&&localStorage.hints.split(",")||[],r=0;r<t.length;r++)if(-1!==t[r].indexOf(this._source.domain)){e=t[r];break}e?(at_debug.log("FETCH_DATA","login with hint: ".concat(e)),this.tools.login({login_hint:e}).then(e=>(this._accessToken=e&&e.access_token||"",this.isAuth=!0,this._probeSheetAccess())).then(e=>this._getData_success(e)).catch(e=>{at_debug.log("ERROR in _auth (email)",e),Te._checkFatalError(e)?this._authDone_rej(e):(at_debug.error("FETCH_DATA","login with hint failed, retry with no auth"),this._accessToken="",this.isAuth=!1,this._probeSheetAccess().then(e=>this._getData_success(e)).catch(e=>{at_debug.log("ERROR in _auth (email) step 2 ",e),Te._checkFatalError(e)?this._authDone_rej(e):this._isPublicSpreadsheet?this.tools.showError(this._isPublicSpreadsheet,e):this.tools.showManualLogin()}))})):this._loginAuthUser(0)}else this.ready.then(()=>this.tools.getUserEmail(this._accessToken)).catch(()=>{}),at_debug.log("FETCH_DATA","try public load"),this._probeSheetAccess().then(e=>this._getData_success(e)).catch(e=>{at_debug.log("ERROR in _auth (no domain) ",e),Te._checkFatalError(e)?this._authDone_rej(e):(at_debug.log("FETCH_DATA","public load FAIL: data is not accessible"),Te._checkTemporaryQuotaError(e)?this.tools.showError(this._isPublicSpreadsheet,e):this._loginAuthUser(0))})}_getSheetData(e){var{sheet:t,headerRows:r,range:n,query:i,sig:o,forceUpdate:a}=e;i="string"==typeof i?i:"";var s="".concat(this._source.spsUrl,"headers=").concat(r||0,"&range=").concat(encodeURIComponent(n)||"","&sheet=").concat(encodeURIComponent(t)||""),c=s+i;if(this._testReq[c]){if(!a)return Promise.resolve({data:this._testReq[c].data,sig:this._testReq[c].sig});delete this._testReq[c]}var u=s+"&quotaUser=".concat(this._quotaUser())+(this._accessToken?"&access_token=".concat(this._accessToken):"")+(i?"&tq=".concat(encodeURIComponent(i)):"")+"&tqx=reqId%3A{{requestId}}"+(o?";sig%3A".concat(o):"")+";responseHandler%3A{{callBack}}";return new be(u,9e4).send().then(e=>{var r=e.errors&&e.errors[0]&&e.errors[0].message;if(r)throw pe.sendCustomError({message:r,name:"[GSHEET APIERROR] [_getSheetData]"},"Error for user ".concat(this._isPublicSpreadsheet," for query ").concat(u," on _getSheetData")),r;if(-1!==i.toLowerCase().indexOf("label")){var[a,s]=n.split(":"),c=parseInt(a.replace(/[a-zA-Z]*/g,""))+1,l=a.replace(/[0-9]*/g,"")+c+":"+(s.replace(/[0-9]*/g,"")+c),d="".concat(this._source.spsUrl,"headers=1&range=").concat(encodeURIComponent(l)||"","&sheet=").concat(encodeURIComponent(t)||"")+"&quotaUser=".concat(this._quotaUser())+(this._accessToken?"&access_token=".concat(this._accessToken):"")+"&tqx=reqId%3A{{requestId}}"+(o?";sig%3A".concat(o):"")+";responseHandler%3A{{callBack}}";return new be(d,9e4).send().then(t=>{if(t.errors){var r=t.errors&&t.errors[0]&&t.errors[0].message;if(r)throw pe.sendCustomError({message:r,name:"[GSHEET APIERROR] [_getSheetData label]"},"Error for user ".concat(this._quotaUser()," for query ").concat(d," on _getSheetData")),r}else{var n=t.table.cols.reduce((e,t)=>Ae(Ae({},e),{},{[t.id]:t.label}),{});e.table.cols.forEach(e=>{-1===e.label.indexOf(n[e.id])&&(e.label="".concat(e.label," ").concat(n[e.id]))})}return{data:e.table,sig:e.sig}})}return{data:e.table,sig:e.sig}})}_getData_success(e){at_debug.log("FETCH_DATA","auth SUCCESS");var t="".concat(this._source.spsUrl,"headers=2&range=").concat(encodeURIComponent(this._source.dataRange),"&sheet=").concat(encodeURIComponent(this._source.dataSheet));this._testReq[t+this._source.query]={data:e.data,sig:e.sig},this._authDone_res()}_loginAuthUser(e){e>=Te.AUTH_USER_MAX_TENTATIVES?this._probeSheetAccess().then(e=>{this._getData_success(e)}).catch(e=>{at_debug.log("ERROR in _loginAuthUser ",e),Te._checkFatalError(e)?this._authDone_rej(e):(at_debug.log("FETCH_DATA","auth FAILED, waiting for error or manual login if no cache"),this.tools.showError(this._isPublicSpreadsheet,e),this.tools.sendAuthAnalytics("max tentative"))}):(at_debug.log("FETCH_DATA","login with user ".concat(e)),this.tools.login({authUser:e}).then(e=>(this._accessToken=e&&e.access_token||"",this.isAuth=!0,this._probeSheetAccess())).then(t=>{this._getData_success(t),this.tools.sendAuthAnalytics(e)}).catch(t=>{at_debug.log("ERROR in tools.login ",t),this._accessToken="",this.isAuth=!1,Te._checkFatalError(t)?this._authDone_rej(t):this._isPublicSpreadsheet?this.tools.showError(this._isPublicSpreadsheet,t):this._loginAuthUser(e+1)}))}_isSpreadsheetPublic(e){return"boolean"==typeof this._isPublicSpreadsheet?Promise.resolve(this._isPublicSpreadsheet):fetch("https://docs.google.com/spreadsheets/d/".concat(e,"/trash/read?includes_info_params=true"),{method:"HEAD",redirect:"manual"}).then(e=>e.status<=200?e.headers.get("content-type")&&e.headers.get("content-type").indexOf("application/json")>=0||!1:this._source.isPublicSps||!1).catch(()=>this._source.isPublicSps||!1)}_probeSheetAccess(){return new Promise((e,t)=>{this._isSpreadsheetPublic(this._source.spsId).then(e=>(this._isPublicSpreadsheet=e,at_debug.log("Spreadsheet is "+(e?"public":"private")),this._source.isPublicSps!==e&&this.tools.updateAccess(e),this._probeSheet(this._source.spsId))).then(e=>{if(e.error&&(pe.sendCustomError(Ae(Ae({},e.error),{},{name:"[GSHEET APIERROR] [_probeSheet]"}),"Status ".concat(e.error.code," (").concat(e.error.status,") for spreadsheet ").concat(this._source.spsId," on probesheet for user ").concat(this._quotaUser())),e.error.status&&e.error.status===O.d.PERMISSION_DENIED))throw O.d.ACCESS_DENIED;return this._getSheetData({sheet:this._source.dataSheet,range:this._source.dataRange,headerRows:2,query:this._source.query,forceUpdate:!0})}).then(e).catch(e=>{at_debug.log("ERROR in _probeSheetAccess",e),t(e)})})}_quotaUser(){if(this.tools.storageAccess)try{var e=localStorage.getItem("_QUSER");if(!e)e=localStorage.getItem("_BEAMER_USER_ID_".concat(E.a.beamerProductID,"_").concat(E.a.beamerProductID))||Te._generateUUID(),localStorage.setItem("_QUSER",e);return e}catch(t){at_debug.error("QUOTA","Unable to access local storage")}return Te._generateUUID()}_probeSheet(e){var t=this._quotaUser(),r="https://sheets.googleapis.com/v4/spreadsheets/".concat(e,"?fields=spreadsheetId&quotaUser=").concat(t,"&key=").concat(E.a.probeApiKey);return fe.a.get(r,{headers:{Authorization:"Bearer ".concat(this._accessToken)}})}static _checkTemporaryQuotaError(e){return"string"==typeof e&&e in this.ERROR_QUOTA_LIMIT}static _checkFatalError(e){return"string"==typeof e&&e in this.ERROR_FATAL}static _generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}set(e){var t=!this._source;this._forceUpdate=e.forceUpdate,this._useCache=e.useCache,e.token&&(this._accessToken=e.token),this._source=new we.a(e.sourceSettings),t&&this._auth()}getData(){return this.ready.then(()=>Promise.all([this._getSheetData({sheet:this._source.dataSheet,range:this._source.dataRange,headerRows:2,query:this._source.query,forceUpdate:this._forceUpdate}),this._source.hasTemplate&&this._getSheetData({sheet:this._source.templateSheet,range:this._source.templateRange,headerRows:0,forceUpdate:this._forceUpdate})])).then(e=>{var[t,r]=e;if(!t.data)throw Te.ERRORS.NO_DATA_IN_RESPONSE;return $(t,r,this._source.templateRange)}).catch(e=>{if(!this._forceUpdate)throw e;return this._forceUpdate=!1,this._auth(),this.getData()}).catch(e=>{throw"string"!=typeof e&&(e=O.d.LOADING_ERROR),at_debug.error("FETCH_DATA",e),e})}getCacheKey(){return this.buildCacheKey(this._source)}buildCacheKey(e){return"".concat(e.spsUrl,"headers=2&range=").concat(e.dataRange||"","&sheet=").concat(e.dataSheet||"")+(e.query?"__"+e.query:"")+(e.templateSheet&&e.templateRange?"__templateSheet=".concat(e.templateSheet,"&templateRange=").concat(e.templateRange):"")}onManualLogin(){this.tools.login({authUser:-1,immediate:!1}).then(e=>{this._accessToken=e&&e.access_token||"",this.isAuth=!0,this.tools.loginDone(this.isAuth),this._authDone_res()}).catch(e=>{e.error&&"popup_closed_by_user"===e.error||(this._accessToken="",this.isAuth=!1,this.tools.loginDone(this.isAuth),this._authDone_rej())})}}Te.AUTH_USER_MAX_TENTATIVES=6,Te.ERROR_AUTH=O.a,Te.ERROR_FATAL=O.b,Te.ERROR_QUOTA_LIMIT=O.c,Te.ERRORS={NO_DATA_IN_RESPONSE:"Error: no Data in response"};var Oe={spreadsheet:Te,proxy:de,aodocs:Z,ms_excel:ie};var Re={[I.a.HAS_NO_EMAIL]:"hasNoEmail",[I.a.GET_DATA]:"getData",[I.a.SET_AUTH_PROVIDER]:"setAuthProvider"},ke=class{constructor(){this.logger=new k,this._ref=window.name,this._queryLogin=new j(this.logger),this._viewId=null,this._sendDataCallBack=null,this.source=void 0,this._listener=this._listener.bind(this),this._onManualLogin=this._onManualLogin.bind(this),this._observe_persistedData=this._observe_persistedData.bind(this),this._cache=new w("awesome-table-db","awesome-table-store",this._observe_persistedData),this._hasLoadedFromCache=!1,window.addEventListener("message",this._listener,!1),document.getElementById("loginBtn").addEventListener("click",this._onManualLogin,!1),this.sendMessage({loaded:!0})}_listener(e){if(e.origin===E.a.domainProtocol+E.a.viewDomainHost&&"object"==typeof e.data&&"ref"in e.data&&e.data.ref===this._ref&&e.data._id&&e.data.msg&&Re[e.data.msg]){var t=t=>{void 0!==t&&this.sendMessage({_id:e.data._id,_res:t})},r=()=>{this.sendMessage({_id:e.data._id,_fail:!0})};Promise.resolve().then(()=>this[Re[e.data.msg]](e.data.data,t,r)).then(t).catch(r)}}sendMessage(e){e.ref=this._ref,window.parent.postMessage(e,"*")}setAuthProvider(e){document.body.className=e}hasNoEmail(e){return Promise.resolve().then(()=>this._queryLogin.ref.child("views/".concat(e,"/hasEmail")).once("value")).then(()=>!1).catch(e=>"PERMISSION_DENIED"===e.code)}getData(e,t){this._sendDataCallBack=t,e.viewId&&(this._viewId=e.viewId),e.initialReferrer&&this.logger.setReferer(e.initialReferrer),this.logger.setInfo({provider:e.sourceSettings.source,appId:this._viewId,referrer:A.a.referrer,appTier:e.appTier,vizType:e.vizType,allowMapsOverusage:e.allowMapsOverusage});var r=Object(T.a)().safari;return this._checkStorageAccess().then(n=>(!e.sourceSettings.source||this.source&&this.source.name===e.sourceSettings.source||(this.source=new Oe[e.sourceSettings.source]({clearCache:this._cache.clearCacheForKey,login:this._queryLogin.googleLogin(r),getUserEmail:this._getUserEmail.bind(this),loginDone:this._loginDone.bind(this),showManualLogin:this._showManualLogin.bind(this),sendAuthAnalytics:this._sendAuthAnalytics.bind(this),showError:this._showError.bind(this),updateAccess:this._updateSpreadsheetPublic.bind(this),storageAccess:n})),e.useCache&&this._cache.setKey(this.source.buildCacheKey(e.sourceSettings)),this.source.set(e),this.source.getData().then(t=>{e.useCache?this._cache.setData(t):this._sendData(t,!1,!1)}).catch(r=>{r!==O.d.NOT_MODIFIED&&(this.source.ERROR_FATAL&&!(r in this.source.ERROR_FATAL)&&(r=O.d.LOADING_ERROR),at_debug.error("FETCH_DATA",r),t({error:r,useCache:e.useCache,dataFromCache:!1}))})))}_checkStorageAccess(){return Promise.resolve().then(()=>{if(document.hasStorageAccess)return document.hasStorageAccess().then(e=>document.requestStorageAccess().then(()=>!0).catch(()=>(at_debug.log("Storage access not accessible"),!1)));try{if(void 0===window.localStorage)return!1}catch(e){return!1}return!0})}_sendData(e,t,r){this._sendDataCallBack&&this._sendDataCallBack({content:e,useCache:t,dataFromCache:r}),this.logger.setDataFetched()}_observe_persistedData(e,t){t&&JSON.stringify(e)===JSON.stringify(t)||(this._hasLoadedFromCache=void 0===t,this._hasLoadedFromCache?at_debug.log("QUERY_FRAME","Have data from cache, sending the data and load to view"):at_debug.log("QUERY_FRAME","Have fresh data, sending the data update the view"),this._sendData(e,!0,void 0===t))}_getUserEmail(e){return this._queryLogin.login(e).then(e=>e&&e.providerData&&e.providerData[0].email||null)}_onManualLogin(){this.source.onManualLogin&&this.source.onManualLogin()}_loginDone(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.sendMessage({manualLogin:t,isAuth:e})}_updateSpreadsheetPublic(e){if(this._viewId){at_debug.log("Setting spreadsheet as public = ".concat(e," for view ").concat(this._viewId));try{Object(n.g)("views/".concat(this._viewId,"/settings/source"),{isPublicSps:e})}catch(t){}}}_showError(e,t){var r=t&&(t===O.d.REQUEST_TIMEOUT||t===O.d.RESOURCE_EXHAUSTED);e&&this._hasLoadedFromCache?at_debug.log("QueryFrame","Keeping cache displayed"):e?this.sendMessage({showError:!0,reason:t,isAPILimitation:r}):this._showManualLogin()}_showManualLogin(e){this._hasLoadedFromCache&&this.source&&this._cache.clearCacheForKey(this.source.getCacheKey()),this.sendMessage({showLogin:!0,authSource:e||i.a.GOOGLE})}_sendAuthAnalytics(e){this._authAnalytics||(this._authAnalytics=new S.a("UA-17877121-7","awtDomain"),this._authAnalytics.setCustomD({dimension4:A.a.version,dimension15:E.a.module})),this._authAnalytics.sendStats({hitType:"event",eventCategory:"latestAuth",eventAction:e,eventLabel:E.a.rootDomain})}},Ie=/(?:^\?|&)debug(?:&|$)/.test(document.location.search);window.at_debug=Ie?window.console:{log:()=>{},error:()=>{}},new ke},28:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={HAS_NO_EMAIL:"noEmail?",GET_DATA:"getData?",SET_AUTH_PROVIDER:"setAuthProvider?"}},3:function(e,t,r){"use strict";r(67);var n=r(2),i={VIEW:"view",EDIT:"edit",PRINT:"print",SETTINGS:"settings",QUERY:"query",PICKER:"picker"},o={GADGET:"gadget",IFRAME:"iframe",PRINT:"print",SITE:"site",PREVIEW:"preview"},a=(window.awesomeTable||{}).settings||{},s=document.referrer,c=document.URL;function u(){try{var e=s&&/\/\/[^\/]+?googleusercontent\.com\/gadgets\/ifr\?.*url=[^&]+awesome-table\.xml.*parent=([^?]+?)(?:\?|&.+|$)/.exec(s);if(e&&e[1]){var t=c.match(/https?:\/\/.+?\?(.+)$/);return t=t&&t.length>1?"?"+t[1]:"",e[1]+t}}catch(r){}return""}function l(e){if(!e)return o.SITE;var[,t,,r]=/https?:\/\/([^\/]+)?\/([^\/]+)\/(view|print|edit|settings|preview)|(?:\?.+)?/.exec(e);return t!==n.a.rootDomainComplete?"":{preview:o.PREVIEW,view:o.SITE,print:o.PRINT,edit:o.PREVIEW,settings:o.PREVIEW}[r]||o.SITE}function d(e){return""===s?c:e===o.GADGET?u():s}var h,f=(h=/https?:\/\/(?:[^\/]+)(?:\/views)?\/(?:(?:[^\/]+)\/(view|edit|settings)|(create))/.exec(document.URL))&&"settings"===h[1]?i.SETTINGS:a.mode,p=function(){var e=a.location;return e?e===o.SITE?""!==u()?o.GADGET:function(){try{if(s){var e=/https?:\/\/([^\/]+)(?:\/views)?\/(?:([^\/]+)\/(view|print|edit|settings)|(create))(?:\?.+)?/.exec(s);if(e&&e[1]===n.a.rootDomainComplete&&"view"===e[3])return!1}return window.self!==window.top}catch(t){return!0}}()?l(s)||o.IFRAME:o.SITE:e:""}(),m=a.version||0,g=d(p).split("?")[0],_=function(e,t,r){var n=e(t),i=e=>e.replace(/.+?(?=\?)/,""),o=(e,t)=>e===t?"":e,a=o(i(n),n);return{originQueryString:o(i(r),r),referrerQueryString:a}}(d,p,c),v=function(e){var t=new URLSearchParams(window.location.search).get(e);try{if(t)return!0;if(""===t)return!0;throw 0}catch(r){return!1}}("atDataSet");"http://localhost:5000"!==window.location.origin&&"https://awesometable-dev-view.firebaseapp.com"!==window.location.origin&&"https://awt-feature-demo-view.firebaseapp.com"!==window.location.origin&&p===o.PREVIEW&&(window.console.log=function(){},window.console.group=function(){}),t.a={get location(){return p},setMode:function(e){f=e},inPreview:function(e){var t=l(e);return t===o.PREVIEW||t===o.PRINT||/^https:\/\/sites\.google\.com\/(site|a\/[^\/]+)\/[^\/]+\/system/.test(e)},get mode(){return f},get version(){return m},get referrer(){return g},get locationParameters(){return""===_.originQueryString?_.referrerQueryString:_.originQueryString},get atDataSet(){return v},MODES:i,LOCATIONS:o,GSITE_NEW:"https://www.google.com/url"}},31:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return c}));var n=r(11),i=r(12),o={MICROSOFT:"MICROSOFT",GOOGLE:"GOOGLE"},a={[o.MICROSOFT]:o.MICROSOFT.toLowerCase()+".com",[o.GOOGLE]:o.GOOGLE.toLowerCase()+".com"},s=(o.MICROSOFT.toLowerCase(),o.MICROSOFT,o.GOOGLE.toLowerCase(),o.GOOGLE,{[o.GOOGLE]:{OAUTH_SCOPE_EDIT:i.e,OAUTH_SCOPE_VIEW:i.g,OAUTH_CLIENT_ID:i.d,WEB_SERVICE_URL:i.h,LOGIN_DISPLAY_PARAMS:{name:o.GOOGLE,icon:"awt:google-super-g",msgName:"googleLogin",msgId:"loginWithGoogle"}},[o.MICROSOFT]:{OAUTH_SCOPE_EDIT:n.i,OAUTH_SCOPE_VIEW:n.j,OAUTH_SCOPE_COPY_VIEW:n.h,OAUTH_CLIENT_ID:n.a,OAUTH_PROMPT_MODES:n.g,OAUTH_REDIRECT_URL:n.c,LOGIN_DISPLAY_PARAMS:{name:o.MICROSOFT,icon:"awt:ms-icon",msgName:"msLogin",msgId:"loginWithMicrosoft"}}}),c=[s[o.GOOGLE].LOGIN_DISPLAY_PARAMS,s[o.MICROSOFT].LOGIN_DISPLAY_PARAMS]},36:function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"k",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"i",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return f})),r.d(t,"j",(function(){return p}));var n=r(2),i=firebase.initializeApp({apiKey:n.a.apiKey,authDomain:n.a.authDomain||"".concat(n.a.rootDomain,".firebaseapp.com"),databaseURL:"https://".concat(n.a.rootDomain,".firebaseio.com/")},"at"),o=i.database().ref(),a=firebase.database.ServerValue.TIMESTAMP,s=firebase.auth.GoogleAuthProvider;function c(e){if(!e||0===e.length)throw new Error("scopes needed");for(var t=new firebase.auth.GoogleAuthProvider,r=0;r<e.length;r++)t.addScope(e[r]);return t}var u=(e=>{if(!e)throw new Error("firebase database driver need params");var{app:t,ref:r}=e;if(!t||!r)throw new Error("firebase database issue with params");return{read:function(e){return r.child(e).once("value")},set:function(e,t){return r.child(e).set(t)},insert:function(e,t){return r.child(e).push(t)},update:function(e,t){return r.child(e).update(t)},updateRoot:e=>r.update(e),userIdToken:function(){var e,r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return null===(e=t.auth().currentUser)||void 0===e?void 0:e.getIdToken(r)}}})({app:i,ref:o}),l=u.read,d=u.set,h=(u.insert,u.update),f=u.updateRoot,p=u.userIdToken},37:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0);class i{constructor(e){this.source=n.a.PROXY,this.proxy=e.proxy||"",this.options=e.options||"",this.spsId=e.spsId||"",this.dataSheet=e.dataSheet||"",this.dataRange=e.dataRange||"",this.templateSheet=e.templateSheet||"",this.templateRange=e.templateRange||"",this.query=e.query||"",this.spsUrl=e.spsUrl||"https://docs.google.com/spreadsheets/d/".concat(this.spsId,"/gviz/tq?")}_buildProxyUrl(){var e=this.proxy;return e+="".concat(-1!==e.indexOf("?")?"&":"?","url=").concat(this.spsUrl,"headers=2&range=").concat(this.dataRange,"&sheet=").concat(this.dataSheet).concat(this.options),this.templateSheet&&this.templateRange&&(e+="&templateSheet=".concat(this.templateSheet,"&templateRange=").concat(this.templateRange)),e}get proxyUrl(){return this._buildProxyUrl()}}i.proxy_SourceSettings={key:"proxy",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"proxy"},i.spsId_SourceSettings={key:"spsId",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"spreadsheet-id",label:"SpreadSheet ID"},i.dataSheet_SourceSettings={key:"dataSheet",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"data-sheet-name",label:"Select a Sheet"},i.dataRange_SourceSettings={key:"dataRange",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"data-range",label:"Range"},i.templateSheet_SourceSettings={key:"templateSheet",type:n.c.STRING,defaultValue:"",required:!1,descriptionRef:"data-template-sheet",label:"Template Sheet"},i.templateRange_SourceSettings={key:"templateRange",type:n.c.STRING,defaultValue:"",itemPerRow:2,required:!1,descriptionRef:"data-template-range",label:"Template Range"},i.query_SourceSettings={key:"query",type:n.c.STRING,defaultValue:"",required:!1,descriptionRef:"data-query",label:"Query"},i.spsUrl_SourceSettings={_value:"",key:"spsUrl",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"spreadsheet URL",set(e){this._value=e?e.replace(/\/edit.*$/,"/gviz/tq?"):this.defaultValue}},i.default_SourceSettings=[i.proxy_SourceSettings,i.spsId_SourceSettings,i.dataSheet_SourceSettings,i.dataRange_SourceSettings,i.templateSheet_SourceSettings,i.templateRange_SourceSettings,i.spsUrl_SourceSettings,i.query_SourceSettings]},38:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0);class i{constructor(e){this.source=n.a.SPREADSHEET;var t=/https?:\/\/[^\/]*?\/(?:a\/([^\/]+?)\/)?spreadsheets\/d\/([^\/]+?)\/|https?:\/\/[^\/]+?\/(?:a\/([^\/]+?)\/)?spreadsheet\/ccc\?[^\/]*?key=([^\/]+?)(?=#|$|&)/.exec(e.spsUrl||"");this.spsId=e.spsId||t&&t.length&&t[1]||"",this.domain=e.domain||t&&t.length&&t[1]||"",this.dataSheet=e.dataSheet||"",this.dataRange=e.dataRange||"",this.templateSheet=e.templateSheet||"",this.templateRange=e.templateRange||"",this.query=e.query||"",this.isPublicSps=e.isPublicSps||!1,this.spsUrl=e.spsUrl||(this.domain?"https://docs.google.com/a/".concat(this.domain,"/spreadsheets/d/").concat(this.spsId,"/gviz/tq?"):"https://docs.google.com/spreadsheets/d/".concat(this.spsId,"/gviz/tq?"))}get hasTemplate(){return!(!this.templateSheet||!this.templateRange)}}i.spsId_SourceSettings={key:"spsId",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"spreadsheet-id"},i.domain_SourceSettings={key:"domain",type:n.c.STRING,defaultValue:"",required:!1,descriptionRef:"domain"},i.dataSheet_SourceSettings={key:"dataSheet",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"data-sheet-name"},i.dataRange_SourceSettings={key:"dataRange",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"data-range"},i.templateSheet_SourceSettings={key:"templateSheet",type:n.c.STRING,_value:"",defaultValue:"",required:!1,descriptionRef:"template-sheet"},i.templateRange_SourceSettings={key:"templateRange",type:n.c.STRING,defaultValue:"",itemPerRow:2,required:!1,templateRangeClass:"templateRange",descriptionRef:"template-range"},i.query_SourceSettings={key:"query",type:n.c.STRING,defaultValue:"",required:!1,descriptionRef:"query"},i.isPublicSps_SourceSettings={key:"isPublicSps",type:n.c.BOOLEAN,defaultValue:!1,required:!1,descriptionRef:"isPublicSps"},i.spsUrl_SourceSettings={_value:"",key:"spsUrl",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"spreadsheet URL",set(e){this._value=e?e.replace(/\/edit.*$/,"/gviz/tq?"):this.defaultValue}},i.proxy_SourceSettings={key:"proxy",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"proxy",label:"Apps Script proxy url"},i.default_SourceSettings=[i.spsId_SourceSettings,i.dataSheet_SourceSettings,i.dataRange_SourceSettings,i.templateSheet_SourceSettings,i.templateRange_SourceSettings,i.query_SourceSettings,i.domain_SourceSettings,i.spsUrl_SourceSettings,i.proxy_SourceSettings,i.isPublicSps_SourceSettings]},45:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(11),i=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};class o{constructor(e){if(this.userInfos=()=>this._call("me"),this.getMySites=e=>this._call("sites?search=".concat(e||"*","&$select=name,webUrl,displayName")),this.workBookWorkSheetsInfos=(e,t)=>this._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets")),this.getExcelFileName=(e,t)=>this._call("drives/".concat(e,"/items/").concat(t,"?$select=name")),this.getMySharepointUrl=()=>i(this,void 0,void 0,(function*(){try{var e=yield this._call("me/?$select=mySite");if(200!==e.status)throw new Error("Issue get my sharepoint "+e.status);var t=yield e.json();return t.hasOwnProperty("mySite")&&t.mySite?t.mySite+"Documents/Forms/All.aspx":null}catch(r){throw r}})),this.callGraphEndpoint=e=>i(this,void 0,void 0,(function*(){return e._graphEndpoint?yield this._call(e._graphEndpoint):yield null})),this.getWorkbook=(e,t)=>i(this,void 0,void 0,(function*(){try{return o._buildNewWorkbookItem(yield this._call("drives/".concat(e,"/items/").concat(t)))}catch(r){throw r}})),this.userAndSharedWorkBooks=()=>Promise.all([this.userWorkbooks(),this.sharedWorkbooks()]),this.copyWorkbook=(e,t,r)=>this._call("drives/".concat(t,"/items/").concat(e,"/copy"),"POST",!1,r),this.uploadWorkbookFromBinaryValue=(e,t,r,n)=>this._call("drives/".concat(e,"/items/").concat(t,":/").concat(encodeURIComponent(this._validateFileName(n)),":/content"),"PUT",!0,r,!1,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"),this._validateFileName=e=>e.replace(/[#*<>\/:?]/g,""),this.retrieveWorkbookAfterCopy=(e,t)=>this._call("drives/".concat(e,"/items/").concat(t)),!e)throw new Error("params needed for graph helper");this.bearerToken=null,this.bearerToken=e.hasOwnProperty("session")&&e.session.hasOwnProperty("access_token")?e.session.access_token:null,this.baseUrl=n.d}static extractDriveAndWorkbookId(e){var t={driveId:"",workbookId:""},r=e.hasOwnProperty("remoteItem")?e.remoteItem:e;return r.hasOwnProperty("id")&&r.hasOwnProperty("parentReference")&&r.parentReference.hasOwnProperty("driveId")&&(t.driveId=r.parentReference.driveId,t.workbookId=r.id),t}static _buildGraphEndpoint(e){var t=o.extractDriveAndWorkbookId(e);return""!==t.driveId&&"drives/".concat(t.driveId,"/items/").concat(t.workbookId)}photoBlob(){return this._call("me/photos('48x48')/$value","GET",!1)}workbookSheetByWorkbookId(e,t){return this._call("me/drive/items/".concat(e,"/workbook/worksheets('").concat(t,"')/usedRange"))}workBookSheetByDriveAndWorkbookId(e,t,r,n,i){return n?this._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets('").concat(r,"')/range(address='").concat(n,"')")):this._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets('").concat(r,"')/usedRange").concat(i?"?$select=".concat(i):""))}workbookSheetByGraphEndpoint(e,t){return this._call("".concat(e,"/workbook/worksheets('").concat(t,"')/usedRange"))}userWorkbooks(){return i(this,void 0,void 0,(function*(){var e=yield this._call("me/drive/root/search(q='.xlsx')");return e.hasOwnProperty("value")&&e.value&&e.value.length&&e.value.constructor===Array?e.value.map(e=>o._buildNewWorkbookItem(e)):[]}))}sharedWorkbooks(){return i(this,void 0,void 0,(function*(){var e=yield this._call("me/drive/sharedWithMe");return e.hasOwnProperty("value")&&e.value&&e.value.length&&e.value.constructor===Array?e.value.map(e=>o._buildNewWorkbookItem(e)):[]}))}_call(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5?arguments[5]:void 0;if(!this.bearerToken)throw new Error("Not authenticated");var a={method:t,headers:{"Content-type":o||"application/json",authorization:"Bearer ".concat(this.bearerToken)}};return n&&(a.body=i?JSON.stringify(n):n),fetch("".concat(this.baseUrl).concat(e),a).then(e=>r?e.json():e)}get bearerToken(){return this._bearerToken}set bearerToken(e){this._bearerToken=e}}o._buildNewWorkbookItem=e=>Object.assign(Object.assign({},e),{_graphEndpoint:o._buildGraphEndpoint(e),call:()=>fetch(n.d+o._buildGraphEndpoint(e))}),t.b=o},46:function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return u}));var n=r(0),i=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=/\D+/,a=/\d+/,s=(e,t)=>i(void 0,void 0,void 0,(function*(){if(!e||!t)return null;var r,{id:n,parentReference:a}=e,{webUrl:s}=yield t.getWorkbook(a.driveId,n),c=e=>{var t=o.exec(e);return t?t[0]:""},u=e=>{var[t,r]=e.split(":");return r?[t,c(r)].join(":"):""},l=e=>t=>({["".concat(e,"Sheet")]:t.name,["".concat(e,"Range")]:u(t.address.split("!")[1])}),d=e=>{var t={},n=l("data");if(1===e.length)return n(e[0]);for(var i=0;i<e.length;i++){var o=e[i];if("data"===o.name.toLowerCase())return n(o);"template"!==o.name.toLowerCase()&&void 0===r&&(t=n(o),r=i)}return t},h=e=>{if(1===e.length)return null;for(var t=null,n=l("template"),i=0;i<e.length;i++){var o=e[i];if("template"===o.name.toLowerCase())return n(o);"data"!==o.name.toLowerCase()&&r!==i&&(t=n(o))}return t},f=e=>t.workBookSheetByDriveAndWorkbookId(a.driveId,n,e,void 0,"address");return{getViewEditWorkSheetInfo:()=>i(void 0,void 0,void 0,(function*(){var{data:e,template:r}=yield i(void 0,void 0,void 0,(function*(){var{value:e}=yield t.workBookWorkSheetsInfos(a.driveId,n),r=yield Promise.all(e.map(e=>i(void 0,void 0,void 0,(function*(){return yield Object.assign({name:e.name},yield f(e.name))}))));return{data:d(r),template:h(r)}}));return Object.assign(Object.assign({webUrl:s,driveId:a.driveId,workbookId:n},e),r||{})})),getUsedRangeForWorkSheet:f,createValues:l,id:n,parentReference:a}})),c=(e,t,r,n,o)=>i(void 0,void 0,void 0,(function*(){var i={parentReference:{driveId:t.driveId,id:t.folderId},name:"".concat(r).concat(o?" ("+o+")":"",".xlsx")},a=yield n.copyWorkbook(e.id,e.driveId,i);return 409===a.status?(o||(o=0),o++,c(e,t,r,n,o)):l(a,t,n)})),u=(e,t,r,o)=>i(void 0,void 0,void 0,(function*(){var a="Awesome Table Template ".concat((new Date).toLocaleDateString().replace(/\//g,"-"),".xlsx"),s=0,c=()=>i(void 0,void 0,void 0,(function*(){var i=yield fetch(e).catch(e=>{throw new Error(e)}),u=yield o.uploadWorkbookFromBinaryValue(t.driveId,t.folderId,yield i.arrayBuffer(),r);if(!u.id||!u.webUrl){if(++s<=3)return 3===s&&(r=a),c();throw"Failed to copy workbook"}return{type:n.a.EXCEL,spsResult:u}}));return yield c()})),l=(e,t,r)=>i(void 0,void 0,void 0,(function*(){var i=e.headers.get("location"),o=yield fetch(i),a=yield o.json(),s=yield r.retrieveWorkbookAfterCopy(t.driveId,a.resourceId);return{type:n.a.EXCEL,spsResult:s}}))},47:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0);class i{constructor(e){this.source=n.a.AODOCS,this.source=n.a.AODOCS,this.libraryId=e.libraryId||"",this.domain=e.domain||"",this.views=e.views||{},this.securityCode=e.securityCode||"",this.templateDocId=e.templateDocId||""}_buildCacheKey(){return this.libraryId+Object.keys(this.views).join("")}get cacheKey(){return this._buildCacheKey()}}i.libraryId_SourceSettings={key:"libraryId",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"library-id"},i.securityCode_SourceSettings={key:"",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"security-code"},i.domain_SourceSettings={key:"domain",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"domain"},i.views_SourceSettings={key:"views",type:n.c.LIST,defaultValue:{defaultId:{docClass:"doc class",index:"default index"}},required:!0,descriptionRef:"views"},i.templateDocId_SourceSettings={key:"templateDocId",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"template-doc-id"},i.default_SourceSettings=[i.domain_SourceSettings,i.libraryId_SourceSettings,i.securityCode_SourceSettings,i.templateDocId_SourceSettings,i.views_SourceSettings]},48:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(0);class i{constructor(e){this.source=n.a.EXCEL,this.source=n.a.EXCEL,this.workbookId=e.workbookId||"",this.dataSheet=e.dataSheet||"",this.dataRange=e.dataRange||"",this.templateSheet=e.templateSheet||"",this.templateRange=e.templateRange||"",this.driveId=e.driveId||"",this.webUrl=e.webUrl||""}}i.workbookId_SourceSettings={key:"workbookId",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"workbook-id"},i.dataSheet_SourceSettings={key:"dataSheet",type:n.c.STRING,defaultValue:"Data",required:!0,descriptionRef:"data-sheet-name",label:"Data Sheet"},i.dataRange_SourceSettings={key:"dataRange",type:n.c.STRING,defaultValue:"",required:!1,descriptionRef:"data-range"},i.templateSheet_SourceSettings={key:"templateSheet",type:n.c.STRING,defaultValue:"",required:!1,descriptionRef:"template-sheet"},i.templateRange_SourceSettings={key:"templateRange",type:n.c.STRING,defaultValue:"",itemPerRow:2,required:!1,descriptionRef:"template-range"},i.driveId_SourceSettings={key:"driveId",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"driveId"},i.webUrl_SourceSettings={key:"webUrl",type:n.c.STRING,defaultValue:"",required:!0,descriptionRef:"workbook-web-url"},i.default_SourceSettings=[i.webUrl_SourceSettings,i.driveId_SourceSettings,i.workbookId_SourceSettings,i.dataRange_SourceSettings,i.dataSheet_SourceSettings,i.templateSheet_SourceSettings,i.templateRange_SourceSettings]},57:function(e,t,r){"use strict";function n(e){return new Promise((t,r)=>{e.then(t,r)})}r.d(t,"a",(function(){return h}));var i=r(27),o=r.n(i),a=r(31),s=r(12),c=r(11),u=r(2).b.ms_oauth_proxy_url,l=(()=>{var e={[c.e]:c.a,[s.b]:s.d},t={[c.e]:{base:c.d,get:{driveId:"me/drive",me:"me",sharedSheet:"users/@{userId}/drive/items/{@workbookId}/worksheets('@{sheetName}')/usedRange",sheet:"me/drive/items/@{workbookId}/workbook/worksheets('@{sheetName}')/usedRange?$select=values",sheetsList:"me/drive/root/search(q='.xlsx')?select=name,id,webUrl"},name:"".concat(c.e," ").concat(c.b),oauth:{auth:c.f.AUTH,grant:c.f.GRANT,response_type:"code",version:2},scope_delim:" ",xhr:e=>{var t=e.query.access_token;return delete e.query.access_token,t&&(e.headers=Object.assign(Object.assign({},e.headers),{Authorization:"Bearer ".concat(t)})),!0}}},r={response_type:"code",oauth_proxy:u,redirect_uri:a.b.MICROSOFT.OAUTH_REDIRECT_URL};o.a.init(e,r),o.a.init(t);var n=window.at_debug;return n&&(o.a.on("auth",()=>{n.log("HelloJS on auth")}),o.a.on("auth.init",()=>{n.log("HelloJS on auth.init")}),o.a.on("auth.login",()=>{n.log("HelloJS on auth.login")}),o.a.on("auth.logout",()=>{n.log("HelloJS on auth.logout")}),o.a.on("auth.update",()=>{n.log("HelloJS on auth.update")})),o.a})(),d=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};class h{constructor(){this._login=e=>d(this,void 0,void 0,(function*(){return n(l(this.networkName).login(e))})),this._logout=()=>n(l(this.networkName).logout()),this._onLogin=e=>l.on("auth.login",e),this.api=e=>{if(!e)throw new Error("API name is missing");return n(l(this.networkName).api(e))},this.isTokenStillValid=e=>Boolean(e&&e.access_token&&e.expires>(new Date).getTime()/1e3)}get token(){var e;return null===(e=this.getSession())||void 0===e?void 0:e.access_token}hasValidSession(){var e=this.getSession();return!!this.isTokenStillValid(e)&&e}getSession(){return l(this.networkName).getAuthResponse()}}},58:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(97),i=r.n(n);function o(){var e=i.a.getParser(window.navigator.userAgent);return{safari:"safari"===e.getBrowserName(!0),chrome:"chrome"===e.getBrowserName(!0),firefox:"firefox"===e.getBrowserName(!0)}}},59:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(12),i=r(57),o=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};class a extends i.a{constructor(){super(...arguments),this.networkName=n.b,this.onLogin=e=>{this._onLogin(e)},this.logout=()=>this._logout()}login(e,t){return o(this,void 0,void 0,(function*(){var r=this.hasValidSession();if(r)return r;var i=void 0!==(null==e?void 0:e.authUser)?e.authUser:-1,o=i>-1||1==t?{display:"none",prompt:"none"}:{prompt:"consent"};void 0!==(null==e?void 0:e.immediate)&&delete e.immediate,e&&"number"==typeof i&&(delete e.authUser,-1!==i?e.authuser=i:this.getSession()&&(yield this.logout().catch(e=>{})));var a=Object.assign(Object.assign(Object.assign(Object.assign({},o),{scope:[...n.g,n.f],response_type:"code"}),e),{access_type:"offline"});return this._login(a).then(e=>{if(!e.authResponse)throw"Issue while login with Hello JS";return e.authResponse})}))}}},66:function(e,t,r){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r(68),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(15))},67:function(e,t,r){(function(e){!function(e){"use strict";var t,r=e.URLSearchParams&&e.URLSearchParams.prototype.get?e.URLSearchParams:null,n=r&&"a=1"===new r({a:1}).toString(),i=r&&"+"===new r("s=%2B").get("s"),o=!r||((t=new r).append("s"," &"),"s=+%26"===t.toString()),a=l.prototype,s=!(!e.Symbol||!e.Symbol.iterator);if(!(r&&n&&i&&o)){a.append=function(e,t){m(this.__URLSearchParams__,e,t)},a.delete=function(e){delete this.__URLSearchParams__[e]},a.get=function(e){var t=this.__URLSearchParams__;return this.has(e)?t[e][0]:null},a.getAll=function(e){var t=this.__URLSearchParams__;return this.has(e)?t[e].slice(0):[]},a.has=function(e){return _(this.__URLSearchParams__,e)},a.set=function(e,t){this.__URLSearchParams__[e]=[""+t]},a.toString=function(){var e,t,r,n,i=this.__URLSearchParams__,o=[];for(t in i)for(r=d(t),e=0,n=i[t];e<n.length;e++)o.push(r+"="+d(n[e]));return o.join("&")};var c=!!i&&r&&!n&&e.Proxy;Object.defineProperty(e,"URLSearchParams",{value:c?new Proxy(r,{construct:function(e,t){return new e(new l(t[0]).toString())}}):l});var u=e.URLSearchParams.prototype;u.polyfill=!0,u.forEach=u.forEach||function(e,t){var r=p(this.toString());Object.getOwnPropertyNames(r).forEach((function(n){r[n].forEach((function(r){e.call(t,r,n,this)}),this)}),this)},u.sort=u.sort||function(){var e,t,r,n=p(this.toString()),i=[];for(e in n)i.push(e);for(i.sort(),t=0;t<i.length;t++)this.delete(i[t]);for(t=0;t<i.length;t++){var o=i[t],a=n[o];for(r=0;r<a.length;r++)this.append(o,a[r])}},u.keys=u.keys||function(){var e=[];return this.forEach((function(t,r){e.push(r)})),f(e)},u.values=u.values||function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},u.entries=u.entries||function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),f(e)},s&&(u[e.Symbol.iterator]=u[e.Symbol.iterator]||u.entries)}function l(e){((e=e||"")instanceof URLSearchParams||e instanceof l)&&(e=e.toString()),this.__URLSearchParams__=p(e)}function d(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'\(\)~]|%20|%00/g,(function(e){return t[e]}))}function h(e){return e.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,(function(e){return decodeURIComponent(e)}))}function f(t){var r={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return s&&(r[e.Symbol.iterator]=function(){return r}),r}function p(e){var t={};if("object"==typeof e)if(g(e))for(var r=0;r<e.length;r++){var n=e[r];if(!g(n)||2!==n.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");m(t,n[0],n[1])}else for(var i in e)e.hasOwnProperty(i)&&m(t,i,e[i]);else{0===e.indexOf("?")&&(e=e.slice(1));for(var o=e.split("&"),a=0;a<o.length;a++){var s=o[a],c=s.indexOf("=");-1<c?m(t,h(s.slice(0,c)),h(s.slice(c+1))):s&&m(t,h(s),"")}}return t}function m(e,t,r){var n="string"==typeof r?r:null!=r&&"function"==typeof r.toString?r.toString():JSON.stringify(r);_(e,t)?e[t].push(n):e[t]=[n]}function g(e){return!!e&&"[object Array]"===Object.prototype.toString.call(e)}function _(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(void 0!==e?e:"undefined"!=typeof window?window:this)}).call(this,r(15))},68:function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var n,i,o,a,s,c=1,u={},l=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((o=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(e){o.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,n=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):n=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(a+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return u[c]=i,n(c),c++},h.clearImmediate=f}function f(e){delete u[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=u[e];if(t){l=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{f(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(15),r(10))},7:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a}));var n={REQUEST_TIMEOUT:"REQUEST_TIMEOUT",ACCESS_DENIED:"ACCESS_DENIED",LOADING_ERROR:"LOADING_ERROR",INVALID_QUERY:"INVALID_QUERY",INVALID_RANGE:"INVALID_RANGE",PERMISSION_DENIED:"PERMISSION_DENIED",NOT_MODIFIED:"NOT_MODIFIED",RESOURCE_EXHAUSTED:"RESOURCE_EXHAUSTED",VIEW_CANT_LOAD:"VIEW_CANT_LOAD"},i={ACCESS_DENIED:n.ACCESS_DENIED,LOADING_ERROR:n.LOADING_ERROR},o={INVALID_RANGE:n.INVALID_RANGE,INVALID_QUERY:n.INVALID_QUERY,REQUEST_TIMEOUT:n.REQUEST_TIMEOUT},a={RESOURCE_EXHAUSTED:n.RESOURCE_EXHAUSTED,REQUEST_TIMEOUT:n.REQUEST_TIMEOUT};t.d=n},9:function(e,t,r){"use strict";r.d(t,"f",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"e",(function(){return a})),r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return c}));var n="<style>",i="<script>",o="<global_html>",a="<simple_template></simple_template>",s="GeoChartOptions",c=/chartOptions\((.*)\)/},90:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return d}));var n=r(11),i=r(45),o=r(46),a=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},s="".concat(window.location.origin,"/ms_picker"),c="Issue with One Drive SDK",u=e=>t=>{e&&e(t)},l=(e,t)=>{var r,l,d={accountSwitchEnabled:!1,action:"query",clientId:n.a,multiSelect:!1,advanced:{redirectUri:s}},h=(r=e.success,l=e.error,e=>a(void 0,void 0,void 0,(function*(){if(!e.accessToken||!e.value.length)return l(new Error(c));var t=new i.b({session:{access_token:e.accessToken}}),n=yield Object(o.c)(e.value[0],t);if(!n)return l(new Error(c));var a=yield n.getViewEditWorkSheetInfo();return a||l(new Error("Error with file")),r(Object.assign(Object.assign({},a),{accessToken:e.accessToken}))})));t&&t.trueRender&&(h=((e,t)=>r=>r.value.length?r.value[0].folder?e({accessToken:r.accessToken,folder:{folderId:r.value[0].id,driveId:r.value[0].parentReference.driveId}}):e({accessToken:r.accessToken,file:r.value[0]}):t(new Error(c)))(e.success,e.error));var f=Object.assign(Object.assign(Object.assign({},d),e),{error:u(e.error),success:h});OneDrive.open(f)},d=()=>{localStorage.removeItem("odpickerv7cache")}},91:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return u})),r.d(t,"c",(function(){return l}));var n=r(58),i=r(59),o={};function a(e){return t=>{new Promise((t,r)=>{window.gapi||r(c.GAPI_NOT_LOADED),window.gapi.load(e,t)}).then(()=>{o[e]=Promise.resolve(window.gapi[e]),t(o[e])})}}var s={get client(){return o.client||new Promise(a("client"))},get auth(){return o.auth||new Promise(a("auth"))},load:function(e){return new Promise((t,r)=>{window.gapi||r(c.GAPI_NOT_LOADED),window.gapi.load(e,{callback:t})})}},c={GAPI_NOT_LOADED:"gapi not loaded"},u=function(e){return Object(n.a)().safari?(new i.a).login({login_hint:e.login_hint},!0).then(e=>{var{setToken:t}=gapi.client;return(null==e?void 0:e.access_token)&&t({access_token:e.access_token}),e}):s.auth.then(t=>new Promise(r=>new Promise((n,i)=>{var o=setTimeout(()=>r(),1e4);t.authorize(e,(function(e){clearTimeout(o),n(r(e))}))})))},l=function(e,t,r){var n={client_id:t,scope:Array.isArray(r)?r.join(" "):r};return n.immediate=!("immediate"in e)||e.immediate,"login_hint"in e?(n.authuser=-1,n.login_hint=e.login_hint):"authUser"in e&&(n.authuser=e.authUser,!1===n.immediate&&-1===n.authuser&&(delete n.immediate,n.prompt="select_account")),u(n).then(e=>{if(!e.access_token)throw e;return e})}},92:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r(31),i=r(57),o=r(11),a=r(45),s=r(90),c=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(t){o(t)}}function s(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};class u extends i.a{constructor(){super(),this.networkName=o.e,this.userInformation=()=>c(this,void 0,void 0,(function*(){try{return yield this.graph.userInfos()}catch(e){return null}})),this.onLogin=e=>{this._onLogin(e)},this._graph=null}getDriveId(){return this.api("driveId")}get graph(){return!this._graph&&this.token?(this._graph=new a.a({session:this.getSession()}),this._graph):this.hasValidSession()?(this._graph.bearerToken||this._graph.bearerToken===this.token||(delete this._graph,this._graph=new a.a({session:this.getSession()})),this._graph):null}login(e,t){var r=e?{display:"none",force:!0,prompt:"none"}:{},i=Object.assign(Object.assign(Object.assign({},r),{scope:n.b.MICROSOFT.OAUTH_SCOPE_EDIT}),t);return this._login(i)}logout(e){return c(this,void 0,void 0,(function*(){var e=yield this._logout();return delete this._graph,this._graph=null,Object(s.b)(),e}))}}t.b=u;new u},97:function(e,t,r){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(r),a=Math.max(i,o),s=0,c=e.map([t,r],(function(t){var r=a-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(n&&(s=a-Math.min(i,o)),a-=1;a>=s;){if(c[0][a]>c[1][a])return 1;if(c[0][a]===c[1][a]){if(a===s)return 0;a-=1}else if(c[0][a]<c[1][a])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var s=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){n[t]=e[t]}))};for(t=0,r=o.length;t<r;t+=1)s();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},o=r(18);function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=function(){function e(){}var t,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},t=e,(r=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&a(t,r),e}();t.default=s,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=c(r(92)),i=c(r(93)),o=c(r(94)),a=c(r(95)),s=c(r(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},o=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(i[t]=a,o+=1):"object"==typeof a&&(r[t]=a,n+=1)})),n>0){var a=Object.keys(r),c=s.default.find(a,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(r[c]);if(void 0!==u)return u}var l=s.default.find(a,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(r[l]);if(void 0!==d)return d}}if(o>0){var h=Object.keys(i),f=s.default.find(h,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(i[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=s.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(s.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},r=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},r=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},r=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=i.default.getMacOSVersionName(t),n={name:o.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:o.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:o.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=a,e.exports=t.default}})}});