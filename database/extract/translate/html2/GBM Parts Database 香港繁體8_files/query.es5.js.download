/*! For license information please see query.es5.js.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/min/",n(n.s=279)}({0:function(e,t,n){"use strict";var r;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l}));var i={SPREADSHEET:"spreadsheet",PROXY:"proxy",AODOCS:"aodocs",EXCEL:"ms_excel",_LEGACY:"legacy"},a=(o(r={"google.com":"google.com"},i.SPREADSHEET,"google.com"),o(r,i.PROXY,"google.com"),o(r,i.AODOCS,"google.com"),o(r,i.EXCEL,"microsoft.com"),o(r,i._LEGACY,"google.com"),r),s={TABLE:"Table",CARDS:"Cards",MAPS:"Maps",MAPS_WITH_TABLE:"MapsWithTable",GEOCHART:"Geochart",GANTT:"Gantt",BI:"BI",SLIDESHOW:"SlideShow",ORG_CHART:"OrgChart",_LEGACY:"legacy"},u={BOOLEAN:"BOOLEAN",ENUM:"ENUM",STRING:"STRING",NUMBER:"NUMBER",LIST:"LIST"},c={SPS_URL_NOT_VALID:"SPS_URL_NOT_VALID",BLACKLIST_IS_DISPLAYED:0},l={filtersChart:'{"d":"v","e":["filters","chart"]}',leftFiltersChart:'{"d":"h","e":["filters","chart"]}',chartFilters:'{"d":"v","e":["chart","filters"]}',mapFiltersTable:'{"d":"v","e":["map","filters","chart"]}',tableFiltersMap:'{"d":"v","e":["chart","filters","map"]}',filtersMapTable:'{"d":"v","e":["filters","map","chart"]}',filtersTableMap:'{"d":"v","e":["filters","chart","map"]}',leftFiltersMapTable:'{"d":"h","e":["filters",{"d":"v","e":["map","chart"]}]}',leftFiltersTableMap:'{"d":"h","e":["filters",{"d":"v","e":["chart","map"]}]}'}},1:function(e,t,n){"use strict";n.r(t),n.d(t,"CARDS_COLOR",(function(){return r})),n.d(t,"CARDS_CONTENT",(function(){return o})),n.d(t,"MAPS_LAT",(function(){return i})),n.d(t,"MAPS_LONG",(function(){return a})),n.d(t,"MAPS_TOOLTIP",(function(){return s})),n.d(t,"MAPS_MARKER",(function(){return u})),n.d(t,"TOOLTIP",(function(){return c})),n.d(t,"LATITUDE",(function(){return l})),n.d(t,"LONGITUDE",(function(){return f})),n.d(t,"GEOCHART_LOCATION",(function(){return d})),n.d(t,"GEOCHART_COLORS",(function(){return h})),n.d(t,"GEOCHART_MARKERS_SIZE",(function(){return p})),n.d(t,"GEOCHART_VALUE",(function(){return m})),n.d(t,"SLIDE_IMAGE",(function(){return g})),n.d(t,"SLIDE_LINK",(function(){return v})),n.d(t,"SLIDE_TITLE",(function(){return y})),n.d(t,"SLIDE_TEXT",(function(){return _})),n.d(t,"SLIDE_CONTENT",(function(){return b})),n.d(t,"BI_COUNT",(function(){return w})),n.d(t,"BI_TOP_RESULTS",(function(){return S})),n.d(t,"BI_WORD_CLOUD",(function(){return k})),n.d(t,"BI_COLUMN_CHART",(function(){return A})),n.d(t,"BI_AGGREGATE",(function(){return E})),n.d(t,"BI_BAR_CHART",(function(){return T})),n.d(t,"BI_LINE_CHART",(function(){return O})),n.d(t,"BI_AREA_CHART",(function(){return R})),n.d(t,"BI_HISTOGRAM",(function(){return I})),n.d(t,"BI_CANDLESTICK_CHART",(function(){return x})),n.d(t,"BI_PIE",(function(){return P})),n.d(t,"PIE_CHART",(function(){return C})),n.d(t,"DONUT_CHART",(function(){return D})),n.d(t,"DIMENSION_PIE_CHART",(function(){return N})),n.d(t,"DIMENSION_DONUT_CHART",(function(){return M})),n.d(t,"LINE_CHART",(function(){return j})),n.d(t,"SMOOTH_LINE_CHART",(function(){return L})),n.d(t,"COMBO_CHART",(function(){return U})),n.d(t,"BUBBLE_CHART",(function(){return F})),n.d(t,"COLUMN_CHART",(function(){return q})),n.d(t,"STACKED_COLUMN_CHART",(function(){return B})),n.d(t,"PERCENT_STACKED_COLUMN_CHART",(function(){return H})),n.d(t,"BAR_CHART",(function(){return G})),n.d(t,"STACKED_BAR_CHART",(function(){return V})),n.d(t,"PERCENT_STACKED_BAR_CHART",(function(){return W})),n.d(t,"AREA_CHART",(function(){return z})),n.d(t,"STACKED_AREA_CHART",(function(){return K})),n.d(t,"STEPPED_AREA_CHART",(function(){return Y})),n.d(t,"STACKED_STEPPED_AREA_CHART",(function(){return J})),n.d(t,"PERCENT_STACKED_AREA_CHART",(function(){return $})),n.d(t,"PERCENT_STACKED_STEPPED_AREA_CHART",(function(){return Q})),n.d(t,"SCATTER_CHART",(function(){return X})),n.d(t,"GANTT_GROUP",(function(){return Z})),n.d(t,"GANTT_LABEL",(function(){return ee})),n.d(t,"GANTT_TOOL_TIP",(function(){return te})),n.d(t,"GANTT_START_DATE",(function(){return ne})),n.d(t,"GANTT_END_DATE",(function(){return re})),n.d(t,"COLUMN_ROLE_HIDDEN",(function(){return oe})),n.d(t,"COLUMN_ROLE_SIDEBAR",(function(){return ie})),n.d(t,"DATA_CSV",(function(){return ae})),n.d(t,"TYPE_POPUP",(function(){return se})),n.d(t,"TYPE_HYPERLINK",(function(){return ue})),n.d(t,"TYPE_IMAGE",(function(){return ce})),n.d(t,"TYPE_ICON",(function(){return le})),n.d(t,"TYPE_RATING",(function(){return fe})),n.d(t,"TYPE_BUTTON",(function(){return de})),n.d(t,"TYPE_LIST",(function(){return he})),n.d(t,"TYPE_NUMBEREDLIST",(function(){return pe})),n.d(t,"TYPE_COLOR",(function(){return me})),n.d(t,"FILTER_NONE",(function(){return ge})),n.d(t,"FILTER_NUMBERRANGE",(function(){return ve})),n.d(t,"FILTER_DATE",(function(){return ye})),n.d(t,"FILTER_DATERANGE",(function(){return _e})),n.d(t,"FILTER_STRING",(function(){return be})),n.d(t,"FILTER_CATEGORY",(function(){return we})),n.d(t,"FILTER_CSV",(function(){return Se})),n.d(t,"FILTER_CSV_OR",(function(){return ke})),n.d(t,"FILTER_CSV_AND",(function(){return Ae})),n.d(t,"ORG_CHART_NAME",(function(){return Ee})),n.d(t,"ORG_CHART_REPORTS_TO",(function(){return Te})),n.d(t,"ORG_CHART_CARD_CONTENT",(function(){return Oe}));var r="cardscolor",o="cardscontent",i="mapslat",a="mapslong",s="mapstooltip",u="mapsmarker",c="tooltip",l="latitude",f="longitude",d="geochartlocation",h="geochartcolor",p="geochartmarkersize",m="geochartvalue",g="slideimage",v="slidelink",y="slidetitle",_="slidetext",b="slidecontent",w="bicount",S="bitopresults",k="biwordcloud",A="bicolumnchart",E="biaggregate",T="bibarchart",O="bilinechart",R="biareachart",I="histogram",x="waterfallchart",P="bipie",C="piechart",D="donutchart",N="3dpiechart",M="3ddonutchart",j="linechart",L="smoothlinechart",U="combochart",F="bubblechart",q="columnchart",B="stackedcolumnchart",H="100stackedcolumnchart",G="barchart",V="stackedbarchart",W="100stackedbarchart",z="areachart",K="stackedareachart",Y="steppedareachart",J="stackedsteppedareachart",$="100stackedareachart",Q="100stackedsteppedareachart",X="scatterchart",Z="ganttgroup",ee="ganttlabel",te="gantttooltip",ne="ganttstartdate",re="ganttenddate",oe="hidden",ie="sidebar",ae="csvdata",se="popuptype",ue="hyperlinktype",ce="imagetype",le="icontype",fe="ratingtype",de="buttontype",he="listtype",pe="numberedlisttype",me="colortype",ge="nofilter",ve="numberrangefilter",ye="datefilter",_e="daterangefilter",be="stringfilter",we="categoryfilter",Se={name:"csvfilter",regex:"csvfilter(?!or)(?!and)"},ke="csvfilteror",Ae="csvfilterand",Ee="orgchartname",Te="orgchartparent",Oe="cardscontent"},10:function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,f=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&h())}function h(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},11:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return g}));var r=n(2),o="Awesome Table Graph API",i="microsoftAzure",a="/redirect",s=r.b.ms_client_id,u={AUTH:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",GRANT:"https://login.microsoftonline.com/common/oauth2/v2.0/token"},c="https://graph.microsoft.com/v1.0/",l="user.read",f="offline_access",d="files.read.all",h=[l,f],p=[l,d,f],m=[l,d,"files.readwrite.all"],g={ADMIN_CONSENT:"admin_consent",CONSENT:"consent",LOGIN:"login",NONE:"none",SELECT_ACCOUNT:"select_account"}},12:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l}));var r=["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/spreadsheets","https://spreadsheets.google.com/feeds"],o=["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://spreadsheets.google.com/feeds"],i="offline_access",a="google";const s="56088344336-mes14nget7f5jb0pfmi0scngbb82l0qa.apps.googleusercontent.com",u="https://api.awesome-table.com",c="https://awesometable-billing.appspot.com",l="https://us-central1-awesome-table-server.cloudfunctions.net/loggerService"},14:function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(o){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},151:function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},152:function(e,t,n){"use strict";var r=n(20);function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(o(t)+"="+o(e))})))})),i=a.join("&")}if(i){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},153:function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},154:function(e,t,n){"use strict";(function(t){var r=n(20),o=n(260),i={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,u={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(s=n(155)),s),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){u.headers[e]=r.merge(i)})),e.exports=u}).call(this,n(10))},155:function(e,t,n){"use strict";var r=n(20),o=n(261),i=n(263),a=n(152),s=n(264),u=n(267),c=n(268),l=n(156);e.exports=function(e){return new Promise((function(t,n){var f=e.data,d=e.headers;r.isFormData(f)&&delete d["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var p=e.auth.username||"",m=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";d.Authorization="Basic "+btoa(p+":"+m)}var g=s(e.baseURL,e.url);if(h.open(e.method.toUpperCase(),a(g,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in h?u(h.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:r,config:e,request:h};o(t,n,i),h=null}},h.onabort=function(){h&&(n(l("Request aborted",e,"ECONNABORTED",h)),h=null)},h.onerror=function(){n(l("Network Error",e,null,h)),h=null},h.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var v=(e.withCredentials||c(g))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;v&&(d[e.xsrfHeaderName]=v)}if("setRequestHeader"in h&&r.forEach(d,(function(e,t){void 0===f&&"content-type"===t.toLowerCase()?delete d[t]:h.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),e.responseType)try{h.responseType=e.responseType}catch(y){if("json"!==e.responseType)throw y}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),n(e),h=null)})),f||(f=null),h.send(f)}))}},156:function(e,t,n){"use strict";var r=n(262);e.exports=function(e,t,n,o,i){var a=new Error(e);return r(a,t,n,o,i)}},157:function(e,t,n){"use strict";var r=n(20);e.exports=function(e,t){t=t||{};var n={},o=["url","method","data"],i=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function u(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function c(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=u(void 0,e[o])):n[o]=u(e[o],t[o])}r.forEach(o,(function(e){r.isUndefined(t[e])||(n[e]=u(void 0,t[e]))})),r.forEach(i,c),r.forEach(a,(function(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=u(void 0,e[o])):n[o]=u(void 0,t[o])})),r.forEach(s,(function(r){r in t?n[r]=u(e[r],t[r]):r in e&&(n[r]=u(void 0,e[r]))}));var l=o.concat(i).concat(a).concat(s),f=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===l.indexOf(e)}));return r.forEach(f,c),n}},158:function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},161:function(e,t,n){e.exports=n(255)},17:function(e,t,n){"use strict";var r=function(e,t){var n={},r=n.lib={},o=function(){},i=r.Base={extend:function(e){o.prototype=this;var t=new o;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=r.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new a.init(n,t)}}),s=n.enc={},u=s.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}};s.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var o=0;o<n;o+=3)for(var i=(t[o>>>2]>>>24-o%4*8&255)<<16|(t[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|t[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;4>a&&o+.75*a<n;a++)e.push(r.charAt(i>>>6*(3-a)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,n=this._map;(r=n.charAt(64))&&(-1!=(r=e.indexOf(r))&&(t=r));for(var r=[],o=0,i=0;i<t;i++)if(i%4){var a=n.indexOf(e.charAt(i-1))<<i%4*2,s=n.indexOf(e.charAt(i))>>>6-i%4*2;r[o>>>2]|=(a|s)<<24-o%4*8,o++}return WordArray.create(r,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};var c=s.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i);if(t=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,o=e.min(4*t,o),t){for(var u=0;u<t;u+=i)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=o}return new a.init(u,o)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=f.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}});var d=n.algo={};return n}(Math);!function(e){for(var t=r,n=(i=t.lib).WordArray,o=i.Hasher,i=t.algo,a=[],s=[],u=function(e){return 4294967296*(e-(0|e))|0},c=2,l=0;64>l;){var f;e:{f=c;for(var d=e.sqrt(f),h=2;h<=d;h++)if(!(f%h)){f=!1;break e}f=!0}f&&(8>l&&(a[l]=u(e.pow(c,.5))),s[l]=u(e.pow(c,1/3)),l++),c++}var p=[];i=i.SHA256=o.extend({_doReset:function(){this._hash=new n.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],u=n[4],c=n[5],l=n[6],f=n[7],d=0;64>d;d++){if(16>d)p[d]=0|e[t+d];else{var h=p[d-15],m=p[d-2];p[d]=((h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3)+p[d-7]+((m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10)+p[d-16]}h=f+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+s[d]+p[d],m=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&o^r&i^o&i),f=l,l=c,c=u,u=a+h|0,a=i,i=o,o=r,r=h+m|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(i),t.HmacSHA256=o._createHmacHelper(i)}(Math),t.a=r},18:function(e,t,n){"use strict";function r(e){for(var t="",n=0,r=0;r<6&&(0==(n=e%26)?(t="Z"+t,e=e/26-1):(t=String.fromCharCode(64+n)+t,e=(e-n)/26),!(e<=0));r++);return t}function o(e){return(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function i(e,t,n){n=n||"GET";var r=null,o={};t&&"body"in t&&(r="string"==typeof t.body?t.body:JSON.stringify(t.body),delete t.body),t&&"headers"in t&&(o=t.headers,delete t.headers);var i=[];for(var a in t)t.hasOwnProperty(a)&&i.push("".concat(a,"=").concat(t[a]));var s=i.join("&");return new Promise((function(t,i){var a=new XMLHttpRequest;for(var u in a.open(n,e+(s&&(-1!==e.indexOf("?")?"&":"?")+s||"")),o)a.setRequestHeader(u,o[u]);a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE)if(a.responseText){var e;try{e=JSON.parse(a.responseText)}catch(n){e=a.responseText}t(e)}else i()},a.send(r)}))}function a(e){return(e<10?"0":"")+e}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return a}))},2:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));const r={apiKey:"AIzaSyAPCgK_J99eBCsm0Ub6vnivt3_GVFcXqVM",probeApiKey:"AIzaSyBDId7dThnefJgka1uaGBdxSe-cjoCZyL0",drivePickerApiKey:"AIzaSyBuWzhHYV2jlP2IohuLqGnh8Re9qyHXIKA",rootDomain:"awesome-table",rootDomainComplete:"app.awesome-table.com",authDomain:"app.awesome-table.com",viewDomainComplete:"view-awesome-table.com",domainProtocol:"https://",gaPrefix:"",mapsApiConfig:{key:"AIzaSyBPUXgscOP1VyMgpZWPWR1xCHnKIn4_9fQ"},beamer:{segment:""},stripeJsApiConfig:{key:"pk_live_ZIRAXuX7OUAEM25pCyQmWmiJ"},links:{pricing:"https://awesome-table.com/pricing",termsOfService:"https://awesome-table.com/terms-of-service",privacyPolicy:"https://awesome-table.com/privacy-policy"},module:!1},o={ms_client_id:"82434634-75ef-43e7-ac03-f8b2ae09b5e7",ms_oauth_proxy_url:"https://us-central1-awesometable-dev.cloudfunctions.net/oauthproxy"};r.viewDomainHost=r.viewDomainComplete.split("/")[0],r.rootSite=r.domainProtocol+r.rootDomainComplete,r.viewSite=r.domainProtocol+r.viewDomainComplete,r.authDomain=r.authDomain||null,r.beamerProductID=r.beamer.productID||"AZasvKVc19194",r.beamerSegment=r.beamer.segment||"",r.drivePickerApiKey=r.drivePickerApiKey||{key:"AIzaSyBuWzhHYV2jlP2IohuLqGnh8Re9qyHXIKA"},r.mapsApiConfig=r.mapsApiConfig||{key:"AIzaSyBPUXgscOP1VyMgpZWPWR1xCHnKIn4_9fQ"},r.probeApiKey=r.probeApiKey||r.apiKey,r.stripeJsApiConfig=r.stripeJsApiConfig||{key:"pk_test_ZFTe1NKHFl6uLoWIka22IyYd"},r.links=r.links,t.a=r},20:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(151),i=Object.prototype.toString;function a(e){return"[object Array]"===i.call(e)}function s(e){return void 0===e}function u(e){return null!==e&&"object"===r(e)}function c(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===i.call(e)}function f(e,t){if(null!=e)if("object"!==r(e)&&(e=[e]),a(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:u,isPlainObject:c,isUndefined:s,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:l,isStream:function(e){return u(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:f,merge:function e(){var t={};function n(n,r){c(t[r])&&c(n)?t[r]=e(t[r],n):c(n)?t[r]=e({},n):a(n)?t[r]=n.slice():t[r]=n}for(var r=0,o=arguments.length;r<o;r++)f(arguments[r],n);return t},extend:function(e,t,n){return f(t,(function(t,r){e[r]=n&&"function"==typeof t?o(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},24:function(e,t,n){"use strict";var r=n(17),o=n(2);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a,s,u,c,l,f,d=!1;a=window,s=document,u="script",c="ga",d||(d=!0,a.GoogleAnalyticsObject=c,a.ga=a.ga||function(){(a.ga.q=a.ga.q||[]).push(arguments)},a.ga.l=1*new Date,l=s.createElement(u),f=s.getElementsByTagName(u)[0],l.async=1,l.src="https://www.google-analytics.com/analytics.js",f.parentNode.insertBefore(l,f));var h=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=n,ga("create",t,"auto",{name:this.name})}var t,n,a;return t=e,a=[{key:"getTemplateUsage",value:function(e){if(!e)return"none";var t=e.split("!");return 1===(t=t[t.length-1].split(":")).length||t[0]===t[1]?"basic":"advanced"}}],(n=[{key:"setUserId",value:function(e){ga(this.name+".set","userId",function(e){return r.a.SHA256(e).toString(r.a.enc.Base64)}(e))}},{key:"setCustomD",value:function(e){ga(this.name+".set",e)}},{key:"sendStats",value:function(e,t){e.action||e.category||(t=e,e=void 0),t=t||{},e&&e.category&&(t.eventCategory=e.category),e&&e.action&&(t.eventAction=e.action),t.hitType||(t.hitType="event"),t.eventLabel||(t.eventLabel=o.a.rootDomain),ga(this.name+".send",t)}},{key:"sendPageView",value:function(){if(this._lastLocation!==window.location.href){this._lastLocation=window.location.href;var e={hitType:"pageview",location:window.location.href,page:window.location.pathname.replace(/\/([^\/]+)\/(?:edit|settings|view|preview|print)/,(function(e,t){return e.replace(t,"$VIEWID")}))};ga(this.name+".send",e)}}},{key:"sendTiming",value:function(e,t){if(e.hitType="timing",t)for(var n in t)e[n]=t[n];ga(this.name+".send",e)}}])&&i(t.prototype,n),a&&i(t,a),e}();h.EVENT={creation:{category:"creation",action:"new"},edition:{category:"edition",action:"normal"},suppression:{category:"suppression",action:"normal"},clickRateApp:{category:"clickToast",action:"rateApp"},clickInstallApp:{category:"clickToast",action:"installApp"},showRateApp:{category:"showToast",action:"rateApp"},showInstallApp:{category:"showToast",action:"installApp"}},t.a=h},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r={GOOGLE:"google",MICROSOFT:"microsoft"},o=2592e6},255:function(e,t,n){"use strict";var r=n(20),o=n(151),i=n(256),a=n(157);function s(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var u=s(n(154));u.Axios=i,u.create=function(e){return s(a(u.defaults,e))},u.Cancel=n(158),u.CancelToken=n(269),u.isCancel=n(153),u.all=function(e){return Promise.all(e)},u.spread=n(270),u.isAxiosError=n(271),e.exports=u,e.exports.default=u},256:function(e,t,n){"use strict";var r=n(20),o=n(152),i=n(257),a=n(258),s=n(157);function u(e){this.defaults=e,this.interceptors={request:new i,response:new i}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},u.prototype.getUri=function(e){return e=s(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,n){return this.request(s(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,n,r){return this.request(s(r||{},{method:e,url:t,data:n}))}})),e.exports=u},257:function(e,t,n){"use strict";var r=n(20);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},258:function(e,t,n){"use strict";var r=n(20),o=n(259),i=n(153),a=n(154);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return s(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(s(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},259:function(e,t,n){"use strict";var r=n(20);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},26:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return o}));var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t||{},this.data={},this.data.dataTable=t.data&&t.data.dataTable||null,this.data.signature=t.data&&t.data.signature||null,this.settings={columns:t.settings&&t.settings.columns||{},signature:t.settings&&t.settings.signature||""},this.template={templates:t.template&&t.template.templates||[],signature:t.template&&t.template.signature||null,onlyDisplay:t.template&&t.template.onlyDisplay||null,noAutoAdd:!t.template||void 0===t.template.noAutoAdd||t.template.noAutoAdd}}var t,n,o;return t=e,(n=[{key:"hasData",get:function(){return this.data&&!!this.data.dataTable}},{key:"hasTemplate",get:function(){return this.template&&this.template.templates&&!!this.template.templates.length}}])&&r(t.prototype,n),o&&r(t,o),e}()},260:function(e,t,n){"use strict";var r=n(20);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},261:function(e,t,n){"use strict";var r=n(156);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},262:function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},263:function(e,t,n){"use strict";var r=n(20);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(o)&&s.push("path="+o),r.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},264:function(e,t,n){"use strict";var r=n(265),o=n(266);e.exports=function(e,t){return e&&!r(t)?o(e,t):t}},265:function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},266:function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},267:function(e,t,n){"use strict";var r=n(20),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,a={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(a[t]&&o.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},268:function(e,t,n){"use strict";var r=n(20);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},269:function(e,t,n){"use strict";var r=n(158);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},27:function(e,t,n){(function(e,r,o){var i;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.create||(Object.create=function(){function e(){}return function(t){if(1!=arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return e.prototype=t,new e}}()),Object.keys||(Object.keys=function(e,t,n){for(t in n=[],e)n.hasOwnProperty.call(e,t)&&n.push(t);return n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=arguments.length>=2?arguments[1]:void 0,o=0;o<n;o++)o in t&&e.call(r,t[o],o,t);return this}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var n=[];return this.forEach((function(r,o,i){e.call(t||void 0,r,o,i)&&n.push(r)})),n}),Array.prototype.map||(Array.prototype.map=function(e,t){var n=[];return this.forEach((function(r,o,i){n.push(e.call(t||void 0,r,o,i))})),n}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"object"!==("undefined"==typeof window?"undefined":a(window))||"object"!==a(window.location)||window.location.assign||(window.location.assign=function(e){window.location=e}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");function t(){}var n=[].slice,r=n.call(arguments,1),o=this,i=function(){return o.apply(this instanceof t?this:e||window,r.concat(n.call(arguments)))};return t.prototype=this.prototype,i.prototype=new t,i});var s=function e(t){return e.use(t)};(s.utils={extend:function(e){return Array.prototype.slice.call(arguments,1).forEach((function(t){if(Array.isArray(e)&&Array.isArray(t))Array.prototype.push.apply(e,t);else if(e&&(e instanceof Object||"object"===a(e))&&t&&(t instanceof Object||"object"===a(t))&&e!==t)for(var n in t)e[n]=s.utils.extend(e[n],t[n]);else Array.isArray(t)&&(t=t.slice(0)),e=t})),e}}).extend(s,{settings:{redirect_uri:window.location.href.split("#")[0],response_type:"token",display:"popup",state:"",oauth_proxy:"https://auth-server.herokuapp.com/proxy",timeout:2e4,popup:{resizable:1,scrollbars:1,width:500,height:550},scope:["basic"],scope_map:{basic:""},default_service:null,force:null,page_uri:window.location.href},services:{},use:function(e){var t=Object.create(this);return t.settings=Object.create(this.settings),e&&(t.settings.default_service=e),t.utils.Event.call(t),t},init:function(e,t){var n=this.utils;if(!e)return this.services;for(var r in e)e.hasOwnProperty(r)&&"object"!==a(e[r])&&(e[r]={id:e[r]});return n.extend(this.services,e),t&&(n.extend(this.settings,t),"redirect_uri"in t&&(this.settings.redirect_uri=n.url(t.redirect_uri).href)),this},login:function(){var e,t=this,n=t.utils,r=n.error,o=n.Promise(),i=n.args({network:"s",options:"o",callback:"f"},arguments),a=n.diffKey(i.options,t.settings),u=i.options=n.merge(t.settings,i.options||{});function c(e,t){s.emit(e,t)}if(u.popup=n.merge(t.settings.popup,i.options.popup||{}),i.network=i.network||t.settings.default_service,o.proxy.then(i.callback,i.callback),o.proxy.then(c.bind(this,"auth.login auth"),c.bind(this,"auth.failed auth")),"string"!=typeof i.network||!(i.network in t.services))return o.reject(r("invalid_network","The provided network was not recognized"));var l=t.services[i.network],f=n.globalEvent((function(e){e?"string"==typeof e&&(e=JSON.parse(e)):e=r("cancelled","The authentication was not completed"),e.error?o.reject(e):(n.store(e.network,e),o.fulfill({network:e.network,authResponse:e}))})),d=n.url(u.redirect_uri).href,h=l.oauth.response_type||u.response_type;/\bcode\b/.test(h)&&!l.oauth.grant&&(h=h.replace(/\bcode\b/,"token")),i.qs=n.merge(a,{client_id:encodeURIComponent(l.id),response_type:encodeURIComponent(h),redirect_uri:encodeURIComponent(d),state:{client_id:l.id,network:i.network,display:u.display,callback:f,state:u.state,redirect_uri:d}});var p=n.store(i.network),m=/[,\s]+/,g=t.settings.scope?[t.settings.scope.toString()]:[],v=n.merge(t.settings.scope_map,l.scope||{});if(u.scope&&g.push(u.scope.toString()),p&&"scope"in p&&p.scope instanceof String&&g.push(p.scope),g=g.join(",").split(m),g=n.unique(g).filter(S),i.qs.state.scope=g.join(","),g=(g=g.map((function(e){return e in v?v[e]:e}))).join(",").split(m),g=n.unique(g).filter(S),i.qs.scope=g.join(l.scope_delim||","),!1===u.force&&p&&"access_token"in p&&p.access_token&&"expires"in p&&p.expires>(new Date).getTime()/1e3){var y=n.diff((p.scope||"").split(m),(i.qs.state.scope||"").split(m));if(0===y.length)return o.fulfill({unchanged:!0,network:i.network,authResponse:p}),o}if("page"===u.display&&u.page_uri&&(i.qs.state.page_uri=n.url(u.page_uri).href),"login"in l&&"function"==typeof l.login&&l.login(i),(!/\btoken\b/.test(h)||parseInt(l.oauth.version,10)<2||"none"===u.display&&l.oauth.grant&&p&&p.refresh_token)&&(i.qs.state.oauth=l.oauth,i.qs.state.oauth_proxy=u.oauth_proxy),i.qs.state=encodeURIComponent(JSON.stringify(i.qs.state)),1===parseInt(l.oauth.version,10)?e=n.qs(u.oauth_proxy,i.qs,w):"none"===u.display&&l.oauth.grant&&p&&p.refresh_token?(i.qs.refresh_token=p.refresh_token,e=n.qs(u.oauth_proxy,i.qs,w)):e=n.qs(l.oauth.auth,i.qs,w),c("auth.init",i),"none"===u.display)n.iframe(e,d);else if("popup"===u.display)var _=n.popup(e,d,u.popup),b=setInterval((function(){if((!_||_.closed)&&(clearInterval(b),!o.state)){var e=r("cancelled","Login has been cancelled");_||(e=r("blocked","Popup was blocked")),e.network=i.network,o.reject(e)}}),100);else window.location=e;return o.proxy;function w(e){return e}function S(e){return!!e}},logout:function(){var e=this,t=e.utils,n=t.error,r=t.Promise(),o=t.args({name:"s",options:"o",callback:"f"},arguments);function i(e,t){s.emit(e,t)}if(o.options=o.options||{},r.proxy.then(o.callback,o.callback),r.proxy.then(i.bind(this,"auth.logout auth"),i.bind(this,"error")),o.name=o.name||this.settings.default_service,o.authResponse=t.store(o.name),o.name&&!(o.name in e.services))r.reject(n("invalid_network","The network was unrecognized"));else if(o.name&&o.authResponse){var a=function(e){t.store(o.name,null),r.fulfill(s.utils.merge({network:o.name},e||{}))},u={};if(o.options.force){var c=e.services[o.name].logout;if(c)if("function"==typeof c&&(c=c(a,o)),"string"==typeof c)t.iframe(c),u.force=null,u.message="Logout success on providers site was indeterminate";else if(void 0===c)return r.proxy}a(u)}else r.reject(n("invalid_session","There was no session to remove"));return r.proxy},getAuthResponse:function(e){return(e=e||this.settings.default_service)&&e in this.services&&this.utils.store(e)||null},events:{}}),s.utils.extend(s.utils,{error:function(e,t){return{error:{code:e,message:t}}},qs:function(e,t,n){if(t)for(var r in n=n||encodeURIComponent,t){var o=new RegExp("([\\?\\&])"+r+"=[^\\&]*");e.match(o)&&(e=e.replace(o,"$1"+r+"="+n(t[r])),delete t[r])}return this.isEmpty(t)?e:e+(e.indexOf("?")>-1?"&":"?")+this.param(t,n)},param:function(e,t){var n,r,o={};if("string"==typeof e){if(t=t||decodeURIComponent,r=e.replace(/^[\#\?]/,"").match(/([^=\/\&]+)=([^\&]+)/g))for(var i=0;i<r.length;i++)o[(n=r[i].match(/([^=]+)=(.*)/))[1]]=t(n[2]);return o}t=t||encodeURIComponent;var a=e;for(var s in o=[],a)a.hasOwnProperty(s)&&a.hasOwnProperty(s)&&o.push([s,"?"===a[s]?"?":t(a[s])].join("="));return o.join("&")},store:function(){for(var e,t=["localStorage","sessionStorage"],n=-1;t[++n];)try{(e=window[t[n]]).setItem("test"+n,n),e.removeItem("test"+n);break}catch(o){e=null}if(!e){var r=null;e={getItem:function(e){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].replace(/(^\s+|\s+$)/,"");if(o&&0===o.indexOf(e))return o.substr(e.length)}return r},setItem:function(e,t){r=t,document.cookie=e+"="+t}},r=e.getItem("hello")}return function(t,n,r){var i=function(){var t={};try{t=JSON.parse(e.getItem("hello"))||{}}catch(o){}return t}();if(t&&void 0===n)return i[t]||null;if(t&&null===n)try{delete i[t]}catch(o){i[t]=null}else{if(!t)return i;i[t]=n}return function(t){e.setItem("hello",JSON.stringify(t))}(i),i||null}}(),append:function(e,t,n){var r="string"==typeof e?document.createElement(e):e;if("object"===a(t))if("tagName"in t)n=t;else for(var o in t)if(t.hasOwnProperty(o))if("object"===a(t[o]))for(var i in t[o])t[o].hasOwnProperty(i)&&(r[o][i]=t[o][i]);else"html"===o?r.innerHTML=t[o]:/^on/.test(o)?r[o]=t[o]:r.setAttribute(o,t[o]);return"body"===n?function e(){document.body?document.body.appendChild(r):setTimeout(e,16)}():"object"===a(n)?n.appendChild(r):"string"==typeof n&&document.getElementsByTagName(n)[0].appendChild(r),r},iframe:function(e){this.append("iframe",{src:e,style:{position:"absolute",left:"-1000px",bottom:0,height:"1px",width:"1px"}},"body")},merge:function(){var e=Array.prototype.slice.call(arguments);return e.unshift({}),this.extend.apply(null,e)},args:function(e,t){var n={},r=0,o=null,i=null;for(i in e)if(e.hasOwnProperty(i))break;if(1===t.length&&"object"===a(t[0])&&"o!"!=e[i])for(i in t[0])if(e.hasOwnProperty(i)&&i in e)return t[0];for(i in e)if(e.hasOwnProperty(i))if(o=a(t[r]),"function"==typeof e[i]&&e[i].test(t[r])||"string"==typeof e[i]&&(e[i].indexOf("s")>-1&&"string"===o||e[i].indexOf("o")>-1&&"object"===o||e[i].indexOf("i")>-1&&"number"===o||e[i].indexOf("a")>-1&&"object"===o||e[i].indexOf("f")>-1&&"function"===o))n[i]=t[r++];else if("string"==typeof e[i]&&e[i].indexOf("!")>-1)return!1;return n},url:function(e){if(e){if(window.URL&&URL instanceof Function&&0!==URL.length)return new URL(e,window.location);var t=document.createElement("a");return t.href=e,t.cloneNode(!1)}return window.location},diff:function(e,t){return t.filter((function(t){return-1===e.indexOf(t)}))},diffKey:function(e,t){if(e||!t){var n={};for(var r in e)r in t||(n[r]=e[r]);return n}return e},unique:function(e){return Array.isArray(e)?e.filter((function(t,n){return e.indexOf(t)===n})):[]},isEmpty:function(e){if(!e)return!0;if(Array.isArray(e))return!e.length;if("object"===a(e))for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},Promise:function(){var t=function e(t){if(!(this instanceof e))return new e(t);this.id="Thenable/1.0.6",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},"function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this))};t.prototype={fulfill:function(e){return n(this,1,"fulfillValue",e)},reject:function(e){return n(this,2,"rejectReason",e)},then:function(e,n){var r=new t;return this.onFulfilled.push(s(e,r,"fulfill")),this.onRejected.push(s(n,r,"reject")),o(this),r.proxy}};var n=function(e,t,n,r){return 0===e.state&&(e.state=t,e[n]=r,o(e)),e},o=function(e){1===e.state?i(e,"onFulfilled",e.fulfillValue):2===e.state&&i(e,"onRejected",e.rejectReason)},i=function(t,n,o){if(0!==t[n].length){var i=t[n];t[n]=[];var s=function(){for(var e=0;e<i.length;e++)i[e](o)};"object"===(void 0===e?"undefined":a(e))&&"function"==typeof e.nextTick?e.nextTick(s):"function"==typeof r?r(s):setTimeout(s,0)}},s=function(e,t,n){return function(r){if("function"!=typeof e)t[n].call(t,r);else{var o;try{o=e(r)}catch(i){return void t.reject(i)}u(t,o)}}},u=function e(t,n){if(t!==n&&t.proxy!==n){var r;if("object"===a(n)&&null!==n||"function"==typeof n)try{r=n.then}catch(i){return void t.reject(i)}if("function"!=typeof r)t.fulfill(n);else{var o=!1;try{r.call(n,(function(r){o||(o=!0,r===n?t.reject(new TypeError("circular thenable chain")):e(t,r))}),(function(e){o||(o=!0,t.reject(e))}))}catch(i){o||t.reject(i)}}}else t.reject(new TypeError("cannot resolve promise with itself"))};return t}(),Event:function(){var e=/[\s\,]+/;return this.parent={events:this.events,findEvents:this.findEvents,parent:this.parent,utils:this.utils},this.events={},this.on=function(t,n){if(n&&"function"==typeof n)for(var r=t.split(e),o=0;o<r.length;o++)this.events[r[o]]=[n].concat(this.events[r[o]]||[]);return this},this.off=function(e,t){return this.findEvents(e,(function(e,n){t&&this.events[e][n]!==t||(this.events[e][n]=null)})),this},this.emit=function(e){var t=Array.prototype.slice.call(arguments,1);t.push(e);for(var n=function(n,r){t[t.length-1]="*"===n?e:n,this.events[n][r].apply(this,t)},r=this;r&&r.findEvents;)r.findEvents(e+",*",n),r=r.parent;return this},this.emitAfter=function(){var e=this,t=arguments;return setTimeout((function(){e.emit.apply(e,t)}),0),this},this.findEvents=function(t,n){var r=t.split(e);for(var o in this.events)if(this.events.hasOwnProperty(o)&&r.indexOf(o)>-1)for(var i=0;i<this.events[o].length;i++)this.events[o][i]&&n.call(this,o,i)},this},globalEvent:function(e,t){return t=t||"_hellojs_"+parseInt(1e12*Math.random(),10).toString(36),window[t]=function(){try{e.apply(this,arguments)&&delete window[t]}catch(n){}},t},popup:function(e,t,n){var r=document.documentElement;if(n.height&&void 0===n.top){var o=void 0!==window.screenTop?window.screenTop:screen.top,i=screen.height||window.innerHeight||r.clientHeight;n.top=parseInt((i-n.height)/2,10)+o}if(n.width&&void 0===n.left){var a=void 0!==window.screenLeft?window.screenLeft:screen.left,s=screen.width||window.innerWidth||r.clientWidth;n.left=parseInt((s-n.width)/2,10)+a}var u=[];Object.keys(n).forEach((function(e){var t=n[e];u.push(e+(null!==t?"="+t:""))})),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(e=t+"#oauth_redirect="+encodeURIComponent(encodeURIComponent(e)));var c=window.open(e,"_blank",u.join(","));return c&&c.focus&&c.focus(),c},responseHandler:function(e,t){var n,r=this,o=e.location;if((n=r.param(o.search))&&n.state&&(n.code||n.oauth_token)){var i=JSON.parse(n.state);n.redirect_uri=i.redirect_uri||o.href.replace(/[\?\#].*$/,"");var a=r.qs(i.oauth_proxy,n);o.assign(a)}else if((n=r.merge(r.param(o.search||""),r.param(o.hash||"")))&&"state"in n){try{var s=JSON.parse(n.state);r.extend(n,s)}catch(g){var u=decodeURIComponent(n.state);try{var c=JSON.parse(u);r.extend(n,c)}catch(g){}}if("access_token"in n&&n.access_token&&n.network)n.expires_in&&0!==parseInt(n.expires_in,10)||(n.expires_in=0),n.expires_in=parseInt(n.expires_in,10),n.expires=(new Date).getTime()/1e3+(n.expires_in||31536e3),h(n,e,t);else if("error"in n&&n.error&&n.network)n.error={code:n.error,message:n.error_message||n.error_description},h(n,e,t);else if(n.callback&&n.callback in t){var l=!(!("result"in n)||!n.result)&&JSON.parse(n.result);p(t,n.callback)(l),m()}n.page_uri&&d(n.page_uri)&&o.assign(n.page_uri)}else if("oauth_redirect"in n){var f=decodeURIComponent(n.oauth_redirect);return void(d(f)&&o.assign(f))}function d(e){return/^https?:/.test(e)}function h(e,t,n){var o=e.callback,i=e.network;if(r.store(i,e),!("display"in e)||"page"!==e.display){if(n&&o&&o in n){try{delete e.callback}catch(g){}r.store(i,e);var a=JSON.stringify(e);try{p(n,o)(a)}catch(g){}}m()}}function p(e,t){return 0!==t.indexOf("_hellojs_")?function(){throw"Could not execute callback "+t}:e[t]}function m(){if(e.frameElement)t.document.body.removeChild(e.frameElement);else{try{e.close()}catch(g){}e.addEventListener&&e.addEventListener("load",(function(){e.close()}))}}}}),s.utils.Event.call(s),function(e){var t={},n={};e.on("auth.login, auth.logout",(function(n){n&&"object"===a(n)&&n.network&&(t[n.network]=e.utils.store(n.network)||{})})),function r(){var o=(new Date).getTime()/1e3,i=function(t){e.emit("auth."+t,{network:a,authResponse:s})};for(var a in e.services)if(e.services.hasOwnProperty(a)){if(!e.services[a].id)continue;var s=e.utils.store(a)||{},u=e.services[a],c=t[a]||{};if(s&&"callback"in s){var l=s.callback;try{delete s.callback}catch(d){}e.utils.store(a,s);try{window[l](s)}catch(d){}}if(s&&"expires"in s&&s.expires<o){var f=u.refresh||s.refresh_token;f&&(!(a in n)||n[a]<o)?(e.emit("notice",a+" has expired trying to resignin"),e.login(a,{display:"none",force:!1}),n[a]=o+600):f||a in n||(i("expired"),n[a]=!0);continue}if(c.access_token===s.access_token&&c.expires===s.expires)continue;!s.access_token&&c.access_token?i("logout"):s.access_token&&!c.access_token?i("login"):s.expires!==c.expires&&i("update"),t[a]=s,a in n&&delete n[a]}setTimeout(r,1e3)}()}(s),s.api=function(){var e=this,t=e.utils,n=t.error,r=t.Promise(),o=t.args({path:"s!",query:"o",method:"s",data:"o",timeout:"i",callback:"f"},arguments);o.method=(o.method||"get").toLowerCase(),o.headers=o.headers||{},o.query=o.query||{},"get"!==o.method&&"delete"!==o.method||(t.extend(o.query,o.data),o.data={});var i=o.data=o.data||{};if(r.then(o.callback,o.callback),!o.path)return r.reject(n("invalid_path","Missing the path parameter from the request"));o.path=o.path.replace(/^\/+/,"");var s=(o.path.split(/[\/\:]/,2)||[])[0].toLowerCase();if(s in e.services){o.network=s;var u=new RegExp("^"+s+":?/?");o.path=o.path.replace(u,"")}o.network=e.settings.default_service=o.network||e.settings.default_service;var c=e.services[o.network];if(!c)return r.reject(n("invalid_network","Could not match the service requested: "+o.network));if(o.method in c&&o.path in c[o.method]&&!1===c[o.method][o.path])return r.reject(n("invalid_path","The provided path is not available on the selected network"));o.oauth_proxy||(o.oauth_proxy=e.settings.oauth_proxy),"proxy"in o||(o.proxy=o.oauth_proxy&&c.oauth&&1===parseInt(c.oauth.version,10)),"timeout"in o||(o.timeout=e.settings.timeout),"formatResponse"in o||(o.formatResponse=!0),o.authResponse=e.getAuthResponse(o.network),o.authResponse&&o.authResponse.access_token&&(o.query.access_token=o.authResponse.access_token);var l,f=o.path;o.options=t.clone(o.query),o.data=t.clone(i);var d=c[{delete:"del"}[o.method]||o.method]||{};if("get"===o.method){var h=f.split(/[\?#]/)[1];h&&(t.extend(o.query,t.param(h)),f=f.replace(/\?.*?(#|$)/,"$1"))}return(l=f.match(/#(.+)/,""))?(f=f.split("#")[0],o.path=l[1]):f in d?(o.path=f,f=d[f]):"default"in d&&(f=d.default),o.redirect_uri=e.settings.redirect_uri,o.xhr=c.xhr,o.jsonp=c.jsonp,o.form=c.form,"function"==typeof f?f(o,p):p(f),r.proxy;function p(e){(e=e.replace(/\@\{([a-z\_\-]+)(\|.*?)?\}/gi,(function(e,t,i){var a=i?i.replace(/^\|/,""):"";return t in o.query?(a=o.query[t],delete o.query[t]):o.data&&t in o.data?(a=o.data[t],delete o.data[t]):i||r.reject(n("missing_attribute","The attribute "+t+" is missing from the request")),a}))).match(/^https?:\/\//)||(e=c.base+e),o.url=e,t.request(o,(function(e,n){if(o.formatResponse){if(!0===e?e={success:!0}:e||(e={}),"delete"===o.method&&(e=!e||t.isEmpty(e)?{success:!0}:e),c.wrap&&(o.path in c.wrap||"default"in c.wrap)){var i=o.path in c.wrap?o.path:"default",s=((new Date).getTime(),c.wrap[i](e,n,o));s&&(e=s)}e&&"paging"in e&&e.paging.next&&("?"===e.paging.next[0]?e.paging.next=o.path+e.paging.next:e.paging.next+="#"+o.path),!e||"error"in e?r.reject(e):r.fulfill(e)}else("object"===a(n)?n.statusCode>=400:"object"===a(e)&&"error"in e)?r.reject(e):r.fulfill(e)}))}},s.utils.extend(s.utils,{request:function(e,t){var n=this,r=n.error;if(n.isEmpty(e.data)||"FileList"in window||!n.hasBinary(e.data)||(e.xhr=!1,e.jsonp=!1),this.request_cors((function(){return void 0===e.xhr||e.xhr&&("function"!=typeof e.xhr||e.xhr(e,e.query))})))a(e,(function(r){var o=n.xhr(e.method,r,e.headers,e.data,t);o.onprogress=e.onprogress||null,o.upload&&e.onuploadprogress&&(o.upload.onprogress=e.onuploadprogress)}));else{var o,i=e.query;if(e.query=n.clone(e.query),e.callbackID=n.globalEvent(),!1!==e.jsonp){if(e.query.callback=e.callbackID,"function"==typeof e.jsonp&&e.jsonp(e,e.query),"get"===e.method)return void a(e,(function(r){n.jsonp(r,t,e.callbackID,e.timeout)}));e.query=i}if(!1!==e.form&&(e.query.redirect_uri=e.redirect_uri,e.query.state=JSON.stringify({callback:e.callbackID}),"function"==typeof e.form&&(o=e.form(e,e.query)),"post"===e.method&&!1!==o))return void a(e,(function(r){n.post(r,e.data,o,t,e.callbackID,e.timeout)}));t(r("invalid_request","There was no mechanism for handling this request"))}function a(e,t){var r;e.authResponse&&e.authResponse.oauth&&1===parseInt(e.authResponse.oauth.version,10)&&(r=e.query.access_token,delete e.query.access_token,e.proxy=!0),!e.data||"get"!==e.method&&"delete"!==e.method||(n.extend(e.query,e.data),e.data=null);var o=n.qs(e.url,e.query);e.proxy&&(o=n.qs(e.oauth_proxy,{path:o,access_token:r||"",then:e.proxy_response_type||("get"===e.method.toLowerCase()?"redirect":"proxy"),method:e.method.toLowerCase(),suppress_response_codes:e.suppress_response_codes||!0})),t(o)}},request_cors:function(e){return"withCredentials"in new XMLHttpRequest&&e()},domInstance:function(e,t){var n="HTML"+(e||"").replace(/^[a-z]/,(function(e){return e.toUpperCase()}))+"Element";return!!t&&(window[n]?t instanceof window[n]:window.Element?t instanceof window.Element&&(!e||t.tagName&&t.tagName.toLowerCase()===e):!(t instanceof Object||t instanceof Array||t instanceof String||t instanceof Number)&&t.tagName&&t.tagName.toLowerCase()===e)},clone:function(e){if(null===e||"object"!==a(e)||e instanceof Date||"nodeName"in e||this.isBinary(e)||"function"==typeof FormData&&e instanceof FormData)return e;if(Array.isArray(e))return e.map(this.clone.bind(this));var t={};for(var n in e)t[n]=this.clone(e[n]);return t},xhr:function(e,t,n,r,o){var i,a=new XMLHttpRequest,s=this.error,u=!1;if("blob"===e&&(u=e,e="GET"),e=e.toUpperCase(),a.onload=function(t){var n=a.response;try{n=JSON.parse(a.responseText)}catch(i){401===a.status&&(n=s("access_denied",a.statusText))}var r=function(e){var t,n={},r=/([a-z\-]+):\s?(.*);?/gi;for(;t=r.exec(e);)n[t[1]]=t[2];return n}(a.getAllResponseHeaders());r.statusCode=a.status,o(n||("GET"===e?s("empty_response","Could not get resource"):{}),r)},a.onerror=function(e){var t=a.responseText;try{t=JSON.parse(a.responseText)}catch(n){}o(t||s("access_denied","Could not get resource"))},"GET"===e||"DELETE"===e)r=null;else if(r&&"string"!=typeof r&&!(r instanceof FormData)&&!(r instanceof File)&&!(r instanceof Blob)){var c=new FormData;for(i in r)r.hasOwnProperty(i)&&(r[i]instanceof HTMLInputElement?"files"in r[i]&&r[i].files.length>0&&c.append(i,r[i].files[0]):r[i]instanceof Blob?c.append(i,r[i],r.name):c.append(i,r[i]));r=c}if(a.open(e,t,!0),u&&("responseType"in a?a.responseType=u:a.overrideMimeType("text/plain; charset=x-user-defined")),n)for(i in n)a.setRequestHeader(i,n[i]);return a.send(r),a},jsonp:function(e,t,n,r){var o,i=this.error,a=0,s=document.getElementsByTagName("head")[0],u=i("server_error","server_error"),c=function(){a++||window.setTimeout((function(){t(u),s.removeChild(l)}),0)};n=this.globalEvent((function(e){return u=e,!0}),n),e=e.replace(new RegExp("=\\?(&|$)"),"="+n+"$1");var l=this.append("script",{id:n,name:n,src:e,async:!0,onload:c,onerror:c,onreadystatechange:function(){/loaded|complete/i.test(this.readyState)&&c()}});window.navigator.userAgent.toLowerCase().indexOf("opera")>-1&&(o=this.append("script",{text:"document.getElementById('"+n+"').onerror();"}),l.async=!1),r&&window.setTimeout((function(){u=i("timeout","timeout"),c()}),r),s.appendChild(l),o&&s.appendChild(o)},post:function(e,t,n,r,o,i){var a,s,u=this.error,c=document,l=null,f=[],d=0,h=null,p=0,m=function(e){p++||r(e)};this.globalEvent(m,o);try{s=c.createElement('<iframe name="'+o+'">')}catch(_){s=c.createElement("iframe")}if(s.name=o,s.id=o,s.style.display="none",n&&n.callbackonload&&(s.onload=function(){m({response:"posted",message:"Content was posted"})}),i&&setTimeout((function(){m(u("timeout","The post operation timed out"))}),i),c.body.appendChild(s),this.domInstance("form",t)){for(l=t.form,d=0;d<l.elements.length;d++)l.elements[d]!==t&&l.elements[d].setAttribute("disabled",!0);t=l}if(this.domInstance("form",t))for(l=t,d=0;d<l.elements.length;d++)l.elements[d].disabled||"file"!==l.elements[d].type||(l.encoding=l.enctype="multipart/form-data",l.elements[d].setAttribute("name","file"));else{for(h in t)t.hasOwnProperty(h)&&this.domInstance("input",t[h])&&"file"===t[h].type&&((l=t[h].form).encoding=l.enctype="multipart/form-data");var g;for(h in l||(l=c.createElement("form"),c.body.appendChild(l),a=l),t)if(t.hasOwnProperty(h)){var v=this.domInstance("input",t[h])||this.domInstance("textArea",t[h])||this.domInstance("select",t[h]);if(v&&t[h].form===l)v&&t[h].name!==h&&(t[h].setAttribute("name",h),t[h].name=h);else{var y=l.elements[h];if(g)for(y instanceof NodeList||(y=[y]),d=0;d<y.length;d++)y[d].parentNode.removeChild(y[d]);(g=c.createElement("input")).setAttribute("type","hidden"),g.setAttribute("name",h),v?g.value=t[h].value:this.domInstance(null,t[h])?g.value=t[h].innerHTML||t[h].innerText:g.value=t[h],l.appendChild(g)}}for(d=0;d<l.elements.length;d++)(g=l.elements[d]).name in t||!0===g.getAttribute("disabled")||(g.setAttribute("disabled",!0),f.push(g))}l.setAttribute("method","POST"),l.setAttribute("target",o),l.target=o,l.setAttribute("action",e),setTimeout((function(){l.submit(),setTimeout((function(){try{a&&a.parentNode.removeChild(a)}catch(_){}for(var e=0;e<f.length;e++)f[e]&&(f[e].setAttribute("disabled",!1),f[e].disabled=!1)}),0)}),100)},hasBinary:function(e){for(var t in e)if(e.hasOwnProperty(t)&&this.isBinary(e[t]))return!0;return!1},isBinary:function(e){return e instanceof Object&&(this.domInstance("input",e)&&"file"===e.type||"FileList"in window&&e instanceof window.FileList||"File"in window&&e instanceof window.File||"Blob"in window&&e instanceof window.Blob)},toBlob:function(e){var t=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i,n=e.match(t);if(!n)return e;for(var r=atob(e.replace(t,"")),o=[],i=0;i<r.length;i++)o.push(r.charCodeAt(i));return new Blob([new Uint8Array(o)],{type:n[1]})}}),function(e){var t=e.api,n=e.utils;n.extend(n,{dataToJSON:function(e){var t=window,n=e.data;if(this.domInstance("form",n)?n=this.nodeListToJSON(n.elements):"NodeList"in t&&n instanceof NodeList?n=this.nodeListToJSON(n):this.domInstance("input",n)&&(n=this.nodeListToJSON([n])),("File"in t&&n instanceof t.File||"Blob"in t&&n instanceof t.Blob||"FileList"in t&&n instanceof t.FileList)&&(n={file:n}),!("FormData"in t&&n instanceof t.FormData))for(var r in n)if(n.hasOwnProperty(r))if("FileList"in t&&n[r]instanceof t.FileList)1===n[r].length&&(n[r]=n[r][0]);else{if(this.domInstance("input",n[r])&&"file"===n[r].type)continue;this.domInstance("input",n[r])||this.domInstance("select",n[r])||this.domInstance("textArea",n[r])?n[r]=n[r].value:this.domInstance(null,n[r])&&(n[r]=n[r].innerHTML||n[r].innerText)}return e.data=n,n},nodeListToJSON:function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];!r.disabled&&r.name&&("file"===r.type?t[r.name]=r:t[r.name]=r.value||r.innerHTML)}return t}}),e.api=function(){var e=n.args({path:"s!",method:"s",data:"o",timeout:"i",callback:"f"},arguments);return e.data&&n.dataToJSON(e),t.call(this,e)}}(s),s.utils.responseHandler(window,window.opener||window.parent),"object"===("undefined"==typeof chrome?"undefined":a(chrome))&&"object"===a(chrome.identity)&&chrome.identity.launchWebAuthFlow&&function(){s.utils.popup=function(e){return t(e,!0)},s.utils.iframe=function(e){t(e,!1)},s.utils.request_cors=function(e){return e(),!0};var e={};function t(e,n){var r={closed:!1};return chrome.identity.launchWebAuthFlow({url:e,interactive:n},(function(e){if(void 0!==e){var n=s.utils.url(e),o={location:{assign:function(e){t(e,!1)},search:n.search,hash:n.hash,href:n.href},close:function(){}};s.utils.responseHandler(o,window)}else r.closed=!0})),r}chrome.storage.local.get("hello",(function(t){e=t.hello||{}})),s.utils.store=function(t,n){return 0===arguments.length?e:1===arguments.length?e[t]||null:n?(e[t]=n,chrome.storage.local.set({hello:e}),n):null===n?(delete e[t],chrome.storage.local.set({hello:e}),null):void 0}}(),function(){if(/^file:\/{3}[^\/]/.test(window.location.href)&&window.cordova){s.utils.iframe=function(e,t){s.utils.popup(e,t,{hidden:"yes"})};var e=s.utils.popup;s.utils.popup=function(t,n,r){var o=e.call(this,t,n,r);try{if(o&&o.addEventListener){var i=s.utils.url(n),a=i.origin||i.protocol+"//"+i.hostname;o.addEventListener("loadstart",(function(e){var t=e.url;if(0===t.indexOf(a)){var n=s.utils.url(t),r={location:{assign:function(e){o.executeScript({code:'window.location.href = "'+e+';"'})},search:n.search,hash:n.hash,href:n.href},close:function(){if(o.close){o.close();try{o.closed=!0}catch(e){}}}};s.utils.responseHandler(r,window)}}))}}catch(u){}return o}}}(),function(e){var t={version:"1.0",auth:"https://www.dropbox.com/1/oauth/authorize",request:"https://api.dropbox.com/1/oauth/request_token",token:"https://api.dropbox.com/1/oauth/access_token"},n={version:2,auth:"https://www.dropbox.com/1/oauth2/authorize",grant:"https://api.dropbox.com/1/oauth2/token"};function r(e){e&&"error"in e&&(e.error={code:"server_error",message:e.error.message||e.error})}function o(t,n,r){if(!("object"!==a(t)||"undefined"!=typeof Blob&&t instanceof Blob||"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"error"in t)){var o=("app_folder"!==t.root?t.root:"")+t.path.replace(/\&/g,"%26");o=o.replace(/^\//,""),t.thumb_exists&&(t.thumbnail=r.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/thumbnails/auto/"+o+"?format=jpeg&size=m")+"&access_token="+r.options.access_token),t.type=t.is_dir?"folder":t.mime_type,t.name=t.path.replace(/.*\//g,""),t.is_dir?t.files=o.replace(/^\//,""):(t.downloadLink=e.settings.oauth_proxy+"?path="+encodeURIComponent("https://api-content.dropbox.com/1/files/auto/"+o)+"&access_token="+r.options.access_token,t.file="https://api-content.dropbox.com/1/files/auto/"+o),t.id||(t.id=t.path.replace(/^\//,""))}}function i(e){return function(t,n){delete t.query.limit,n(e)}}e.init({dropbox:{name:"Dropbox",oauth:n,login:function(r){r.qs.scope="";var o=decodeURIComponent(r.qs.redirect_uri);0===o.indexOf("http:")&&0!==o.indexOf("http://localhost/")?e.services.dropbox.oauth=t:e.services.dropbox.oauth=n,r.options.popup.width=1e3,r.options.popup.height=1e3},base:"https://api.dropbox.com/1/",root:"sandbox",get:{me:"account/info","me/files":i("metadata/auto/@{parent|}"),"me/folder":i("metadata/auto/@{id}"),"me/folders":i("metadata/auto/"),default:function(e,t){e.path.match("https://api-content.dropbox.com/1/files/")&&(e.method="blob"),t(e.path)}},post:{"me/files":function(t,n){var r=t.data.parent,o=t.data.name;t.data={file:t.data.file},"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),n("https://api-content.dropbox.com/1/files_put/auto/"+r+"/"+o)},"me/folders":function(t,n){var r=t.data.name;t.data={},n("fileops/create_folder?root=@{root|sandbox}&"+e.utils.param({path:r}))}},del:{"me/files":"fileops/delete?root=@{root|sandbox}&path=@{id}","me/folder":"fileops/delete?root=@{root|sandbox}&path=@{id}"},wrap:{me:function(e){if(r(e),!e.uid)return e;e.name=e.display_name;var t=e.name.split(" ");return e.first_name=t.shift(),e.last_name=t.join(" "),e.id=e.uid,delete e.uid,delete e.display_name,e},default:function(e,t,n){return r(e),e.is_dir&&e.contents&&(e.data=e.contents,delete e.contents,e.data.forEach((function(r){r.root=e.root,o(r,t,n)}))),o(e,t,n),e.is_deleted&&(e.success=!0),e}},xhr:function(e){if(e.data&&e.data.file){var t=e.data.file;t&&(t.files?e.data=t.files[0]:e.data=t)}return"delete"===e.method&&(e.method="post"),!0},form:function(e,t){delete t.state,delete t.redirect_uri}}})}(s),function(e){e.init({facebook:{name:"Facebook",oauth:{version:2,auth:"https://www.facebook.com/v2.9/dialog/oauth/",grant:"https://graph.facebook.com/oauth/access_token"},scope:{basic:"public_profile",email:"email",share:"user_posts",birthday:"user_birthday",events:"user_events",photos:"user_photos",videos:"user_videos",friends:"user_friends",files:"user_photos,user_videos",publish_files:"user_photos,user_videos,publish_actions",publish:"publish_actions",offline_access:""},refresh:!1,login:function(e){e.options.force&&(e.qs.auth_type="reauthenticate"),e.qs.display=e.options.display||"popup"},logout:function(t,n){var r=e.utils.globalEvent(t),o=encodeURIComponent(e.settings.redirect_uri+"?"+e.utils.param({callback:r,result:JSON.stringify({force:!0}),state:"{}"})),i=(n.authResponse||{}).access_token;if(e.utils.iframe("https://www.facebook.com/logout.php?next="+o+"&access_token="+i),!i)return!1},base:"https://graph.facebook.com/v2.9/",get:{me:"me?fields=email,first_name,last_name,name,timezone,verified","me/friends":"me/friends","me/following":"me/friends","me/followers":"me/friends","me/share":"me/feed","me/like":"me/likes","me/files":"me/albums","me/albums":"me/albums?fields=cover_photo,name","me/album":"@{id}/photos?fields=picture","me/photos":"me/photos","me/photo":"@{id}","friend/albums":"@{id}/albums","friend/photos":"@{id}/photos"},post:{"me/share":"me/feed","me/photo":"@{id}"},wrap:{me:n,"me/friends":r,"me/following":r,"me/followers":r,"me/albums":o,"me/photos":o,"me/files":o,default:o},xhr:function(t,n){return"get"!==t.method&&"post"!==t.method||(n.suppress_response_codes=!0),"post"===t.method&&t.data&&"string"==typeof t.data.file&&(t.data.file=e.utils.toBlob(t.data.file)),!0},jsonp:function(t,n){var r=t.method;"get"===r||e.utils.hasBinary(t.data)?"delete"===t.method&&(n.method="delete",t.method="post"):(t.data.method=r,t.method="get")},form:function(e){return{callbackonload:!0}}}});var t="https://graph.facebook.com/";function n(e){return e.id&&(e.thumbnail=e.picture="https://graph.facebook.com/"+e.id+"/picture"),e}function r(e){return"data"in e&&e.data.forEach(n),e}function o(e,n,r){if("boolean"==typeof e&&(e={success:e}),e&&"data"in e){var o=r.query.access_token;if(!(e.data instanceof Array)){var i=e.data;delete e.data,e.data=[i]}e.data.forEach((function(e){e.picture&&(e.thumbnail=e.picture),e.pictures=(e.images||[]).sort((function(e,t){return e.width-t.width})),e.cover_photo&&e.cover_photo.id&&(e.thumbnail=t+e.cover_photo.id+"/picture?access_token="+o),"album"===e.type&&(e.files=e.photos=t+e.id+"/photos"),e.can_upload&&(e.upload_location=t+e.id+"/photos")}))}return e}}(s),function(e){function t(t,n,r){var o=(r?"":"flickr:")+"?method="+t+"&api_key="+e.services.flickr.id+"&format=json";for(var i in n)n.hasOwnProperty(i)&&(o+="&"+i+"="+n[i]);return o}function n(n,r){return r||(r={}),function(o,i){var a,s;a=function(e){r.user_id=e,i(t(n,r,!0))},s=e.getAuthResponse("flickr"),a(s&&s.user_nsid?s.user_nsid:null)}}function r(e,t){var n="https://www.flickr.com/images/buddyicon.gif";return e.nsid&&e.iconserver&&e.iconfarm&&(n="https://farm"+e.iconfarm+".staticflickr.com/"+e.iconserver+"/buddyicons/"+e.nsid+(t?"_"+t:"")+".jpg"),n}function o(e,t,n,r,o){return"https://farm"+t+".staticflickr.com/"+n+"/"+e+"_"+r+(o=o?"_"+o:"")+".jpg"}function i(e){e&&e.stat&&"ok"!=e.stat.toLowerCase()&&(e.error={code:"invalid_request",message:e.message})}function a(e){if(e.photoset||e.photos){l(e=u(e,"photoset"in e?"photoset":"photos")),e.data=e.photo,delete e.photo;for(var t=0;t<e.data.length;t++){var n=e.data[t];n.name=n.title,n.picture=o(n.id,n.farm,n.server,n.secret,""),n.pictures=s(n.id,n.farm,n.server,n.secret),n.source=o(n.id,n.farm,n.server,n.secret,"b"),n.thumbnail=o(n.id,n.farm,n.server,n.secret,"m")}}return e}function s(e,t,n,r){return[{id:"t",max:100},{id:"m",max:240},{id:"n",max:320},{id:"",max:500},{id:"z",max:640},{id:"c",max:800},{id:"b",max:1024},{id:"h",max:1600},{id:"k",max:2048},{id:"o",max:2048}].map((function(i){return{source:o(e,t,n,r,i.id),width:i.max,height:i.max}}))}function u(e,t){return t in e?e=e[t]:"error"in e||(e.error={code:"invalid_request",message:e.message||"Failed to get data from Flickr"}),e}function c(e){if(i(e),e.contacts){l(e=u(e,"contacts")),e.data=e.contact,delete e.contact;for(var t=0;t<e.data.length;t++){var n=e.data[t];n.id=n.nsid,n.name=n.realname||n.username,n.thumbnail=r(n,"m")}}return e}function l(e){e.page&&e.pages&&e.page!==e.pages&&(e.paging={next:"?page="+ ++e.page})}e.init({flickr:{name:"Flickr",oauth:{version:"1.0a",auth:"https://www.flickr.com/services/oauth/authorize?perms=read",request:"https://www.flickr.com/services/oauth/request_token",token:"https://www.flickr.com/services/oauth/access_token"},base:"https://api.flickr.com/services/rest",get:{me:n("flickr.people.getInfo"),"me/friends":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/following":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/followers":n("flickr.contacts.getList",{per_page:"@{limit|50}"}),"me/albums":n("flickr.photosets.getList",{per_page:"@{limit|50}"}),"me/album":n("flickr.photosets.getPhotos",{photoset_id:"@{id}"}),"me/photos":n("flickr.people.getPhotos",{per_page:"@{limit|50}"})},wrap:{me:function(e){if(i(e),(e=u(e,"person")).id){if(e.realname){e.name=e.realname._content;var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=r(e,"l"),e.picture=r(e,"l")}return e},"me/friends":c,"me/followers":c,"me/following":c,"me/albums":function(e){return i(e),l(e=u(e,"photosets")),e.photoset&&(e.data=e.photoset,e.data.forEach((function(e){e.name=e.title._content,e.photos="https://api.flickr.com/services/rest"+t("flickr.photosets.getPhotos",{photoset_id:e.id},!0)})),delete e.photoset),e},"me/photos":function(e){return i(e),a(e)},default:function(e){return i(e),a(e)}},xhr:!1,jsonp:function(e,t){"get"==e.method&&(delete t.callback,t.jsoncallback=e.callbackID)}}})}(s),function(e){function t(e){!e.meta||400!==e.meta.code&&401!==e.meta.code||(e.error={code:"access_denied",message:e.meta.errorDetail})}function n(e){e&&e.id&&(e.thumbnail=e.photo.prefix+"100x100"+e.photo.suffix,e.name=e.firstName+" "+e.lastName,e.first_name=e.firstName,e.last_name=e.lastName,e.contact&&e.contact.email&&(e.email=e.contact.email))}function r(e,t){var n=t.access_token;return delete t.access_token,t.oauth_token=n,t.v=20121125,!0}e.init({foursquare:{name:"Foursquare",oauth:{version:2,auth:"https://foursquare.com/oauth2/authenticate",grant:"https://foursquare.com/oauth2/access_token"},refresh:!0,base:"https://api.foursquare.com/v2/",get:{me:"users/self","me/friends":"users/self/friends","me/followers":"users/self/friends","me/following":"users/self/friends"},wrap:{me:function(e){return t(e),e&&e.response&&n(e=e.response.user),e},default:function(e){return t(e),e&&"response"in e&&"friends"in e.response&&"items"in e.response.friends&&(e.data=e.response.friends.items,e.data.forEach(n),delete e.response),e}},xhr:r,jsonp:r}})}(s),function(e){function t(e,t){var n=t?t.statusCode:e&&"meta"in e&&"status"in e.meta&&e.meta.status;401!==n&&403!==n||(e.error={code:"access_denied",message:e.message||(e.data?e.data.message:"Could not get response")},delete e.message)}function n(e){e.id&&(e.thumbnail=e.picture=e.avatar_url,e.name=e.login)}e.init({github:{name:"GitHub",oauth:{version:2,auth:"https://github.com/login/oauth/authorize",grant:"https://github.com/login/oauth/access_token",response_type:"code"},scope:{email:"user:email"},base:"https://api.github.com/",get:{me:"user","me/friends":"user/following?per_page=@{limit|100}","me/following":"user/following?per_page=@{limit|100}","me/followers":"user/followers?per_page=@{limit|100}","me/like":"user/starred?per_page=@{limit|100}"},wrap:{me:function(e,r){return t(e,r),n(e),e},default:function(e,r,o){return t(e,r),Array.isArray(e)&&(e={data:e}),e.data&&(!function(e,t,n){if(e.data&&e.data.length&&t&&t.Link){var r=t.Link.match(/<(.*?)>;\s*rel=\"next\"/);r&&(e.paging={next:r[1]})}}(e,r),e.data.forEach(n)),e}},xhr:function(e){return"get"!==e.method&&e.data&&(e.headers=e.headers||{},e.headers["Content-Type"]="application/json","object"===a(e.data)&&(e.data=JSON.stringify(e.data))),!0}}})}(s),function(e){var t="https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}";function n(e){return parseInt(e,10)}function r(e){return f(e),e.data=e.items,delete e.items,e}function o(e){if(!e.error)return e.name||(e.name=e.title||e.message),e.picture||(e.picture=e.thumbnailLink),e.thumbnail||(e.thumbnail=e.thumbnailLink),"application/vnd.google-apps.folder"===e.mimeType&&(e.type="folder",e.files="https://www.googleapis.com/drive/v2/files?q=%22"+e.id+"%22+in+parents"),e}function i(e){return{source:e.url,width:e.width,height:e.height}}function s(e){if(f(e),"feed"in e&&"entry"in e.feed)e.data=e.feed.entry.map(l),delete e.feed;else{if("entry"in e)return l(e.entry);"items"in e?(e.data=e.items.map(o),delete e.items):o(e)}return e}function u(e){e.name=e.displayName||e.name,e.picture=e.picture||(e.image?e.image.url:null),e.thumbnail=e.picture}function c(e,t,n){f(e);if("feed"in e&&"entry"in e.feed){for(var r=n.query.access_token,o=0;o<e.feed.entry.length;o++){var i=e.feed.entry[o];if(i.id=i.id.$t,i.name=i.title.$t,delete i.title,i.gd$email&&(i.email=i.gd$email&&i.gd$email.length>0?i.gd$email[0].address:null,i.emails=i.gd$email,delete i.gd$email),i.updated&&(i.updated=i.updated.$t),i.link){var a=i.link.length>0?i.link[0].href:null;a&&i.link[0].gd$etag&&(a+=(a.indexOf("?")>-1?"&":"?")+"access_token="+r,i.picture=a,i.thumbnail=a),delete i.link}i.category&&delete i.category}e.data=e.feed.entry,delete e.feed}return e}function l(e){var t,n=e.media$group,r=n.media$content.length?n.media$content[0]:{},o=n.media$content||[],a=n.media$thumbnail||[],s=o.concat(a).map(i).sort((function(e,t){return e.width-t.width})),u=0,c={id:e.id.$t,name:e.title.$t,description:e.summary.$t,updated_time:e.updated.$t,created_time:e.published.$t,picture:r?r.url:null,pictures:s,images:[],thumbnail:r?r.url:null,width:r.width,height:r.height};if("link"in e)for(u=0;u<e.link.length;u++){var l=e.link[u];if(l.rel.match(/\#feed$/)){c.upload_location=c.files=c.photos=l.href;break}}if("category"in e&&e.category.length)for(t=e.category,u=0;u<t.length;u++)t[u].scheme&&t[u].scheme.match(/\#kind$/)&&(c.type=t[u].term.replace(/^.*?\#/,""));return"media$thumbnail"in n&&n.media$thumbnail.length&&(t=n.media$thumbnail,c.thumbnail=t[0].url,c.images=t.map(i)),(t=n.media$content)&&t.length&&c.images.push(i(t[0])),c}function f(e){if("feed"in e&&e.feed.openSearch$itemsPerPage){var t=n(e.feed.openSearch$itemsPerPage.$t),r=n(e.feed.openSearch$startIndex.$t);r+t<n(e.feed.openSearch$totalResults.$t)&&(e.paging={next:"?start="+(r+t)})}else"nextPageToken"in e&&(e.paging={next:"?pageToken="+e.nextPageToken})}function d(){var e=[],t=(1e10*Math.random()).toString(32),n=0,r="\r\n--"+t,o=function(){},i=/^data\:([^;,]+(\;charset=[^;,]+)?)(\;base64)?,/i;function a(e){var t=new FileReader;t.onload=function(t){s(btoa(t.target.result),e.type+"\r\nContent-Transfer-Encoding: base64")},t.readAsBinaryString(e)}function s(t,r){e.push("\r\nContent-Type: "+r+"\r\n\r\n"+t),n--,o()}this.append=function(e,t){"string"!=typeof e&&"length"in Object(e)||(e=[e]);for(var r=0;r<e.length;r++){n++;var o=e[r];if("undefined"!=typeof File&&o instanceof File||"undefined"!=typeof Blob&&o instanceof Blob)a(o);else if("string"==typeof o&&o.match(i)){var u=o.match(i);s(o.replace(i,""),u[1]+"\r\nContent-Transfer-Encoding: base64")}else s(o,t)}},this.onready=function(i){(o=function(){0===n&&(e.unshift(""),e.push("--"),i(e.join(r),t),e=[])})()}}function h(e,t){var n,r={};if(e.data&&"undefined"!=typeof HTMLInputElement&&e.data instanceof HTMLInputElement&&(e.data={file:e.data}),!e.data.name&&Object(Object(e.data.file).files).length&&"post"===e.method&&(e.data.name=e.data.file.files[0].name),"post"===e.method?e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],file:e.data.file}:(r=e.data,e.data={},r.parent&&(e.data.parents=[{id:e.data.parent||"root"}]),r.file&&(e.data.file=r.file),r.name&&(e.data.title=r.name)),!("file"in e.data)||(n=e.data.file,delete e.data.file,"object"===a(n)&&"files"in n&&(n=n.files),n&&n.length)){var o=new d;o.append(JSON.stringify(e.data),"application/json"),n&&o.append(n),o.onready((function(n,o){e.headers["content-type"]='multipart/related; boundary="'+o+'"',e.data=n,t("upload/drive/v2/files"+(r.id?"/"+r.id:"")+"?uploadType=multipart")}))}else t({error:{code:"request_invalid",message:"There were no files attached with this request to upload"}})}e.init({google:{name:"Google Sign-In",oauth:{version:2,auth:"https://accounts.google.com/o/oauth2/v2/auth",grant:"https://www.googleapis.com/oauth2/v4/token"},scope:{basic:"openid profile",email:"email",birthday:"",events:"",photos:"https://picasaweb.google.com/data/",videos:"http://gdata.youtube.com",files:"https://www.googleapis.com/auth/drive.readonly",publish:"",publish_files:"https://www.googleapis.com/auth/drive",share:"",create_event:"",offline_access:""},scope_delim:" ",login:function(e){"code"===e.qs.response_type?e.qs.access_type="offline":e.qs.response_type.indexOf("id_token")>-1&&(e.qs.nonce=parseInt(1e12*Math.random(),10).toString(36)),e.options.force&&(e.qs.approval_prompt="force")},base:"https://www.googleapis.com/",get:{me:"oauth2/v3/userinfo?alt=json","me/following":t,"me/followers":t,"me/contacts":t,"me/albums":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}","me/album":function(e,t){var n=e.query.id;delete e.query.id,t(n.replace("/entry/","/feed/"))},"me/photos":"https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}","me/file":"drive/v2/files/@{id}","me/files":"drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}","me/folders":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}","me/folder":"drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}"},post:{"me/files":h,"me/folders":function(e,t){e.data={title:e.data.name,parents:[{id:e.data.parent||"root"}],mimeType:"application/vnd.google-apps.folder"},t("drive/v2/files")}},put:{"me/files":h},del:{"me/files":"drive/v2/files/@{id}","me/folder":"drive/v2/files/@{id}"},patch:{"me/file":"drive/v2/files/@{id}"},wrap:{me:function(e){return e.sub&&(e.id=e.sub),e.id&&(e.last_name=e.family_name||(e.name?e.name.familyName:null),e.first_name=e.given_name||(e.name?e.name.givenName:null),e.emails&&e.emails.length&&(e.email=e.emails[0].value),u(e)),e},"me/friends":function(e){return e.items&&(f(e),e.data=e.items,e.data.forEach(u),delete e.items),e},"me/contacts":c,"me/followers":c,"me/following":c,"me/share":r,"me/feed":r,"me/albums":s,"me/photos":function(e){"feed"in e&&(e.data="entry"in e.feed?e.feed.entry.map(l):[],delete e.feed);return e},default:s},xhr:function(t){return"post"===t.method||"put"===t.method?function(e){if("object"===a(e.data))try{e.data=JSON.stringify(e.data),e.headers["content-type"]="application/json"}catch(t){}}(t):"patch"===t.method&&(e.utils.extend(t.query,t.data),t.data=null),!0},form:!1}})}(s),function(e){function t(e){return"string"==typeof e?{error:{code:"invalid_request",message:e}}:(e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message}),e)}function n(e){return o(e),e&&"data"in e&&e.data.forEach(r),e}function r(e){e.id&&(e.thumbnail=e.profile_picture,e.name=e.full_name||e.username)}function o(e){"pagination"in e&&(e.paging={next:e.pagination.next_url},delete e.pagination)}e.init({instagram:{name:"Instagram",oauth:{version:2,auth:"https://instagram.com/oauth/authorize/",grant:"https://api.instagram.com/oauth/access_token"},refresh:!0,scope:{basic:"basic",photos:"",friends:"relationships",publish:"likes comments",email:"",share:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.instagram.com/v1/",get:{me:"users/self","me/feed":"users/self/feed?count=@{limit|100}","me/photos":"users/self/media/recent?min_id=0&count=@{limit|100}","me/friends":"users/self/follows?count=@{limit|100}","me/following":"users/self/follows?count=@{limit|100}","me/followers":"users/self/followed-by?count=@{limit|100}","friend/photos":"users/@{id}/media/recent?min_id=0&count=@{limit|100}"},post:{"me/like":function(e,t){var n=e.data.id;e.data={},t("media/"+n+"/likes")}},del:{"me/like":"media/@{id}/likes"},wrap:{me:function(e){return t(e),"data"in e&&(e.id=e.data.id,e.thumbnail=e.data.profile_picture,e.name=e.data.full_name||e.data.username),e},"me/friends":n,"me/following":n,"me/followers":n,"me/photos":function(e){return t(e),o(e),"data"in e&&(e.data=e.data.filter((function(e){return"image"===e.type})),e.data.forEach((function(e){e.name=e.caption?e.caption.text:null,e.thumbnail=e.images.thumbnail.url,e.picture=e.images.standard_resolution.url,e.pictures=Object.keys(e.images).map((function(t){return function(e){return{source:e.url,width:e.width,height:e.height}}(e.images[t])})).sort((function(e,t){return e.width-t.width}))}))),e},default:function(e){return o(e=t(e)),e}},xhr:function(e,t){var n=e.method,r="get"!==n;return r&&("post"!==n&&"put"!==n||!e.query.access_token||(e.data.access_token=e.query.access_token,delete e.query.access_token),e.proxy=r),r},form:!1}})}(s),function(e){function t(e,t){var n,r;return e&&"Message"in e&&(r=e.Message,delete e.Message,"ErrorCode"in e?(n=e.ErrorCode,delete e.ErrorCode):n=function(e){switch(e.statusCode){case 400:return"invalid_request";case 403:return"stale_token";case 401:return"invalid_token";case 500:default:return"server_error"}}(t),e.error={code:n,message:r,details:e}),e}e.init({joinme:{name:"join.me",oauth:{version:2,auth:"https://secure.join.me/api/public/v1/auth/oauth2",grant:"https://secure.join.me/api/public/v1/auth/oauth2"},refresh:!1,scope:{basic:"user_info",user:"user_info",scheduler:"scheduler",start:"start_meeting",email:"",friends:"",share:"",publish:"",photos:"",publish_files:"",files:"",videos:"",offline_access:""},scope_delim:" ",login:function(e){e.options.popup.width=400,e.options.popup.height=700},base:"https://api.join.me/v1/",get:{me:"user",meetings:"meetings","meetings/info":"meetings/@{id}"},post:{"meetings/start/adhoc":function(e,t){t("meetings/start")},"meetings/start/scheduled":function(e,t){var n=e.data.meetingId;e.data={},t("meetings/"+n+"/start")},"meetings/schedule":function(e,t){t("meetings")}},patch:{"meetings/update":function(e,t){t("meetings/"+e.data.meetingId)}},del:{"meetings/delete":"meetings/@{id}"},wrap:{me:function(e,n){return t(e,n),e.email?(e.name=e.fullName,e.first_name=e.name.split(" ")[0],e.last_name=e.name.split(" ")[1],e.id=e.email,e):e},default:function(e,n){return t(e,n),e}},xhr:function(e,t){var n=t.access_token;delete t.access_token,e.headers.Authorization="Bearer "+n,"get"!==e.method&&e.data&&(e.headers["Content-Type"]="application/json","object"===a(e.data)&&(e.data=JSON.stringify(e.data)));"put"===e.method&&(e.method="patch");return!0}}})}(s),function(e){function t(e){e&&"errorCode"in e&&(e.error={code:e.status,message:e.message})}function n(e){if(!e.error)return e.first_name=e.firstName,e.last_name=e.lastName,e.name=e.formattedName||e.first_name+" "+e.last_name,e.thumbnail=e.pictureUrl,e.email=e.emailAddress,e}function r(e){return t(e),o(e),e.values&&(e.data=e.values.map(n),delete e.values),e}function o(e){"_count"in e&&"_start"in e&&e._count+e._start<e._total&&(e.paging={next:"?start="+(e._start+e._count)+"&count="+e._count})}function i(e){e.access_token&&(e.oauth2_access_token=e.access_token,delete e.access_token)}function a(e,t){e.headers["x-li-format"]="json";var n=e.data.id;e.data=("delete"!==e.method).toString(),e.method="put",t("people/~/network/updates/key="+n+"/is-liked")}e.init({linkedin:{oauth:{version:2,response_type:"code",auth:"https://www.linkedin.com/uas/oauth2/authorization",grant:"https://www.linkedin.com/uas/oauth2/accessToken"},refresh:!0,scope:{basic:"r_basicprofile",email:"r_emailaddress",files:"",friends:"",photos:"",publish:"w_share",publish_files:"w_share",share:"",videos:"",offline_access:""},scope_delim:" ",base:"https://api.linkedin.com/v1/",get:{me:"people/~:(picture-url,first-name,last-name,id,formatted-name,email-address)","me/share":"people/~/network/updates?count=@{limit|250}"},post:{"me/share":function(e,t){var n={visibility:{code:"anyone"}};e.data.id?n.attribution={share:{id:e.data.id}}:(n.comment=e.data.message,e.data.picture&&e.data.link&&(n.content={"submitted-url":e.data.link,"submitted-image-url":e.data.picture})),e.data=JSON.stringify(n),t("people/~/shares?format=json")},"me/like":a},del:{"me/like":a},wrap:{me:function(e){return t(e),n(e),e},"me/friends":r,"me/following":r,"me/followers":r,"me/share":function(e){return t(e),o(e),e.values&&(e.data=e.values.map(n),e.data.forEach((function(e){e.message=e.headline})),delete e.values),e},default:function(e,n){t(e),function(e,t){"{}"===JSON.stringify(e)&&200===t.statusCode&&(e.success=!0)}(e,n),o(e)}},jsonp:function(e,t){i(t),"get"===e.method&&(t.format="jsonp",t["error-callback"]=e.callbackID)},xhr:function(e,t){return"get"!==e.method&&(i(t),e.headers["Content-Type"]="application/json",e.headers["x-li-format"]="json",e.proxy=!0,!0)}}})}(s),function(e){function t(e,t){var n=t.access_token;return delete t.access_token,t.oauth_token=n,t["_status_code_map[302]"]=200,!0}function n(e){return e.id&&(e.picture=e.avatar_url,e.thumbnail=e.avatar_url,e.name=e.username||e.full_name),e}e.init({soundcloud:{name:"SoundCloud",oauth:{version:2,auth:"https://soundcloud.com/connect",grant:"https://soundcloud.com/oauth2/token"},base:"https://api.soundcloud.com/",get:{me:"me.json","me/friends":"me/followings.json","me/followers":"me/followers.json","me/following":"me/followings.json",default:function(e,t){t(e.path+".json")}},wrap:{me:function(e){return n(e),e},default:function(e){var t;return Array.isArray(e)&&(e={data:e.map(n)}),"next_href"in(t=e)&&(t.paging={next:t.next_href}),e}},xhr:t,jsonp:t}})}(s),function(e){function t(e){return e.id&&(e.name=e.display_name,e.thumbnail=e.images.length?e.images[0].url:null,e.picture=e.thumbnail),e}function n(e){e&&"next"in e&&(e.paging={next:e.next},delete e.next)}e.init({spotify:{name:"Spotify",oauth:{version:2,auth:"https://accounts.spotify.com/authorize",grant:"https://accounts.spotify.com/api/token"},scope_delim:" ",scope:{basic:"",photos:"",friends:"user-follow-read",publish:"user-library-read",email:"user-read-email",share:"",publish_files:"",files:"",videos:"",offline_access:""},base:"https://api.spotify.com",get:{me:"/v1/me","me/following":"/v1/me/following?type=artist","me/like":"/v1/me/tracks"},wrap:{me:t,"me/following":function(e){n(e),e&&"artists"in e&&(e.data=e.artists.items.forEach(t));return e},"me/like":function(e){return n(e),e.data=e.items,e}},xhr:function(e,t){var n=t.access_token;return delete t.access_token,e.headers.Authorization="Bearer "+n,!0},jsonp:!1}})}(s),function(e){var t="https://api.twitter.com/";function n(e){if(e.id){if(e.name){var t=e.name.split(" ");e.first_name=t.shift(),e.last_name=t.join(" ")}e.thumbnail=e.profile_image_url_https||e.profile_image_url}return e}function r(e){return o(e),i(e),e.users&&(e.data=e.users.map(n),delete e.users),e}function o(e){if(e.errors){var t=e.errors[0];e.error={code:"request_failed",message:t.message}}}function i(e){"next_cursor_str"in e&&(e.paging={next:"?cursor="+e.next_cursor_str})}e.init({twitter:{oauth:{version:"1.0a",auth:t+"oauth/authenticate",request:t+"oauth/request_token",token:t+"oauth/access_token"},login:function(e){this.oauth.auth=this.oauth.auth.replace("?force_login=true","")+(e.options.force?"?force_login=true":"")},base:t+"1.1/",get:{me:"account/verify_credentials.json","me/friends":"friends/list.json?count=@{limit|200}","me/following":"friends/list.json?count=@{limit|200}","me/followers":"followers/list.json?count=@{limit|200}","me/share":"statuses/user_timeline.json?count=@{limit|200}","me/like":"favorites/list.json?count=@{limit|200}"},post:{"me/share":function(t,n){var r=t.data;t.data=null;var o=[];r.message&&(o.push(r.message),delete r.message),r.link&&(o.push(r.link),delete r.link),r.picture&&(o.push(r.picture),delete r.picture),o.length&&(r.status=o.join(" ")),r.file?(r["media[]"]=r.file,delete r.file,t.data=r,n("statuses/update_with_media.json")):"id"in r?n("statuses/retweet/"+r.id+".json"):(e.utils.extend(t.query,r),n("statuses/update.json?include_entities=1"))},"me/like":function(e,t){var n=e.data.id;e.data=null,t("favorites/create.json?id="+n)}},del:{"me/like":function(){p.method="post";var e=p.data.id;p.data=null,callback("favorites/destroy.json?id="+e)}},wrap:{me:function(e){return o(e),n(e),e},"me/friends":r,"me/followers":r,"me/following":r,"me/share":function(e){return o(e),i(e),!e.error&&"length"in e?{data:e}:e},default:function(e){return i(e=function(e){return Array.isArray(e)?{data:e}:e}(e)),e}},xhr:function(e){return"get"!==e.method}}})}(s),function(e){e.init({vk:{name:"Vk",oauth:{version:2,auth:"https://oauth.vk.com/authorize",grant:"https://oauth.vk.com/access_token"},scope:{email:"email",friends:"friends",photos:"photos",videos:"video",share:"share",offline_access:"offline"},refresh:!0,login:function(e){e.qs.display=window.navigator&&window.navigator.userAgent&&/ipad|phone|phone|android/.test(window.navigator.userAgent.toLowerCase())?"mobile":"popup"},base:"https://api.vk.com/method/",get:{me:function(e,t){e.query.fields="id,first_name,last_name,photo_max",t("users.get")}},wrap:{me:function(e,t,n){return function(e){if(e.error){var t=e.error;e.error={code:t.error_code,message:t.error_msg}}}(e),function(e,t){null!==e&&"response"in e&&null!==e.response&&e.response.length&&((e=e.response[0]).id=e.uid,e.thumbnail=e.picture=e.photo_max,e.name=e.first_name+" "+e.last_name,t.authResponse&&null!==t.authResponse.email&&(e.email=t.authResponse.email));return e}(e,n)}},xhr:!1,jsonp:!0,form:!1}})}(s),function(e){function t(e){return"data"in e&&e.data.forEach((function(e){e.picture&&(e.thumbnail=e.picture),e.images&&(e.pictures=e.images.map(n).sort((function(e,t){return e.width-t.width})))})),e}function n(e){return{width:e.width,height:e.height,source:e.source}}function r(e,t,n){if(e.id){var r=n.query.access_token;if(e.emails&&(e.email=e.emails.preferred),!1!==e.is_friend){var o=e.user_id||e.id;e.thumbnail=e.picture="https://apis.live.net/v5.0/"+o+"/picture?access_token="+r}}return e}function o(e,t,n){return"data"in e&&e.data.forEach((function(e){r(e,0,n)})),e}e.init({windows:{name:"Windows live",oauth:{version:2,auth:"https://login.live.com/oauth20_authorize.srf",grant:"https://login.live.com/oauth20_token.srf"},refresh:!0,logout:function(){return"http://login.live.com/oauth20_logout.srf?ts="+(new Date).getTime()},scope:{basic:"wl.signin,wl.basic",email:"wl.emails",birthday:"wl.birthday",events:"wl.calendars",photos:"wl.photos",videos:"wl.photos",friends:"wl.contacts_emails",files:"wl.skydrive",publish:"wl.share",publish_files:"wl.skydrive_update",share:"wl.share",create_event:"wl.calendars_update,wl.events_create",offline_access:"wl.offline_access"},base:"https://apis.live.net/v5.0/",get:{me:"me","me/friends":"me/friends","me/following":"me/contacts","me/followers":"me/friends","me/contacts":"me/contacts","me/albums":"me/albums","me/album":"@{id}/files","me/photo":"@{id}","me/files":"@{parent|me/skydrive}/files","me/folders":"@{id|me/skydrive}/files","me/folder":"@{id|me/skydrive}/files"},post:{"me/albums":"me/albums","me/album":"@{id}/files/","me/folders":"@{id|me/skydrive/}","me/files":"@{parent|me/skydrive}/files"},del:{"me/album":"@{id}","me/photo":"@{id}","me/folder":"@{id}","me/files":"@{id}"},wrap:{me:r,"me/friends":o,"me/contacts":o,"me/followers":o,"me/following":o,"me/albums":function(e){"data"in e&&e.data.forEach((function(e){e.photos=e.files="https://apis.live.net/v5.0/"+e.id+"/photos"}));return e},"me/photos":t,default:t},xhr:function(t){return"get"===t.method||"delete"===t.method||e.utils.hasBinary(t.data)||("string"==typeof t.data.file?t.data.file=e.utils.toBlob(t.data.file):(t.data=JSON.stringify(t.data),t.headers={"Content-Type":"application/json"})),!0},jsonp:function(t){"get"===t.method||e.utils.hasBinary(t.data)||(t.data.method=t.method,t.method="get")}}})}(s),function(e){function t(e){e&&"meta"in e&&"error_type"in e.meta&&(e.error={code:e.meta.error_type,message:e.meta.error_message})}function n(e,n,i){return t(e),o(e,n,i),e.query&&e.query.results&&e.query.results.contact&&(e.data=e.query.results.contact,delete e.query,Array.isArray(e.data)||(e.data=[e.data]),e.data.forEach(r)),e}function r(e){e.id=null,!e.fields||e.fields instanceof Array||(e.fields=[e.fields]),(e.fields||[]).forEach((function(t){"email"===t.type&&(e.email=t.value),"name"===t.type&&(e.first_name=t.value.givenName,e.last_name=t.value.familyName,e.name=t.value.givenName+" "+t.value.familyName),"yahooid"===t.type&&(e.id=t.value)}))}function o(e,t,n){return e.query&&e.query.count&&n.options&&(e.paging={next:"?start="+(e.query.count+(+n.options.start||1))}),e}function i(e){return"https://query.yahooapis.com/v1/yql?q="+(e+" limit @{limit|100} offset @{start|0}").replace(/\s/g,"%20")+"&format=json"}e.init({yahoo:{oauth:{version:"1.0a",auth:"https://api.login.yahoo.com/oauth/v2/request_auth",request:"https://api.login.yahoo.com/oauth/v2/get_request_token",token:"https://api.login.yahoo.com/oauth/v2/get_token"},login:function(e){e.options.popup.width=560;try{delete e.qs.state.scope}catch(t){}},base:"https://social.yahooapis.com/v1/",get:{me:i("select * from social.profile(0) where guid=me"),"me/friends":i("select * from social.contacts(0) where guid=me"),"me/following":i("select * from social.contacts(0) where guid=me")},wrap:{me:function(e){if(t(e),e.query&&e.query.results&&e.query.results.profile){(e=e.query.results.profile).id=e.guid,e.last_name=e.familyName,e.first_name=e.givenName||e.nickname;var n=[];e.first_name&&n.push(e.first_name),e.last_name&&n.push(e.last_name),e.name=n.join(" "),e.email=e.emails&&e.emails[0]?e.emails[0].handle:null,e.thumbnail=e.image?e.image.imageUrl:null}return e},"me/friends":n,"me/following":n,default:o}}})}(s),void 0===(i=function(){return s}.call(t,n,t,o))||(o.exports=i),"object"===a(o)&&o.exports&&(o.exports=s)}).call(this,n(10),n(67).setImmediate,n(47)(e))},270:function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},271:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return"object"===r(e)&&!0===e.isAxiosError}},279:function(e,t,n){"use strict";n.r(t);var r=n(36),o=n(25);function i(e){return Array.prototype.slice.call(e)}function a(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function s(e,t,n){var r,o=new Promise((function(o,i){a(r=e[t].apply(e,n)).then(o,i)}));return o.request=r,o}function u(e,t,n){var r=s(e,t,n);return r.then((function(e){if(e)return new p(e,r.request)}))}function c(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]}})}))}function l(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return s(this[t],r,arguments)})}))}function f(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function d(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return u(this[t],r,arguments)})}))}function h(e){this.p_index=e}function p(e,t){this.p_cursor=e,this._request=t}function m(e){this.p_store=e}function g(e){this.p_tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)}}))}function v(e,t,n){this.p_db=e,this.oldVersion=t,this.transaction=new g(n)}function y(e){this.p_db=e}c(h,"p_index",["name","keyPath","multiEntry","unique"]),l(h,"p_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),d(h,"p_index",IDBIndex,["openCursor","openKeyCursor"]),c(p,"p_cursor",["direction","key","primaryKey","value"]),l(p,"p_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(p.prototype[e]=function(){var t=this,n=arguments;return Promise.resolve().then((function(){return t.p_cursor[e].apply(t.p_cursor,n),a(t._request).then((function(e){if(e)return new p(e,t._request)}))}))})})),m.prototype.createIndex=function(){return new h(this.p_store.createIndex.apply(this.p_store,arguments))},m.prototype.index=function(){return new h(this.p_store.index.apply(this.p_store,arguments))},c(m,"p_store",["name","keyPath","indexNames","autoIncrement"]),l(m,"p_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getAllKeys","count"]),d(m,"p_store",IDBObjectStore,["openCursor","openKeyCursor"]),f(m,"p_store",IDBObjectStore,["deleteIndex"]),g.prototype.objectStore=function(){return new m(this.p_tx.objectStore.apply(this.p_tx,arguments))},c(g,"p_tx",["objectStoreNames","mode"]),f(g,"p_tx",IDBTransaction,["abort"]),v.prototype.createObjectStore=function(){return new m(this.p_db.createObjectStore.apply(this.p_db,arguments))},c(v,"p_db",["name","version","objectStoreNames"]),f(v,"p_db",IDBDatabase,["deleteObjectStore","close"]),y.prototype.transaction=function(){return new g(this.p_db.transaction.apply(this.p_db,arguments))},c(y,"p_db",["name","version","objectStoreNames"]),f(y,"p_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[m,h].forEach((function(t){t.prototype[e.replace("open","iterate")]=function(){var t=i(arguments),n=t[t.length-1],r=this.p_store||this.p_index,o=r[e].apply(r,t.slice(0,-1));o.onsuccess=function(){n(o.result)}}}))})),[h,m].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(o){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():o(r)):o(r)}))}))})}));var _=function(e,t,n){var r=s(indexedDB,"open",[e,t]),o=r.request;return o.onupgradeneeded=function(e){n&&n(new v(o.result,e.oldVersion,o.transaction))},r.then((function(e){return new y(e)}))};function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),e}var k=function(){function e(t,n){b(this,e),this.dbName=t,this.storeName=n,this.oldCacheTimeOut=o.b}return S(e,[{key:"openIdb",value:function(){var e=this;return Promise.resolve().then((function(){return _(e.dbName,1,(function(t){t.createObjectStore(e.storeName)}))}))}},{key:"getValue",value:function(e){var t=this;return this.openIdb().then((function(n){return n.transaction(t.storeName,"readonly").objectStore(t.storeName).get(e)}))}},{key:"setValue",value:function(e,t){var n=this;return this.openIdb().then((function(r){var o=r.transaction(n.storeName,"readwrite"),i=o.objectStore(n.storeName);return at_debug.log("CACHE","Storing new data for key "+e),i.put(t,e),i.put((new Date).getTime(),"ts__"+e),o.complete}))}},{key:"clearCache",value:function(e){var t=this;return this.openIdb().then((function(n){var r=n.transaction(t.storeName,"readwrite"),o=r.objectStore(t.storeName);return at_debug.log("CACHE","clearing cache for key "+e),o.delete(e),o.delete("ts__"+e),r.complete}))}},{key:"clearOldCache",value:function(){var e=this;return this.openIdb().then((function(t){var n=t.transaction(e.storeName,"readwrite"),r=n.objectStore(e.storeName);return r.openCursor().then((function t(n){if(n)return/^ts__/.test(n.key)&&(new Date).getTime()-n.value>e.oldCacheTimeOut&&(at_debug.log("CACHE","clearing cache for key "+n.key),r.delete(n.key),r.delete(n.key.substring(4,n.key.length))),n.continue().then(t)})),n.complete}))}}]),e}(),A=function(){function e(t,n,r){b(this,e),this.dbName=void 0,this.dbStore=void 0,this.key=void 0,this.persistedData=void 0,this._idb=void 0,this._oldDataCleared=!1,this._dataUpdateCallback=function(){},this.clearCacheForKey=this.clearCacheForKey.bind(this),t&&n&&this.setDbStore(t,n,r)}return S(e,[{key:"_setPersistedDate",value:function(e){var t=this.persistedData;this.persistedData=e,t!==e&&this._dataUpdateCallback(e,t)}},{key:"setDbStore",value:function(e,t,n){e&&t&&(e!==this.dbName||t!==this.dbStore)&&(this.dbName=e,this.dbStore=t,n&&this.setDataCallback(n),void 0!==this.persistedData&&(this.persistedData=void 0),this._idb=new k(e,t),this.key&&this.setKey(this.key))}},{key:"setDataCallback",value:function(e){this._dataUpdateCallback=e}},{key:"setKey",value:function(e){var t=this;at_debug.log("CACHE","Attempting to load cache for key "+e),this.key=e,this.key&&void 0===this.persistedData?this._idb.getValue(e).then((function(n){void 0!==n?(at_debug.log("CACHE","found cached data for key "+e),t._setPersistedDate(n)):at_debug.log("CACHE","no cached data for key "+e)})):at_debug.log("CACHE","key is undefined or data already persisted, not cycling through cache")}},{key:"setData",value:function(e){var t=this;this.key&&void 0!==e&&(this._setPersistedDate(e),this._idb.setValue(this.key,e).then((function(){t._oldDataCleared||(t._oldDataCleared=!0,setTimeout((function(){return t._idb.clearOldCache()}),5e3))})))}},{key:"clearCacheForKey",value:function(e){this._idb&&this._idb.clearCache(e)}}]),e}(),E=n(24),T=n(3),O=n(2),R=n(59),I=n(7),x=n(12);function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventLogged=!1,this._dataFetched=!1}var t,n,r;return t=e,(n=[{key:"setInfo",value:function(e){this._provider=e.provider,this._referrer=e.referrer,this._appId=e.appId,this._appTier=e.appTier,this._vizType=e.vizType,this._allowMapsOverusage=e.allowMapsOverusage}},{key:"setReferer",value:function(e){this._initialReferrer=e}},{key:"setDataFetched",value:function(){this._dataFetched=!0,this._logAppView()}},{key:"setUser",value:function(e){this._userEmail=e.email,this._userId=e.id||"",this._logAppView()}},{key:"_logAppView",value:function(){var e=this;if(this._userEmail&&!this._eventLogged&&this._dataFetched){try{if(T.a.inPreview(window.top.location.href)||T.a.inPreview(T.a.referrer))return void at_debug.log("We are in preview|edit|settings|print, not dispatching app_display event")}catch(t){at_debug.log("Caught error while verifying origin ",t)}at_debug.log({message:"SEND VIEW EVENT",data:{email:this._userEmail,id:this._userId,appId:this._appId,referrer:this._referrer,app_tier:this._appTier,viz_type:this._vizType,allow_maps_over_usage:this._allowMapsOverusage}}),window.fetch(x.c,{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({event_type:"app_display",event_time:(new Date).getTime(),app_id:this._appId,referrer:this._initialReferrer||this._referrer,user_email:this._userEmail,user_id:this._userId,app_tier:this._appTier,viz_type:this._vizType,allow_maps_over_usage:this._allowMapsOverusage})}).then((function(t){e._eventLogged=!0})).catch((function(e){}))}}}])&&P(t.prototype,n),r&&P(t,r),e}(),D=n(28),N=n(31),M=n(92),j=n(60),L=n(18),U=new E.a("UA-17877121-8","confStats");U.setCustomD({dimension11:O.a.version});var F,q=U;function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._oldUser={},this.logger=t,this.user=void 0,this.uid=void 0,this.login=this.login.bind(this),this.logout=this.logout.bind(this),this._googleLogin=this._googleLogin.bind(this),this._errorHandler=this._errorHandler.bind(this),this._onIdTokenChanged=this._onIdTokenChanged.bind(this),this.googleLogin=this.googleLogin.bind(this),this.app=r.c,this.ref=r.k,this._googleAuthHelper=new j.a,r.c.auth().onIdTokenChanged(this._onIdTokenChanged,this._errorHandler)}var t,n,o;return t=e,(n=[{key:"_errorHandler",value:function(e,t){var n=e.detail||e;if(at_debug.error(JSON.stringify(n,null,"\t")),q.sendStats({category:"error",action:n.code}),"auth/account-exists-with-different-credential"===e.code&&t)return this._fixFirebaseLogin(t).then((function(){return q.sendStats({category:"error",action:"success/fix-account-exists-with-different-credential"})}))}},{key:"_fixFirebaseLogin",value:function(e){var t=this;return Object(L.b)(x.h,{fireDomain:O.a.rootDomain,token:e,action:"register",getToken:!0,providerId:N.a[N.c.GOOGLE]}).then((function(e){return t.app.auth().signInAndRetrieveDataWithCustomToken(e)})).then((function(t){var n=firebase.auth.GoogleAuthProvider.credential(null,e);return t.user.linkWithCredential(n)}))}},{key:"_onIdTokenChanged",value:function(e){var t=this;if(e!==this._oldUser){if(this._oldUser=e,!e)return at_debug.log("LOGOUT"),this.user=void 0,this.uid=void 0,void this.logger.setUser({email:"anonymous"});at_debug.log("LOGIN: start"),delete e.providerData[0].gid,e.providerData[0].gid=e.providerData[0].uid,this.user=e.providerData[0],this.uid=e.uid,q.setUserId(this.uid),q.setCustomD({dimension1:this.user.email&&this.user.email.split("@")[1],dimension2:this.uid}),this.logger.setUser({email:this.user.email,id:this.uid}),e.getIdToken(!0).then((function(e){var n=t.user;if(!n||!n.providerId)throw"User does not have any provider Id";var r=n&&n.providerId;return Object(L.b)(x.h,{fireIdToken:e,action:"register",fireDomain:O.a.rootDomain,providerId:r})})).then((function(){at_debug.log("LOGIN: REGISTER success")})).catch((function(e){at_debug.error("LOGIN: REGISTER",e)}))}}},{key:"login",value:function(e){var t=this;return e&&"string"==typeof e?(at_debug.log("START LOGIN"),this.app.auth().signInAndRetrieveDataWithCredential(firebase.auth.GoogleAuthProvider.credential(null,e)).catch((function(n){return t._errorHandler(n,e)})).then((function(){return t.app.auth().currentUser}))):Promise.resolve(null)}},{key:"logout",value:function(){return at_debug.log("LOGOUT"),this.app.auth().signOut()}},{key:"_googleLogin",value:function(e){return Object(M.c)(e,x.d,x.g).then((function(e){if(!e.access_token)throw e;return e}))}},{key:"googleLogin",value:function(e){var t=this;try{return e?function(e){return at_debug.log("Hello js login"),t._googleAuthHelper.login(e)}:function(e){return at_debug.log("Use Google auth"),t._googleLogin(e)}}catch(n){}}},{key:"_refError",get:function(){return!F&&(F=this.app.database("https://".concat(O.a.rootDomain,"-errors.firebaseio.com")).ref()),F}}])&&B(t.prototype,n),o&&B(t,o),e}(),G=n(0),V=n(17),W=n(26);function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K(e,t,n){return t&&z(e.prototype,t),n&&z(e,n),e}var Y=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._accessToken=t,this._domain=n,this._securityCode=r}return K(e,null,[{key:"API_ENDPOINT",get:function(){return"https://ao-docs.appspot.com/_ah/api/"}}]),K(e,[{key:"_callAPI",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return n.headers=n.headers||{},this._accessToken&&(n.headers.Authorization="Bearer ".concat(this._accessToken)),this._securityCode&&(n.securityCode=this._securityCode),this._domain&&(n.domain=this._domain),Object(L.b)(e.API_ENDPOINT+t,n,r).catch((function(e){return e}))}},{key:"listLibraries",value:function(t){return t?this._callAPI("library/v1/plain",{},"PUT"):Promise.reject(new Error(e.ERRORS.NO_DOMAIN))}},{key:"listViews",value:function(t){return t?this._callAPI("view/v1/libraries/".concat(t)):Promise.reject(new Error(e.ERRORS.NO_LIBRARY_ID))}},{key:"probeLibraryAccess",value:function(t){if(!t)return Promise.reject(new Error(e.ERRORS.NO_LIBRARY_ID));var n="library/v1/".concat(t),r={include:"NONE",fields:encodeURIComponent("libraryId,name")};return this._callAPI(n,r).then((function(e){if(e.name&&e.libraryId)return{name:e.name,id:e.libraryId};throw"malformed library response"})).catch((function(){return{error:{status:"PERMISSION_DENIED"}}}))}},{key:"loadDocumentClass",value:function(t,n){if(!t)return Promise.reject(new Error(e.ERRORS.NO_LIBRARY_ID));if(!n)return Promise.reject(new Error(e.ERRORS.NO_DOCUMENT_CLASS_ID));var r="documentType/v1/libraries/".concat(t,"/documentTypes/").concat(n),o={fields:encodeURIComponent("displayName,fields(displayName,id,type),id")};return this._callAPI(r,o).then((function(e){return{displayName:e.displayName,id:e.id,fields:e.fields?e.fields.map((function(e){return{displayName:e.displayName,id:e.id,type:e.type}})):[]}}))}},{key:"loadDocumentClasses",value:function(t,n){var r=this;return t?n?Array.isArray(n)?Promise.all(n.map((function(e){return r.loadDocumentClass(t,e)}))):Promise.reject(new Error(e.ERRORS.NOT_ARRAY_DOCUMENT_CLASSES)):Promise.reject(new Error(e.ERRORS.NO_DOCUMENT_CLASS_ID)):Promise.reject(new Error(e.ERRORS.NO_LIBRARY_ID))}},{key:"loadDocument",value:function(t){if(!t)return Promise.reject(new Error(e.ERRORS.NO_DOCUMENT_ID));var n="document/v1/".concat(t),r={fields:encodeURIComponent("attachments(fileId,mimeType),categories(fieldName,multiple,values),className,fields(fieldName,multiple,type,values),id,systemFields(displayName,value),title")};return this._callAPI(n,r).then((function(e){return{title:e.title,className:e.className,id:e.id,attachments:e.attachments?e.attachments.map((function(e){return{fileId:e.fileId,mimeType:e.mimeType}})):[],categories:e.categories?e.categories.map((function(e){return{fieldName:e.fieldName,multiple:e.multiple,type:e.type,values:e.values}})):[],fields:e.fields?e.fields.map((function(e){return{fieldName:e.fieldName,multiple:e.multiple,type:e.type,values:e.values}})):[],systemFields:e.systemFields?e.systemFields.map((function(e){return{displayName:e.displayName,value:e.value}})):[]}}))}},{key:"loadDocuments",value:function(t){var n=this;return t?Promise.all(t.map((function(e){return n.loadDocument(e)}))):Promise.reject(new Error(e.ERRORS.NO_DOCUMENT_ID))}},{key:"countDocuments",value:function(t,n){return t?n?this._callAPI("search/v1/libraries/".concat(t,"/count"),{classId:n},"POST").then((function(e){return e.count})):Promise.reject(new Error(e.ERRORS.NO_DOCUMENT_CLASS_ID)):Promise.reject(new Error(e.ERRORS.NO_LIBRARY_ID))}},{key:"getDocumentsByView",value:function(e,t){var n=this,r="search/v1/libraries/".concat(e,"/views/").concat(t),o=encodeURIComponent("count,documents(attachments(fileId,mimeType),categories(fieldName,multiple,values),className,fields(fieldName,multiple,type,values),id,systemFields(displayName,value),title),precision");return this._callAPI(r,{offset:0,limit:100},"POST").then((function(e){var t=e.count,i=[],a=t-e.documents.length;if(i=i.concat(e.documents),a<=0)return i;for(var s=Math.ceil(a/100),u=[],c=0;c<s;c++)u.push({limit:100,offset:100*(c+1),fields:o});for(var l=0,f=function(e){return n._callAPI(r,e,"POST").then((function(e){return{precision:e.precision,count:e.count,documents:e.documents.map((function(e){return{title:e.title,className:e.className,id:e.id,numberOfAttachments:e.numberOfAttachments,checkOutDate:e.checkOutDate,checkOutBy:e.checkOutBy,modificationDate:e.modificationDate,updateAuthor:e.updateAuthor,creationDate:e.creationDate,initialAuthor:e.initialAuthor,fullSizeOfAttachments:e.fullSizeOfAttachments,state:e.state,stateChangeDate:e.stateChangeDate,versionName:e.versionName,folders:e.folders?e.folders.map((function(e){return{name:e.name}})):[],stateChangeAuthors:e.stateChangeAuthors?e.stateChangeAuthors.map((function(e){return{displayName:e.displayName}})):[],attachments:e.attachments?e.attachments.map((function(e){return{fileId:e.fileId,mimeType:e.mimeType}})):[],categories:e.categories?e.categories.map((function(e){return{fieldName:e.fieldName,multiple:e.multiple,type:e.type,values:e.values}})):[],fields:e.fields?e.fields.map((function(e){return{fieldName:e.fieldName,multiple:e.multiple,type:e.type,values:e.values}})):[],systemFields:e.systemFields?e.systemFields.map((function(e){return{displayName:e.displayName,value:e.value}})):[]}}))}}))},d=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250,o=void 0===n?l++:n;if(o>=s)return t;var i=u[o];return f({limit:i.limit,offset:i.offset}).then((function(e){if(!e.documents)throw"retry";return t=t.concat(e.documents),{}})).catch((function(){return new Promise((function(e){return setTimeout(e,r)})).then((function(){return i.failure=(i.failure||0)+1,i.failure>=3?{}:{retryIndex:o,delay:2*r}}))})).then((function(n){var r=n.retryIndex,o=n.delay;return void 0!==r?e(t,r,o):e(t)}))},h=[],p=0;p<5;p++)h.push(d());return Promise.all(h).then((function(e){return e})).then((function(e){return i.concat(e.flat())}))}))}},{key:"getDocsFromViews",value:function(t,n){var r=this;if(!Array.isArray(n))return Promise.reject(new Error(e.ERRORS.NO_LIST_OF_VIEW_DOC_CLASS));var o=Promise.resolve(),i=[];return n.map((function(e){o=o.then((function(){return r.getDocumentsByView(t,e)})).then((function(e){return i.push(e)}))})),o.then((function(){return i.flat()}))}}]),e}();Y.ERRORS={NO_DOCUMENT_ID:"Document ID must not be empty",NO_DOMAIN:"Domain must not be empty!",NO_LIBRARY_ID:"Library ID must not be empty!",NO_DOCUMENT_CLASS_ID:"Document Class ID must not be empty!",NO_DOCUMENT_CLASSES:"Document Classes must not be empty!",NO_VIEW_ID:"Document Class ID must not be empty!",NO_LIST_OF_VIEW_DOC_CLASS:"Not a list of pair of viewId and docClass",NOT_ARRAY_DOCUMENT_CLASSES:"Document Class IDs must be an array!"};var J=Y,$=n(48),Q=n(9);function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ee=function(e){var t=X(e.match(/(^[A-Z]+)|([0-9]+$)/gm)||[],2),n=t[0],r=t[1];if(void 0===n&&void 0===r)throw"Invalid cell reference";var o={row:null,col:null};return void 0!==r&&(o.row=function(e){return+e-1}(r)),void 0!==n&&(o.col=function(e){if("string"!=typeof e)throw"Expected column label";for(var t=0,n=(e=e.toUpperCase()).length-1,r=0;n>-1;n--,r++)t+=(e.charCodeAt(n)-64)*Math.pow(26,r);return t}(n)),o},te=function(e){try{var t=X(e.split(":"),2),n=t[0],r=t[1],o=ee(n),i=r&&ee(r)||o;return{start:o,end:i,width:null!==o.col&&null!==i.col?i.col-o.col+1:null,height:null!==o.row&&null!==i.row?i.row-o.row+1:null}}catch(a){throw"Invalid range reference"}},ne=n(1);function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ie,ae=function(){var e=Object.keys(ne).map((function(e){return ne[e].regex||ne[e]}));return new RegExp("^\\s+|\\s+$|(?:(?:\\s*-\\s*|\\s)((".concat(e.join("|"),")(?:\\s?\\(([^)]+)\\))?)(?:\\s*-\\s*(?!\\w)|\\s(?!\\w))?)"),"ig")},se=function(e){for(var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=ae(),o=(n?"":"- ")+e,i=[];null!==(t=r.exec(o));)if(t[1]){var a=t,s=re(a,4),u=s[2],c=s[3];i.push({keyword:u.toLowerCase(),params:c?c.split(/\s*,\s*/):null})}return i},ue=function(e,t,n){var r,o=function(e){var t={};return e.cols.forEach((function(e){t[e.label.replace(ae(),"")]=se(e.label,!0)})),t}(e.data),i=ae();if(e.data.cols.forEach((function(e){e.label=e.label.replace(i,"")})),t.data){var a=function(e,t){var n,r,o,i,a,s=te(t),u=null;return(n=1===s.height||1===e.rows.length?{templates:[{label:Q.e,template:""+e.rows[0].c[0].v}],onlyDisplay:(o={},i=Q.e,a=!0,i in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,o),noAutoAdd:!1}:3===s.height&&3===e.rows.length?{templates:(r=[],u={},e.cols.forEach((function(t,n){if(e.rows[2].c[n]&&null!==e.rows[2].c[n].v&&""!==e.rows[2].c[n].v){var o=""+(e.rows[0].c[n]&&e.rows[0].c[n].v||Q.c).trim();r.push({label:o,template:""+(e.rows[2].c[n].v||"")}),u[o]=se(""+(e.rows[1].c[n]&&e.rows[1].c[n].v||""))}})),r),noAutoAdd:!1}:{templates:function(){var t=[];return e.rows.length>0&&e.cols.forEach((function(n,r){e.rows[1].c[r]&&null!==e.rows[1].c[r].v&&""!==e.rows[1].c[r].v&&t.push({label:""+(e.rows[0].c[r]&&e.rows[0].c[r].v||Q.c).trim(),template:""+(e.rows[1].c[r].v||"")})})),t}(),noAutoAdd:3!==s.height}).signature=V.a.SHA256(JSON.stringify(n)).toString(),{templateColumnsSettings:u,templates:n}}(t.data,n),s=a.templateColumnsSettings;r=a.templates,s&&Object.keys(s).forEach((function(e){o[e]?s[e].forEach((function(t){var n=o[e].find((function(e){return e.keyword===t.keyword}));n?n.params=t.params:o[e].push(t)})):o[e]=s[e]}))}return new W.a({data:{dataTable:e.data,signature:e.sig||V.a.SHA256(JSON.stringify(e.data)).toString()},settings:{columns:o,signature:V.a.SHA256(JSON.stringify(o)).toString()},template:r||null})};function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var he=(de(ie={},Q.f,!0),de(ie,Q.d,!0),de(ie,Q.c,!0),de(ie,Q.e,!0),ie),pe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=G.a.AODOCS,this.tools=t,this.isAuth=!1,this._accessToken="",this._source=void 0,this._dateFormat="yyyy/mm/dd"}var t,n,r;return t=e,r=[{key:"_findWithProperty",value:function(t,n,r){if(!Array.isArray(t))throw new Error(e.ERRORS.FIELD_LIST_NOT_ARRAY);return t.map((function(e){return e[n]})).indexOf(r)}},{key:"_createDefaultArray",value:function(e,t){if(!Number.isInteger(t))throw new Error("Size must be an integer!");return new Array(t).fill(e,0,t)}},{key:"_convertType",value:function(t){switch(t.toLowerCase()){case e.AODOCS_TYPES.DECIMAL:case e.AODOCS_TYPES.INTEGER:return e.AT_TYPES.NUMBER;case e.AODOCS_TYPES.DATE:return e.AT_TYPES.DATE;case e.AODOCS_TYPES.TIME:return e.AT_TYPES.DATE_TIME;default:return e.AT_TYPES.STRING}}}],(n=[{key:"_auth",value:function(){var e=this;if(at_debug.log("FETCH_DATA","start AUTH"),this.ready=new Promise((function(t,n){e._authDone_res=t,e._authDone_rej=n})),this._accessToken)return this.isAuth=!0,void new J(this._accessToken).probeLibraryAccess(this._source.libraryId).then((function(){e._authDone_res()})).catch((function(){e._authDone_rej()}));this._loginAuthUser(0)}},{key:"_loginAuthUser",value:function(t){var n=this;if(t>=e.CONSTS.AUTH_USER_MAX_TENTATIVES)return at_debug.log("FETCH_DATA","auth FAILED, waiting for manual login"),this.tools.showManualLogin(),void this.tools.sendAuthAnalytics("max tentative");at_debug.log("FETCH_DATA","login with user ".concat(t)),this.tools.login({authUser:t}).then((function(e){return n._accessToken=e&&e.access_token||"",n.isAuth=!0,new J(n._accessToken,n._source.domain).probeLibraryAccess(n._source.libraryId).then((function(e){if(!e.error)return n._authDone_res();n._accessToken="",n.isAuth=!1,n._loginAuthUser(t+1)}))})).then((function(){n.tools.sendAuthAnalytics(t)})).catch((function(){n._accessToken="",n.isAuth=!1,n._loginAuthUser(t+1)}))}},{key:"_extractFieldNames",value:function(t){if(!t)throw new Error(e.ERRORS.EMPTY_AODOCS_LIST);if(!Array.isArray(t))throw new Error(e.ERRORS.DOCS_NOT_ARRAY);var n=[{label:"Title",type:"string"},{label:"Class Name",type:"string"},{label:"ID",type:"string"},{label:"Description",type:"string"},{label:"Attachment number",type:"string"},{label:"Checked out date",type:"string"},{label:"Checked out by",type:"string"},{label:"Last update",type:"string"},{label:"Last update author",type:"string"},{label:"Creation date",type:"string"},{label:"Document creator",type:"string"},{label:"Folder",type:"string"},{label:"Full size",type:"string"},{label:"State",type:"string"},{label:"State change date",type:"string"},{label:"State change authors",type:"string"},{label:"Version name",type:"string"}];return t.forEach((function(t){t.fields.forEach((function(t){-1===e._findWithProperty(n,"label",t.displayName)&&n.push({label:t.displayName,type:e._convertType(t.type)})}))})),n}},{key:"_buildDataTable",value:function(t,n){var r=this;if(!t)throw new Error(e.ERRORS.EMPTY_FIELDS);if(!n)throw new Error(e.ERRORS.EMPTY_AODOCS_LIST);if(!Array.isArray(n))throw new Error(e.ERRORS.DOCS_NOT_ARRAY);for(var o={cols:[],rows:[]},i=0;i<t.length;i++){var a={id:Object(L.c)(i+1),label:t[i].label,type:t[i].type};a.type===e.AODOCS_TYPES.DATE&&(a.pattern=this._dateFormat),o.cols.push(a)}return n.forEach((function(n){if(n){var i={c:e._createDefaultArray({v:"",f:""},t.length)};i.c[e._findWithProperty(t,"label","Title")]={v:n.title},i.c[e._findWithProperty(t,"label","Class Name")]={v:n.className},i.c[e._findWithProperty(t,"label","ID")]={v:n.id},i.c[e._findWithProperty(t,"label","Attachment number")]={v:n.numberOfAttachments},i.c[e._findWithProperty(t,"label","Checked out at")]=n.checkOutDate?r._extractDateValue([n.checkOutDate],!1):"",i.c[e._findWithProperty(t,"label","Checked out by")]={v:n.checkOutBy},i.c[e._findWithProperty(t,"label","Last update")]=n.modificationDate?r._extractDateValue([n.modificationDate],!1):"",i.c[e._findWithProperty(t,"label","Last update author")]={v:n.updateAuthor},i.c[e._findWithProperty(t,"label","Creation date")]=n.creationDate?r._extractDateValue([n.creationDate],!1):"",i.c[e._findWithProperty(t,"label","Document creator")]={v:n.initialAuthor},i.c[e._findWithProperty(t,"label","Folder")]={v:n.folders&&n.folders.map((function(e){return e.name})).join("/")},i.c[e._findWithProperty(t,"label","Full size")]={v:n.fullSizeOfAttachments},i.c[e._findWithProperty(t,"label","State")]={v:n.state},i.c[e._findWithProperty(t,"label","State change date")]=n.stateChangeDate&&r._extractDateValue([n.stateChangeDate],!1),i.c[e._findWithProperty(t,"label","State change authors")]={v:n.stateChangeAuthors&&n.stateChangeAuthors.map((function(e){return e.displayName})).join(", ")},i.c[e._findWithProperty(t,"label","Version name")]={v:n.versionName},n.systemFields.forEach((function(n){n.value&&(i.c[e._findWithProperty(t,"label",n.displayName)]={v:n.value})})),n.fields.forEach((function(n){var o=n.fieldName,a=n.type,s=n.multiple,u=n.values;if(u){var c=e._convertType(a),l=e._findWithProperty(t,"label",o);switch(c){case e.AT_TYPES.DATE:i.c[l]=r._extractDateValue(u,s);break;case e.AT_TYPES.NUMBER:i.c[l]=r._extractNumberValue(u,s);break;default:i.c[l]={v:s?u.join("\n"):u[0]}}}})),n.categories&&n.categories.forEach((function(n){n.values&&(i.c[e._findWithProperty(t,"label",n.fieldName)]={v:r._extractAODocsCategoryValues(n.values).slice(0,-2)})})),o.rows.push(i)}})),o}},{key:"_loadTemplateSettings_fromAttachment",value:function(t){var n=this;return t?this._AODocsAPI.loadDocument(t).then((function(t){if(!t.attachments)throw e.ERRORS.NO_ATTACHMENT;var r=t.attachments.filter((function(t){return t.mimeType===e.CONSTS.SPREADSHEET_MIME_TYPE})),o=n._getAODocsFields(t,["Settings Sheet Name","Settings Sheet Range"]),i=o["Settings Sheet Name"],a=o["Settings Sheet Range"],s=i&&i.values?i.values[0]:void 0,u=a&&a.values?a.values[0]:void 0;return n._getTemplateSettingsFromSheet(r[0].fileId,s,u)})).then((function(e){return{templates:e.template,columnsSettings:e.settings}})):{templates:void 0,columnsSettings:void 0}}},{key:"_getTemplateSettingsFromSheet",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1:3",o="https://sheets.googleapis.com/v4/spreadsheets/".concat(t,"?fields=sheets/properties/title,sheets/data&ranges=").concat(n,"!").concat(r,"&key=").concat(O.a.apiKey),i={headers:{}};return this._accessToken&&(i.headers.Authorization="Bearer ".concat(this._accessToken)),Object(L.b)(o,i).then((function(t){if(!("sheets"in t&&Array.isArray(t.sheets)&&"data"in t.sheets[0]&&Array.isArray(t.sheets[0].data)&&Array.isArray(t.sheets[0].data)&&"rowData"in t.sheets[0].data[0]))throw new Error(e.ERRORS.MALFORMED_SHEET_RESPONSE);var n=t.sheets[0].data[0].rowData,r=(n[0].values||[]).map((function(e){return e.formattedValue})),o={};return(n[1].values||[]).forEach((function(e,t){he[r[t]]||(o[r[t]]=se(e.formattedValue))})),{template:(n[2].values||[]).map((function(e,t){return{label:r[t],template:e.formattedValue}})).filter((function(e){return void 0!==e.template})),settings:o}}))}},{key:"_extractNumberValue",value:function(e,t){var n=e.map((function(e){return+e}));return{v:t?n.join("\n"):n[0]}}},{key:"_extractDateValue",value:function(e,t){var n=this,r=[],o=[];return[].concat(e).forEach((function(e){var t=new Date(parseInt(e)),i=t.getDate(),a=t.getMonth(),s=t.getFullYear();r.push("Date(".concat(s,",").concat(a,",").concat(i,")")),o.push(n._dateFormat.replace(/d+/i,String(i)).replace(/m+/i,String(a)).replace(/y+/i,String(s)))})),{v:t?r.join("\n"):r[0],f:t?o.join("\n"):o[0]}}},{key:"_extractAODocsCategoryValues",value:function(e){var t=this;if(Array.isArray(e)){var n="";return e.forEach((function(e){n+=t._extractAODocsCategoryValues(e)})),n}return e.name?e.name+", ":""}},{key:"_getAODocsFields",value:function(e,t){t=[].concat(t);var n={};return e.fields.filter((function(e){return t.includes(e.fieldName)})).forEach((function(e){n[e.fieldName]=e})),n}},{key:"set",value:function(e){e.token&&(this._accessToken=e.token),this._source=new $.a(e.sourceSettings),this._auth()}},{key:"getData",value:function(){var e=this;return this.ready.then((function(){var t={},n=Object.keys(e._source.views).map((function(n){return t[e._source.views[n].docClass]=!0,n})),r=Object.keys(t);e._AODocsAPI=new J(e._accessToken,e._source.domain,e._source.securityCode);var o=[e._AODocsAPI.loadDocumentClasses(e._source.libraryId,r),e._AODocsAPI.getDocsFromViews(e._source.libraryId,n),e._loadTemplateSettings_fromAttachment(e._source.templateDocId)];return Promise.all(o).then((function(t){var n=ce(t,3),r=n[0],o=n[1],i=n[2],a=i.templates,s=i.columnsSettings,u=e._extractFieldNames(r),c=e._buildDataTable(u,o),l=V.a.SHA256(JSON.stringify(c)).toString(),f=a&&V.a.SHA256(JSON.stringify(a)).toString(),d=s&&V.a.SHA256(JSON.stringify(s)).toString();return new W.a({data:{dataTable:c,signature:l},settings:{columns:s,signature:d},template:{templates:a,signature:f,onlyDisplay:void 0,noAutoAdd:!1}})})).catch((function(e){throw e}))}))}},{key:"getCacheKey",value:function(){return this._source.cacheKey}},{key:"buildCacheKey",value:function(e){return e.libraryId&&e.views?e.libraryId+Object.keys(e.views).join(""):JSON.stringify(e)}},{key:"onManualLogin",value:function(){var e=this;this.tools.login({authUser:-1,immediate:!1}).then((function(t){e._accessToken=t&&t.access_token||"",e.isAuth=!0,e.tools.loginDone(e.isAuth),e._authDone_res()})).catch((function(t){t.error&&"popup_closed_by_user"===t.error||(e._accessToken="",e.isAuth=!1,e.tools.loginDone(e.isAuth),e._authDone_rej())}))}}])&&fe(t.prototype,n),r&&fe(t,r),e}(),me=pe;pe.CONSTS={AUTH_USER_MAX_TENTATIVES:6,SPREADSHEET_MIME_TYPE:"application/vnd.google-apps.spreadsheet"},pe.ERRORS={EMPTY_FIELDS:"Field object must not be empty!",EMPTY_AODOCS_LIST:"AODocs document list must not be empty!",DOCS_NOT_ARRAY:"AODocs document list must be an array!",FIELD_LIST_NOT_ARRAY:"Field list must be an array!",NO_ATTACHMENT:"There must be an attachment on the document!",MALFORMED_SHEET_RESPONSE:"The sheet data response is not in the expected format!"},pe.FIELD_KEYWORDS={DATE_FORMAT:"Date Format"},pe.AT_TYPES={STRING:"string",DATE:"date",DATE_TIME:"datetime",NUMBER:"number"},pe.AODOCS_TYPES={STRING:"string",TEXT:"text",DATE:"date",TIME:"time",DATE_TIME:"date & time",INTEGER:"integer",DECIMAL:"decimal",BOOLEAN:"boolean",PERSON:"person",GEOPOINT:"geopoint",URL:"url"};var ge=n(93),ve=n(46),ye=n(49);function _e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return be(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Se=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=G.a.EXCEL,this.tools=t,this._source=void 0,this._accessToken=null,this._userProfile=null,this._isManualLogin=!1,this._promptMode=null,this._ms=new ge.a}var t,n,r;return t=e,r=[{key:"isTemplateNotExists",value:function(e){if(!e.length)return!0;var t=e[0];return 1===t.length&&!t[0]}},{key:"templateDefault",get:function(){return{noAutoAdd:!0,onlyDisplay:null,signature:null,templates:[]}}}],(n=[{key:"_auth",value:function(){var e=this;at_debug.log("FETCH_DATA","start MS AUTH"),this._ready=new Promise((function(t,n){e._authDone_res=t,e._authDone_rej=n})),this._ms.onLogin(this._loggedIn.bind(this));var t=this._ms.hasValidSession();if(this._accessToken||t)return at_debug.log("Using local session cache"),this.isAuth=!0,this._accessToken=t.access_token,void this._authDone_res();this._attemptSilentAuth()}},{key:"_loggedIn",value:function(){at_debug.log("User is logged in with Microsoft Account"),this._ms.hasValidSession()&&(this._accessToken=this._ms.token.access_token,this.isAuth=!0,this._authDone_res(),this.tools.loginDone(this.isAuth,this._isManualLogin))}},{key:"_getSheetData",value:function(e,t){return this._ms.graph.workBookSheetByDriveAndWorkbookId(this._source.driveId,this._source.workbookId,e,t).then((function(t){if(at_debug.log("We have data for sheet '"+e+"' ",t),t.hasOwnProperty("error"))throw t.error;return t})).catch((function(e){throw at_debug.log("Error on getSheet Data !",e),e}))}},{key:"_attemptSilentAuth",value:function(){var e=this,t=!1,n=function(n){t||(t=!0,clearTimeout(r),e.tools.showManualLogin(o.a.MICROSOFT),e._isManualLogin=!0)},r=setTimeout(n,4e3);this._ms.login(!0).then((function(){clearTimeout(r)}),n)}},{key:"_buildDataTableFromArrays",value:function(e,t,n){for(var r,o,i,a={cols:e[0].map((function(e,t){return{id:Object(L.c)(t+1),label:e,type:"string",isNumber:!0,isDate:!0,isEmpty:!0}})),parsedNumHeaders:1,rows:[]},s=2;s<e.length;s++){for(var u=e[s],c=t[s],l=n[s],f=[],d=0;d<u.length;d++)isNaN(u[d])&&(a.cols[d].isNumber=!1),""!=u[d]&&(a.cols[d].isEmpty=!1),null===(i=l[d]).match(/^#|([^\\])#/g)&&(i.indexOf(";@")>0||i.indexOf("AM/PM")>0||null!==i.match(/^y|([^\\])y/g)||null!==i.match(/^m|([^\\])m/g)||null!==i.match(/^d|([^\\])d/g)||null!==i.match(/^h|([^\\])h/g)||null!==i.match(/^s|([^\\])s/g)||null!==i.match(/\[\$-(.*?)]/g))?u[d]=(r=u[d],o=void 0,isNaN(r)?null:(o=r<61?new Date(1e3*Math.round(86400*(r-25568))):new Date(1e3*Math.round(86400*(r-25569))),"Date(".concat(o.getUTCFullYear(),",").concat(o.getUTCMonth(),",").concat(o.getUTCDate(),",").concat(o.getUTCHours(),",").concat(o.getUTCMinutes(),",").concat(o.getUTCSeconds(),",").concat(o.getUTCMilliseconds(),")"))):a.cols[d].isDate=!1,f.push({v:u[d],f:c[d]});a.rows.push({c:f})}for(var h=0;h<e[0].length;h++)a.cols[h].isEmpty?a.cols[h].type="string":a.cols[h].isDate?a.cols[h].type="datetime":a.cols[h].isNumber&&(a.cols[h].type="number");return a}},{key:"_buildTemplateTableFromArrays",value:function(t,n){if(e.isTemplateNotExists(t))return e.templateDefault;var r,o=te(n);return(r=1===t.length?{templates:[{label:Q.e,template:""+t[0][0]}],noAutoAdd:!1}:3===t.length?{templates:t[0].map((function(e,n){if(t[2][n])return{label:(""+e||Q.c).trim(),template:""+(t[2][n]||"")}})),noAutoAdd:!1}:{templates:t[0].map((function(e,n){return{label:(""+e||Q.c).trim(),template:""+(t[1][n]||"")}})),noAutoAdd:3!==o.height}).signature=V.a.SHA256(JSON.stringify(r)).toString(),r}},{key:"_getColumnsSettings",value:function(e,t){var n={};return e[0].map((function(t,r){n[t]=se(e[1][r])})),3===t.length&&t[0].map((function(e,r){n[e]=se(t[1][r])})),n}},{key:"_getViewDataTemplate",value:function(e,t,n){var r=this._buildDataTableFromArrays(e.values,e.text,e.numberFormat),o=this._getColumnsSettings(e.values,t),i=this._buildTemplateTableFromArrays(t,n);return new W.a({data:{dataTable:r,signature:r&&V.a.SHA256(JSON.stringify(r)).toString()},settings:{columns:o,signature:V.a.SHA256(JSON.stringify(o)).toString()},template:i})}},{key:"set",value:function(e){var t=!this._source;e.token&&(this._accessToken=e.token),this._source=new ye.a(e.sourceSettings),t&&this._auth()}},{key:"getUsedRangeForWorkSheet",value:function(e){var t=this;return function(n,r){if(!r)return t._ms.graph.workBookSheetByDriveAndWorkbookId(e.driveId,e.workbookId,n,void 0,"address").then((function(e){return e.address.split("!")[1]}));if(function(e){return!!ve.d.exec(e.split(":")[1])}(r))return r;var o=r;return t._ms.graph.workBookSheetByDriveAndWorkbookId(e.driveId,e.workbookId,n,void 0,"address").then((function(e){var t=e.address.split("!")[1].split(":");return 2!==t.length?null:o+function(e){if(!e)return null;var t=ve.d.exec(e);return t?t[0]:null}(t[1])}))}}},{key:"getData",value:function(){var e=this,t=this._source,n=t.dataRange,r=t.dataSheet,o=t.templateRange,i=t.templateSheet,a=t.driveId,s=t.workbookId,u=this.getUsedRangeForWorkSheet({driveId:a,workbookId:s});return this._ready.then((function(){return Promise.all([u(r,n),(i||o)&&u(i,o)])})).then((function(t){var n=_e(t,2),o=n[0],a=n[1];at_debug.log("fetch ms data");var s=[e._getSheetData(r||"Data",o||void 0),a];return i&&s.push(e._getSheetData(i||"Template",a||void 0)),Promise.all(s)})).then((function(t){var n=_e(t,3),r=n[0],o=n[1],i=n[2],a=i&&i.values?i.values:[];return e._getViewDataTemplate(r,a,o)})).catch((function(t){throw at_debug.error("Error thrown in getData() with error : ",t),at_debug.error("Removing session cache"),t||e._ms.logout(),t}))}},{key:"getCacheKey",value:function(){return this.buildCacheKey(this._source)}},{key:"buildCacheKey",value:function(e){return JSON.stringify(e)}},{key:"onManualLogin",value:function(){var e={};this._promptMode&&(e.prompt=this._promptMode),this._ms.login(!1,e).then(function(){at_debug.log("[onManualLogin]","Successfully logged into microsoft"),this._promptMode=null}.bind(this),(function(e){at_debug.error("[onManualLogin]","Microsoft sign in error: "+e.error.message)}))}}])&&we(t.prototype,n),r&&we(t,r),e}();function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ae(e,t,n){return t&&ke(e.prototype,t),n&&ke(e,n),e}var Ee={},Te=0,Oe={};window.__JsonpRequest_cb__=Ee;var Re=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeOut=n||e.TIMEOUT,this.resolve=null,this.reject=null,this.requestId=e.requestCount++,Oe["_".concat(this.requestId)]=this,this.node=document.createElement("script"),this.callBackName="getResponse".concat(this.requestId,"_"),Ee[this.callBackName]=e._callBackFunc.bind(this),this.query=t.replace("{{callBack}}","__JsonpRequest_cb__.".concat(this.callBackName)),/{{requestId}}/.test(t)&&(this.query=this.query.replace("{{requestId}}",this.requestId))}return Ae(e,null,[{key:"requestCount",get:function(){return Te},set:function(e){Te=e}},{key:"callBack",get:function(){return Ee}},{key:"TIMEOUT",get:function(){return 6e4}}]),Ae(e,[{key:"_queryCleanUp",value:function(e){var t=this;this.node&&(document.head.removeChild(this.node),delete this.node),e?Ee[this.callBackName]=function(){t._queryCleanUp()}:delete Ee[this.callBackName],delete Oe["_"+this.requestId]}},{key:"send",value:function(){var e=this,t=new Promise((function(t,n){e.resolve=t,e.reject=n,setTimeout(n.bind(null,I.d.REQUEST_TIMEOUT),e.timeOut)}));return this.node.onerror=this.reject,this.node.src=this.query,document.head.appendChild(this.node),t.then(function(){return this._queryCleanUp(),1==arguments.length?arguments[0]:arguments}.bind(this)).catch((function(t){throw e._queryCleanUp(!0),t}))}}],[{key:"errorHandler",value:function(e){var t,n=e.filename||"",r=/__JsonpRequest_cb__\.getResponse(\d+)_/.exec(n);if(r)t=Oe["_".concat(r[1])];else{if("Script error."!=e.message||""!=e.filename)return;var o=Object.keys(Oe);if(!(t=Oe[o[o.length-1]]))return}t.reject()}},{key:"_callBackFunc",value:function(){this.resolve.apply(null,1==arguments.length?arguments:[arguments])}}]),e}();window.addEventListener("error",Re.errorHandler);var Ie=Re,xe=n(37);function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=G.a.PROXY,this._source=void 0}var t,n,r;return t=e,(n=[{key:"set",value:function(e){this._source=new xe.a(e.sourceSettings)}},{key:"getData",value:function(){var e=this;return new Ie("".concat(this._source.proxyUrl,"&callback={{callBack}}"),9e4).send().then((function(t){if("error"===t.status&&"not_modified"===t.reason)throw I.d.NOT_MODIFIED;return ue({data:t.dataTable,sig:t.sig},{data:t.template,sig:t.sigTemplate},e._source.templateRange)}))}},{key:"getCacheKey",value:function(){return this.buildCacheKey(this._source)}},{key:"buildCacheKey",value:function(e){return"".concat(e.proxyUrl||e.proxy,"&").concat(e.spsUrl,"headers=2&range=").concat(e.dataRange||"","&sheet=").concat(e.dataSheet||"")+(e.query?"__"+e.query:"")+(e.templateSheet&&e.templateRange?"__templateSheet=".concat(e.templateSheet,"&templateRange=").concat(e.templateRange):"")}}])&&Pe(t.prototype,n),r&&Pe(t,r),e}(),De=n(161),Ne=n.n(De);function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var je={_getInstance:function(){return window._sharedStackDriver||window.top._sharedStackDriver||null},sendCustomError:function(e,t){try{var n="object"===Me(e)?e:{message:e,name:"[SPREADSHEET API] [UNKOWN]"};n.additional=t,null!==je._getInstance()&&je._getInstance().report(n)}catch(r){}}};function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Be(e,t,n){return t&&qe(e.prototype,t),n&&qe(e,n),e}var He=0,Ge=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timeOut=n||e.TIMEOUT,this.requestId=e.requestCount++,this.callBackName="".concat(e.callbackPrefix).concat(this.requestId),this.query=t.replace("{{callBack}}",this.callBackName),/{{requestId}}/.test(t)&&(this.query=this.query.replace("{{requestId}}",this.requestId))}return Be(e,null,[{key:"callbackPrefix",get:function(){return"__JsonpFetchRequest_cb__.getResponse"}},{key:"requestCount",get:function(){return He},set:function(e){He=e}},{key:"TIMEOUT",get:function(){return 6e4}}]),Be(e,[{key:"send",value:function(){return this._fetchWithTimeout(this.query,this.timeOut).then((function(e){if(200!==e.status)throw 429===e.status?I.d.RESOURCE_EXHAUSTED:e.statusText||e.status;return e.text()})).then(this._parseResponse.bind(this)).catch((function(e){var t=[];return"AbortError"===e.name||e.message&&"Request timed out"===e.message?t.push({message:I.d.REQUEST_TIMEOUT}):t.push({message:e}),{errors:t}}))}},{key:"_parseResponse",value:function(e){if(e.indexOf(this.callBackName)<0)throw"Not a Google Visualization JSONP";var t=e.substring(this._jsonpPosition(e)).slice(0,-2);try{return JSON.parse(t)}catch(n){throw"Unable to parse JSONP response"}}},{key:"_jsonpPosition",value:function(e){return e.indexOf(this.callBackName)+this.callBackName.length+1}},{key:"_fetchWithTimeout",value:function(e,t,n){if("undefined"==typeof AbortController)return new Promise((function(r,o){var i=setTimeout((function(){return o(new Error("Request timed out"))}),t);fetch(e,n).then((function(e){return r(e)}),(function(e){return o(e)})).finally((function(){return clearTimeout(i)}))}));var r=new AbortController,o=r.signal;return setTimeout((function(){return r.abort()}),t),fetch(e,Ue(Ue({},n),{},{signal:o}))}}]),e}(),Ve=n(38);function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){Ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Je(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Je(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Qe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=G.a.SPREADSHEET,this.tools=t,this._useCache=!0,this._accessToken="",this.isAuth=void 0,this._testReq={},this._isPublicSpreadsheet=void 0,this._source=void 0,window.yzxqswi=!0,window.alert=function(){}}var t,n,r;return t=e,r=[{key:"_checkTemporaryQuotaError",value:function(e){return"string"==typeof e&&e in this.ERROR_QUOTA_LIMIT}},{key:"_checkFatalError",value:function(e){return"string"==typeof e&&e in this.ERROR_FATAL}},{key:"_generateUUID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}}],(n=[{key:"_auth",value:function(){var t=this;if(at_debug.log("FETCH_DATA","start AUTH"),this.ready=new Promise((function(e,n){t._authDone_res=e,t._authDone_rej=n})),this._accessToken)return this.isAuth=!0,void this._probeSheetAccess().then((function(e){return t._getData_success(e)})).catch((function(n){at_debug.log("ERROR in _auth",n),t._accessToken="",t.isAuth=!1,e._checkFatalError(n)?t._authDone_rej(n):t._probeSheetAccess().then((function(e){return t._getData_success(e)})).catch((function(n){at_debug.log("ERROR in _auth step 2",n),e._checkFatalError(n)?t._authDone_rej(n):t._isPublicSpreadsheet?t.tools.showError(t._isPublicSpreadsheet,n):t.tools.showManualLogin()}))}));if(this._source.domain&&this.tools.storageAccess){this.ready.then((function(){return t.tools.getUserEmail(t._accessToken)})).then((function(e){var t=localStorage.getItem("hints");t=(t&&-1===t.indexOf(e)?t+",":"")+e,localStorage.setItem("hints",t)})).catch((function(){})),at_debug.log("FETCH_DATA","login with domain");for(var n,r=localStorage.hints&&localStorage.hints.split(",")||[],o=0;o<r.length;o++)if(-1!==r[o].indexOf(this._source.domain)){n=r[o];break}n?(at_debug.log("FETCH_DATA","login with hint: ".concat(n)),this.tools.login({login_hint:n}).then((function(e){return t._accessToken=e&&e.access_token||"",t.isAuth=!0,t._probeSheetAccess()})).then((function(e){return t._getData_success(e)})).catch((function(n){at_debug.log("ERROR in _auth (email)",n),e._checkFatalError(n)?t._authDone_rej(n):(at_debug.error("FETCH_DATA","login with hint failed, retry with no auth"),t._accessToken="",t.isAuth=!1,t._probeSheetAccess().then((function(e){return t._getData_success(e)})).catch((function(n){at_debug.log("ERROR in _auth (email) step 2 ",n),e._checkFatalError(n)?t._authDone_rej(n):t._isPublicSpreadsheet?t.tools.showError(t._isPublicSpreadsheet,n):t.tools.showManualLogin()})))}))):this._loginAuthUser(0)}else this.ready.then((function(){return t.tools.getUserEmail(t._accessToken)})).catch((function(){})),at_debug.log("FETCH_DATA","try public load"),this._probeSheetAccess().then((function(e){return t._getData_success(e)})).catch((function(n){at_debug.log("ERROR in _auth (no domain) ",n),e._checkFatalError(n)?t._authDone_rej(n):(at_debug.log("FETCH_DATA","public load FAIL: data is not accessible"),e._checkTemporaryQuotaError(n)?t.tools.showError(t._isPublicSpreadsheet,n):t._loginAuthUser(0))}))}},{key:"_getSheetData",value:function(e){var t=this,n=e.sheet,r=e.headerRows,o=e.range,i=e.query,a=e.sig,s=e.forceUpdate;i="string"==typeof i?i:"";var u="".concat(this._source.spsUrl,"headers=").concat(r||0,"&range=").concat(encodeURIComponent(o)||"","&sheet=").concat(encodeURIComponent(n)||""),c=u+i;if(this._testReq[c]){if(!s)return Promise.resolve({data:this._testReq[c].data,sig:this._testReq[c].sig});delete this._testReq[c]}var l=u+"&quotaUser=".concat(this._quotaUser())+(this._accessToken?"&access_token=".concat(this._accessToken):"")+(i?"&tq=".concat(encodeURIComponent(i)):"")+"&tqx=reqId%3A{{requestId}}"+(a?";sig%3A".concat(a):"")+";responseHandler%3A{{callBack}}";return new Ge(l,9e4).send().then((function(e){var r=e.errors&&e.errors[0]&&e.errors[0].message;if(r)throw je.sendCustomError({message:r,name:"[GSHEET APIERROR] [_getSheetData]"},"Error for user ".concat(t._isPublicSpreadsheet," for query ").concat(l," on _getSheetData")),r;if(-1!==i.toLowerCase().indexOf("label")){var s=Ye(o.split(":"),2),u=s[0],c=s[1],f=parseInt(u.replace(/[a-zA-Z]*/g,""))+1,d=u.replace(/[0-9]*/g,"")+f+":"+(c.replace(/[0-9]*/g,"")+f),h="".concat(t._source.spsUrl,"headers=1&range=").concat(encodeURIComponent(d)||"","&sheet=").concat(encodeURIComponent(n)||"")+"&quotaUser=".concat(t._quotaUser())+(t._accessToken?"&access_token=".concat(t._accessToken):"")+"&tqx=reqId%3A{{requestId}}"+(a?";sig%3A".concat(a):"")+";responseHandler%3A{{callBack}}";return new Ge(h,9e4).send().then((function(n){if(n.errors){var r=n.errors&&n.errors[0]&&n.errors[0].message;if(r)throw je.sendCustomError({message:r,name:"[GSHEET APIERROR] [_getSheetData label]"},"Error for user ".concat(t._quotaUser()," for query ").concat(h," on _getSheetData")),r}else{var o=n.table.cols.reduce((function(e,t){return ze(ze({},e),{},Ke({},t.id,t.label))}),{});e.table.cols.forEach((function(e){-1===e.label.indexOf(o[e.id])&&(e.label="".concat(e.label," ").concat(o[e.id]))}))}return{data:e.table,sig:e.sig}}))}return{data:e.table,sig:e.sig}}))}},{key:"_getData_success",value:function(e){at_debug.log("FETCH_DATA","auth SUCCESS");var t="".concat(this._source.spsUrl,"headers=2&range=").concat(encodeURIComponent(this._source.dataRange),"&sheet=").concat(encodeURIComponent(this._source.dataSheet));this._testReq[t+this._source.query]={data:e.data,sig:e.sig},this._authDone_res()}},{key:"_loginAuthUser",value:function(t){var n=this;t>=e.AUTH_USER_MAX_TENTATIVES?this._probeSheetAccess().then((function(e){n._getData_success(e)})).catch((function(t){at_debug.log("ERROR in _loginAuthUser ",t),e._checkFatalError(t)?n._authDone_rej(t):(at_debug.log("FETCH_DATA","auth FAILED, waiting for error or manual login if no cache"),n.tools.showError(n._isPublicSpreadsheet,t),n.tools.sendAuthAnalytics("max tentative"))})):(at_debug.log("FETCH_DATA","login with user ".concat(t)),this.tools.login({authUser:t}).then((function(e){return n._accessToken=e&&e.access_token||"",n.isAuth=!0,n._probeSheetAccess()})).then((function(e){n._getData_success(e),n.tools.sendAuthAnalytics(t)})).catch((function(r){at_debug.log("ERROR in tools.login ",r),n._accessToken="",n.isAuth=!1,e._checkFatalError(r)?n._authDone_rej(r):n._isPublicSpreadsheet?n.tools.showError(n._isPublicSpreadsheet,r):n._loginAuthUser(t+1)})))}},{key:"_isSpreadsheetPublic",value:function(e){var t=this;return"boolean"==typeof this._isPublicSpreadsheet?Promise.resolve(this._isPublicSpreadsheet):fetch("https://docs.google.com/spreadsheets/d/".concat(e,"/trash/read?includes_info_params=true"),{method:"HEAD",redirect:"manual"}).then((function(e){return e.status<=200?e.headers.get("content-type")&&e.headers.get("content-type").indexOf("application/json")>=0||!1:t._source.isPublicSps||!1})).catch((function(){return t._source.isPublicSps||!1}))}},{key:"_probeSheetAccess",value:function(){var e=this;return new Promise((function(t,n){e._isSpreadsheetPublic(e._source.spsId).then((function(t){return e._isPublicSpreadsheet=t,at_debug.log("Spreadsheet is "+(t?"public":"private")),e._source.isPublicSps!==t&&e.tools.updateAccess(t),e._probeSheet(e._source.spsId)})).then((function(t){if(t.error&&(je.sendCustomError(ze(ze({},t.error),{},{name:"[GSHEET APIERROR] [_probeSheet]"}),"Status ".concat(t.error.code," (").concat(t.error.status,") for spreadsheet ").concat(e._source.spsId," on probesheet for user ").concat(e._quotaUser())),t.error.status&&t.error.status===I.d.PERMISSION_DENIED))throw I.d.ACCESS_DENIED;return e._getSheetData({sheet:e._source.dataSheet,range:e._source.dataRange,headerRows:2,query:e._source.query,forceUpdate:!0})})).then(t).catch((function(e){at_debug.log("ERROR in _probeSheetAccess",e),n(e)}))}))}},{key:"_quotaUser",value:function(){if(this.tools.storageAccess)try{var t=localStorage.getItem("_QUSER");return t||(t=localStorage.getItem("_BEAMER_USER_ID_".concat(O.a.beamerProductID,"_").concat(O.a.beamerProductID))||e._generateUUID(),localStorage.setItem("_QUSER",t)),t}catch(n){at_debug.error("QUOTA","Unable to access local storage")}return e._generateUUID()}},{key:"_probeSheet",value:function(e){var t=this._quotaUser(),n="https://sheets.googleapis.com/v4/spreadsheets/".concat(e,"?fields=spreadsheetId&quotaUser=").concat(t,"&key=").concat(O.a.probeApiKey);return Ne.a.get(n,{headers:{Authorization:"Bearer ".concat(this._accessToken)}})}},{key:"set",value:function(e){var t=!this._source;this._forceUpdate=e.forceUpdate,this._useCache=e.useCache,e.token&&(this._accessToken=e.token),this._source=new Ve.a(e.sourceSettings),t&&this._auth()}},{key:"getData",value:function(){var t=this;return this.ready.then((function(){return Promise.all([t._getSheetData({sheet:t._source.dataSheet,range:t._source.dataRange,headerRows:2,query:t._source.query,forceUpdate:t._forceUpdate}),t._source.hasTemplate&&t._getSheetData({sheet:t._source.templateSheet,range:t._source.templateRange,headerRows:0,forceUpdate:t._forceUpdate})])})).then((function(n){var r=Ye(n,2),o=r[0],i=r[1];if(!o.data)throw e.ERRORS.NO_DATA_IN_RESPONSE;return ue(o,i,t._source.templateRange)})).catch((function(e){if(!t._forceUpdate)throw e;return t._forceUpdate=!1,t._auth(),t.getData()})).catch((function(e){throw"string"!=typeof e&&(e=I.d.LOADING_ERROR),at_debug.error("FETCH_DATA",e),e}))}},{key:"getCacheKey",value:function(){return this.buildCacheKey(this._source)}},{key:"buildCacheKey",value:function(e){return"".concat(e.spsUrl,"headers=2&range=").concat(e.dataRange||"","&sheet=").concat(e.dataSheet||"")+(e.query?"__"+e.query:"")+(e.templateSheet&&e.templateRange?"__templateSheet=".concat(e.templateSheet,"&templateRange=").concat(e.templateRange):"")}},{key:"onManualLogin",value:function(){var e=this;this.tools.login({authUser:-1,immediate:!1}).then((function(t){e._accessToken=t&&t.access_token||"",e.isAuth=!0,e.tools.loginDone(e.isAuth),e._authDone_res()})).catch((function(t){t.error&&"popup_closed_by_user"===t.error||(e._accessToken="",e.isAuth=!1,e.tools.loginDone(e.isAuth),e._authDone_rej())}))}}])&&$e(t.prototype,n),r&&$e(t,r),e}();Qe.AUTH_USER_MAX_TENTATIVES=6,Qe.ERROR_AUTH=I.a,Qe.ERROR_FATAL=I.b,Qe.ERROR_QUOTA_LIMIT=I.c,Qe.ERRORS={NO_DATA_IN_RESPONSE:"Error: no Data in response"};var Xe,Ze={spreadsheet:Qe,proxy:Ce,aodocs:me,ms_excel:Se};function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=new C,this._ref=window.name,this._queryLogin=new H(this.logger),this._viewId=null,this._sendDataCallBack=null,this.source=void 0,this._listener=this._listener.bind(this),this._onManualLogin=this._onManualLogin.bind(this),this._observe_persistedData=this._observe_persistedData.bind(this),this._cache=new A("awesome-table-db","awesome-table-store",this._observe_persistedData),this._hasLoadedFromCache=!1,window.addEventListener("message",this._listener,!1),document.getElementById("loginBtn").addEventListener("click",this._onManualLogin,!1),this.sendMessage({loaded:!0})}var t,n,i;return t=e,(n=[{key:"_listener",value:function(e){var t=this;if(e.origin===O.a.domainProtocol+O.a.viewDomainHost&&"object"===tt(e.data)&&"ref"in e.data&&e.data.ref===this._ref&&e.data._id&&e.data.msg&&ot[e.data.msg]){var n=function(n){void 0!==n&&t.sendMessage({_id:e.data._id,_res:n})},r=function(){t.sendMessage({_id:e.data._id,_fail:!0})};Promise.resolve().then((function(){return t[ot[e.data.msg]](e.data.data,n,r)})).then(n).catch(r)}}},{key:"sendMessage",value:function(e){e.ref=this._ref,window.parent.postMessage(e,"*")}},{key:"setAuthProvider",value:function(e){document.body.className=e}},{key:"hasNoEmail",value:function(e){var t=this;return Promise.resolve().then((function(){return t._queryLogin.ref.child("views/".concat(e,"/hasEmail")).once("value")})).then((function(){return!1})).catch((function(e){return"PERMISSION_DENIED"===e.code}))}},{key:"getData",value:function(e,t){var n=this;this._sendDataCallBack=t,e.viewId&&(this._viewId=e.viewId),e.initialReferrer&&this.logger.setReferer(e.initialReferrer),this.logger.setInfo({provider:e.sourceSettings.source,appId:this._viewId,referrer:T.a.referrer,appTier:e.appTier,vizType:e.vizType,allowMapsOverusage:e.allowMapsOverusage});var r=Object(R.a)().safari;return this._checkStorageAccess().then((function(o){return!e.sourceSettings.source||n.source&&n.source.name===e.sourceSettings.source||(n.source=new Ze[e.sourceSettings.source]({clearCache:n._cache.clearCacheForKey,login:n._queryLogin.googleLogin(r),getUserEmail:n._getUserEmail.bind(n),loginDone:n._loginDone.bind(n),showManualLogin:n._showManualLogin.bind(n),sendAuthAnalytics:n._sendAuthAnalytics.bind(n),showError:n._showError.bind(n),updateAccess:n._updateSpreadsheetPublic.bind(n),storageAccess:o})),e.useCache&&n._cache.setKey(n.source.buildCacheKey(e.sourceSettings)),n.source.set(e),n.source.getData().then((function(t){e.useCache?n._cache.setData(t):n._sendData(t,!1,!1)})).catch((function(r){r!==I.d.NOT_MODIFIED&&(n.source.ERROR_FATAL&&!(r in n.source.ERROR_FATAL)&&(r=I.d.LOADING_ERROR),at_debug.error("FETCH_DATA",r),t({error:r,useCache:e.useCache,dataFromCache:!1}))}))}))}},{key:"_checkStorageAccess",value:function(){return Promise.resolve().then((function(){if(document.hasStorageAccess)return document.hasStorageAccess().then((function(e){return document.requestStorageAccess().then((function(){return!0})).catch((function(){return at_debug.log("Storage access not accessible"),!1}))}));try{if(void 0===window.localStorage)return!1}catch(e){return!1}return!0}))}},{key:"_sendData",value:function(e,t,n){this._sendDataCallBack&&this._sendDataCallBack({content:e,useCache:t,dataFromCache:n}),this.logger.setDataFetched()}},{key:"_observe_persistedData",value:function(e,t){t&&JSON.stringify(e)===JSON.stringify(t)||(this._hasLoadedFromCache=void 0===t,this._hasLoadedFromCache?at_debug.log("QUERY_FRAME","Have data from cache, sending the data and load to view"):at_debug.log("QUERY_FRAME","Have fresh data, sending the data update the view"),this._sendData(e,!0,void 0===t))}},{key:"_getUserEmail",value:function(e){return this._queryLogin.login(e).then((function(e){return e&&e.providerData&&e.providerData[0].email||null}))}},{key:"_onManualLogin",value:function(){this.source.onManualLogin&&this.source.onManualLogin()}},{key:"_loginDone",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.sendMessage({manualLogin:t,isAuth:e})}},{key:"_updateSpreadsheetPublic",value:function(e){if(this._viewId){at_debug.log("Setting spreadsheet as public = ".concat(e," for view ").concat(this._viewId));try{Object(r.g)("views/".concat(this._viewId,"/settings/source"),{isPublicSps:e})}catch(t){}}}},{key:"_showError",value:function(e,t){var n=t&&(t===I.d.REQUEST_TIMEOUT||t===I.d.RESOURCE_EXHAUSTED);e&&this._hasLoadedFromCache?at_debug.log("QueryFrame","Keeping cache displayed"):e?this.sendMessage({showError:!0,reason:t,isAPILimitation:n}):this._showManualLogin()}},{key:"_showManualLogin",value:function(e){this._hasLoadedFromCache&&this.source&&this._cache.clearCacheForKey(this.source.getCacheKey()),this.sendMessage({showLogin:!0,authSource:e||o.a.GOOGLE})}},{key:"_sendAuthAnalytics",value:function(e){this._authAnalytics||(this._authAnalytics=new E.a("UA-17877121-7","awtDomain"),this._authAnalytics.setCustomD({dimension4:T.a.version,dimension15:O.a.module})),this._authAnalytics.sendStats({hitType:"event",eventCategory:"latestAuth",eventAction:e,eventLabel:O.a.rootDomain})}}])&&nt(t.prototype,n),i&&nt(t,i),e}(),ot=(et(Xe={},D.a.HAS_NO_EMAIL,"hasNoEmail"),et(Xe,D.a.GET_DATA,"getData"),et(Xe,D.a.SET_AUTH_PROVIDER,"setAuthProvider"),Xe),it=rt,at=/(?:^\?|&)debug(?:&|$)/.test(document.location.search);window.at_debug=at?window.console:{log:function(){},error:function(){}},new it},28:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={HAS_NO_EMAIL:"noEmail?",GET_DATA:"getData?",SET_AUTH_PROVIDER:"setAuthProvider?"}},3:function(e,t,n){"use strict";n(68);var r=n(2);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a={VIEW:"view",EDIT:"edit",PRINT:"print",SETTINGS:"settings",QUERY:"query",PICKER:"picker"},s={GADGET:"gadget",IFRAME:"iframe",PRINT:"print",SITE:"site",PREVIEW:"preview"},u=(window.awesomeTable||{}).settings||{},c=document.referrer,l=document.URL;function f(){try{var e=c&&/\/\/[^\/]+?googleusercontent\.com\/gadgets\/ifr\?.*url=[^&]+awesome-table\.xml.*parent=([^?]+?)(?:\?|&.+|$)/.exec(c);if(e&&e[1]){var t=l.match(/https?:\/\/.+?\?(.+)$/);return t=t&&t.length>1?"?"+t[1]:"",e[1]+t}}catch(n){}return""}function d(e){if(!e)return s.SITE;var t=o(/https?:\/\/([^\/]+)?\/([^\/]+)\/(view|print|edit|settings|preview)|(?:\?.+)?/.exec(e),4),n=t[1],i=t[3];return n!==r.a.rootDomainComplete?"":{preview:s.PREVIEW,view:s.SITE,print:s.PRINT,edit:s.PREVIEW,settings:s.PREVIEW}[i]||s.SITE}function h(e){return""===c?l:e===s.GADGET?f():c}var p,m=(p=/https?:\/\/(?:[^\/]+)(?:\/views)?\/(?:(?:[^\/]+)\/(view|edit|settings)|(create))/.exec(document.URL))&&"settings"===p[1]?a.SETTINGS:u.mode,g=function(){var e=u.location;return e?e===s.SITE?""!==f()?s.GADGET:function(){try{if(c){var e=/https?:\/\/([^\/]+)(?:\/views)?\/(?:([^\/]+)\/(view|print|edit|settings)|(create))(?:\?.+)?/.exec(c);if(e&&e[1]===r.a.rootDomainComplete&&"view"===e[3])return!1}return window.self!==window.top}catch(t){return!0}}()?d(c)||s.IFRAME:s.SITE:e:""}(),v=u.version||0,y=h(g).split("?")[0],_=function(e,t,n){var r=e(t),o=function(e){return e.replace(/.+?(?=\?)/,"")},i=function(e,t){return e===t?"":e},a=i(o(r),r);return{originQueryString:i(o(n),n),referrerQueryString:a}}(h,g,l),b=function(e){var t=new URLSearchParams(window.location.search).get(e);try{if(t)return!0;if(""===t)return!0;throw 0}catch(n){return!1}}("atDataSet");"http://localhost:5000"!==window.location.origin&&"https://awesometable-dev-view.firebaseapp.com"!==window.location.origin&&"https://awt-feature-demo-view.firebaseapp.com"!==window.location.origin&&g===s.PREVIEW&&(window.console.log=function(){},window.console.group=function(){}),t.a={get location(){return g},setMode:function(e){m=e},inPreview:function(e){var t=d(e);return t===s.PREVIEW||t===s.PRINT||/^https:\/\/sites\.google\.com\/(site|a\/[^\/]+)\/[^\/]+\/system/.test(e)},get mode(){return m},get version(){return v},get referrer(){return y},get locationParameters(){return""===_.originQueryString?_.referrerQueryString:_.originQueryString},get atDataSet(){return b},MODES:a,LOCATIONS:s,GSITE_NEW:"https://www.google.com/url"}},31:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return d}));var r,o,i,a=n(11),s=n(12);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={MICROSOFT:"MICROSOFT",GOOGLE:"GOOGLE"},l=(u(r={},c.MICROSOFT,c.MICROSOFT.toLowerCase()+".com"),u(r,c.GOOGLE,c.GOOGLE.toLowerCase()+".com"),r),f=(u(o={},c.MICROSOFT.toLowerCase()+".com",c.MICROSOFT),u(o,c.GOOGLE.toLowerCase()+".com",c.GOOGLE),u(i={},c.GOOGLE,{OAUTH_SCOPE_EDIT:s.e,OAUTH_SCOPE_VIEW:s.g,OAUTH_CLIENT_ID:s.d,WEB_SERVICE_URL:s.h,LOGIN_DISPLAY_PARAMS:{name:c.GOOGLE,icon:"awt:google-super-g",msgName:"googleLogin",msgId:"loginWithGoogle"}}),u(i,c.MICROSOFT,{OAUTH_SCOPE_EDIT:a.i,OAUTH_SCOPE_VIEW:a.j,OAUTH_SCOPE_COPY_VIEW:a.h,OAUTH_CLIENT_ID:a.a,OAUTH_PROMPT_MODES:a.g,OAUTH_REDIRECT_URL:a.c,LOGIN_DISPLAY_PARAMS:{name:c.MICROSOFT,icon:"awt:ms-icon",msgName:"msLogin",msgId:"loginWithMicrosoft"}}),i),d=[f[c.GOOGLE].LOGIN_DISPLAY_PARAMS,f[c.MICROSOFT].LOGIN_DISPLAY_PARAMS]},36:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"k",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"i",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return h})),n.d(t,"j",(function(){return p}));var r=n(2),o=firebase.initializeApp({apiKey:r.a.apiKey,authDomain:r.a.authDomain||"".concat(r.a.rootDomain,".firebaseapp.com"),databaseURL:"https://".concat(r.a.rootDomain,".firebaseio.com/")},"at"),i=o.database().ref(),a=firebase.database.ServerValue.TIMESTAMP,s=firebase.auth.GoogleAuthProvider;function u(e){if(!e||0===e.length)throw new Error("scopes needed");for(var t=new firebase.auth.GoogleAuthProvider,n=0;n<e.length;n++)t.addScope(e[n]);return t}var c=function(e){if(!e)throw new Error("firebase database driver need params");var t=e.app,n=e.ref;if(!t||!n)throw new Error("firebase database issue with params");return{read:function(e){return n.child(e).once("value")},set:function(e,t){return n.child(e).set(t)},insert:function(e,t){return n.child(e).push(t)},update:function(e,t){return n.child(e).update(t)},updateRoot:function(e){return n.update(e)},userIdToken:function(){var e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return null===(e=t.auth().currentUser)||void 0===e?void 0:e.getIdToken(n)}}}({app:o,ref:i}),l=c.read,f=c.set,d=(c.insert,c.update),h=c.updateRoot,p=c.userIdToken},37:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.source=r.a.PROXY,this.proxy=t.proxy||"",this.options=t.options||"",this.spsId=t.spsId||"",this.dataSheet=t.dataSheet||"",this.dataRange=t.dataRange||"",this.templateSheet=t.templateSheet||"",this.templateRange=t.templateRange||"",this.query=t.query||"",this.spsUrl=t.spsUrl||"https://docs.google.com/spreadsheets/d/".concat(this.spsId,"/gviz/tq?")}var t,n,i;return t=e,(n=[{key:"_buildProxyUrl",value:function(){var e=this.proxy;return e+="".concat(-1!==e.indexOf("?")?"&":"?","url=").concat(this.spsUrl,"headers=2&range=").concat(this.dataRange,"&sheet=").concat(this.dataSheet).concat(this.options),this.templateSheet&&this.templateRange&&(e+="&templateSheet=".concat(this.templateSheet,"&templateRange=").concat(this.templateRange)),e}},{key:"proxyUrl",get:function(){return this._buildProxyUrl()}}])&&o(t.prototype,n),i&&o(t,i),e}();i.proxy_SourceSettings={key:"proxy",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"proxy"},i.spsId_SourceSettings={key:"spsId",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"spreadsheet-id",label:"SpreadSheet ID"},i.dataSheet_SourceSettings={key:"dataSheet",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"data-sheet-name",label:"Select a Sheet"},i.dataRange_SourceSettings={key:"dataRange",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"data-range",label:"Range"},i.templateSheet_SourceSettings={key:"templateSheet",type:r.c.STRING,defaultValue:"",required:!1,descriptionRef:"data-template-sheet",label:"Template Sheet"},i.templateRange_SourceSettings={key:"templateRange",type:r.c.STRING,defaultValue:"",itemPerRow:2,required:!1,descriptionRef:"data-template-range",label:"Template Range"},i.query_SourceSettings={key:"query",type:r.c.STRING,defaultValue:"",required:!1,descriptionRef:"data-query",label:"Query"},i.spsUrl_SourceSettings={_value:"",key:"spsUrl",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"spreadsheet URL",set:function(e){this._value=e?e.replace(/\/edit.*$/,"/gviz/tq?"):this.defaultValue}},i.default_SourceSettings=[i.proxy_SourceSettings,i.spsId_SourceSettings,i.dataSheet_SourceSettings,i.dataRange_SourceSettings,i.templateSheet_SourceSettings,i.templateRange_SourceSettings,i.spsUrl_SourceSettings,i.query_SourceSettings]},38:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.source=r.a.SPREADSHEET;var n=/https?:\/\/[^\/]*?\/(?:a\/([^\/]+?)\/)?spreadsheets\/d\/([^\/]+?)\/|https?:\/\/[^\/]+?\/(?:a\/([^\/]+?)\/)?spreadsheet\/ccc\?[^\/]*?key=([^\/]+?)(?=#|$|&)/.exec(t.spsUrl||"");this.spsId=t.spsId||n&&n.length&&n[1]||"",this.domain=t.domain||n&&n.length&&n[1]||"",this.dataSheet=t.dataSheet||"",this.dataRange=t.dataRange||"",this.templateSheet=t.templateSheet||"",this.templateRange=t.templateRange||"",this.query=t.query||"",this.isPublicSps=t.isPublicSps||!1,this.spsUrl=t.spsUrl||(this.domain?"https://docs.google.com/a/".concat(this.domain,"/spreadsheets/d/").concat(this.spsId,"/gviz/tq?"):"https://docs.google.com/spreadsheets/d/".concat(this.spsId,"/gviz/tq?"))}var t,n,i;return t=e,(n=[{key:"hasTemplate",get:function(){return!(!this.templateSheet||!this.templateRange)}}])&&o(t.prototype,n),i&&o(t,i),e}();i.spsId_SourceSettings={key:"spsId",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"spreadsheet-id"},i.domain_SourceSettings={key:"domain",type:r.c.STRING,defaultValue:"",required:!1,descriptionRef:"domain"},i.dataSheet_SourceSettings={key:"dataSheet",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"data-sheet-name"},i.dataRange_SourceSettings={key:"dataRange",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"data-range"},i.templateSheet_SourceSettings={key:"templateSheet",type:r.c.STRING,_value:"",defaultValue:"",required:!1,descriptionRef:"template-sheet"},i.templateRange_SourceSettings={key:"templateRange",type:r.c.STRING,defaultValue:"",itemPerRow:2,required:!1,templateRangeClass:"templateRange",descriptionRef:"template-range"},i.query_SourceSettings={key:"query",type:r.c.STRING,defaultValue:"",required:!1,descriptionRef:"query"},i.isPublicSps_SourceSettings={key:"isPublicSps",type:r.c.BOOLEAN,defaultValue:!1,required:!1,descriptionRef:"isPublicSps"},i.spsUrl_SourceSettings={_value:"",key:"spsUrl",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"spreadsheet URL",set:function(e){this._value=e?e.replace(/\/edit.*$/,"/gviz/tq?"):this.defaultValue}},i.proxy_SourceSettings={key:"proxy",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"proxy",label:"Apps Script proxy url"},i.default_SourceSettings=[i.spsId_SourceSettings,i.dataSheet_SourceSettings,i.dataRange_SourceSettings,i.templateSheet_SourceSettings,i.templateRange_SourceSettings,i.query_SourceSettings,i.domain_SourceSettings,i.spsUrl_SourceSettings,i.proxy_SourceSettings,i.isPublicSps_SourceSettings]},45:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(11);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},a=function(){function e(t){var n=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userInfos=function(){return n._call("me")},this.getMySites=function(e){return n._call("sites?search=".concat(e||"*","&$select=name,webUrl,displayName"))},this.workBookWorkSheetsInfos=function(e,t){return n._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets"))},this.getExcelFileName=function(e,t){return n._call("drives/".concat(e,"/items/").concat(t,"?$select=name"))},this.getMySharepointUrl=function(){return i(n,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._call("me/?$select=mySite");case 3:if(200===(t=e.sent).status){e.next=6;break}throw new Error("Issue get my sharepoint "+t.status);case 6:return e.next=8,t.json();case 8:if((n=e.sent).hasOwnProperty("mySite")&&n.mySite){e.next=11;break}return e.abrupt("return",null);case 11:return e.abrupt("return",n.mySite+"Documents/Forms/All.aspx");case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}}),e,this,[[0,14]])})))},this.callGraphEndpoint=function(e){return i(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._graphEndpoint){t.next=6;break}return t.next=3,this._call(e._graphEndpoint);case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,null;case 8:t.t0=t.sent;case 9:return t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this)})))},this.getWorkbook=function(t,r){return i(n,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.t0=e,n.next=4,this._call("drives/".concat(t,"/items/").concat(r));case 4:return n.t1=n.sent,n.abrupt("return",n.t0._buildNewWorkbookItem.call(n.t0,n.t1));case 8:throw n.prev=8,n.t2=n.catch(0),n.t2;case 11:case"end":return n.stop()}}),n,this,[[0,8]])})))},this.userAndSharedWorkBooks=function(){return Promise.all([n.userWorkbooks(),n.sharedWorkbooks()])},this.copyWorkbook=function(e,t,r){return n._call("drives/".concat(t,"/items/").concat(e,"/copy"),"POST",!1,r)},this.uploadWorkbookFromBinaryValue=function(e,t,r,o){return n._call("drives/".concat(e,"/items/").concat(t,":/").concat(encodeURIComponent(n._validateFileName(o)),":/content"),"PUT",!0,r,!1,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")},this._validateFileName=function(e){return e.replace(/[#*<>\/:?]/g,"")},this.retrieveWorkbookAfterCopy=function(e,t){return n._call("drives/".concat(e,"/items/").concat(t))},!t)throw new Error("params needed for graph helper");this.bearerToken=null,this.bearerToken=t.hasOwnProperty("session")&&t.session.hasOwnProperty("access_token")?t.session.access_token:null,this.baseUrl=r.d}var t,n,a;return t=e,a=[{key:"extractDriveAndWorkbookId",value:function(e){var t={driveId:"",workbookId:""},n=e.hasOwnProperty("remoteItem")?e.remoteItem:e;return n.hasOwnProperty("id")&&n.hasOwnProperty("parentReference")&&n.parentReference.hasOwnProperty("driveId")&&(t.driveId=n.parentReference.driveId,t.workbookId=n.id),t}},{key:"_buildGraphEndpoint",value:function(t){var n=e.extractDriveAndWorkbookId(t);return""!==n.driveId&&"drives/".concat(n.driveId,"/items/").concat(n.workbookId)}}],(n=[{key:"photoBlob",value:function(){return this._call("me/photos('48x48')/$value","GET",!1)}},{key:"workbookSheetByWorkbookId",value:function(e,t){return this._call("me/drive/items/".concat(e,"/workbook/worksheets('").concat(t,"')/usedRange"))}},{key:"workBookSheetByDriveAndWorkbookId",value:function(e,t,n,r,o){return r?this._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets('").concat(n,"')/range(address='").concat(r,"')")):this._call("drives/".concat(e,"/items/").concat(t,"/workbook/worksheets('").concat(n,"')/usedRange").concat(o?"?$select=".concat(o):""))}},{key:"workbookSheetByGraphEndpoint",value:function(e,t){return this._call("".concat(e,"/workbook/worksheets('").concat(t,"')/usedRange"))}},{key:"userWorkbooks",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._call("me/drive/root/search(q='.xlsx')");case 2:if((n=t.sent).hasOwnProperty("value")&&n.value&&n.value.length&&n.value.constructor===Array){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",n.value.map((function(t){return e._buildNewWorkbookItem(t)})));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"sharedWorkbooks",value:function(){return i(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._call("me/drive/sharedWithMe");case 2:if((n=t.sent).hasOwnProperty("value")&&n.value&&n.value.length&&n.value.constructor===Array){t.next=5;break}return t.abrupt("return",[]);case 5:return t.abrupt("return",n.value.map((function(t){return e._buildNewWorkbookItem(t)})));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"_call",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5?arguments[5]:void 0;if(!this.bearerToken)throw new Error("Not authenticated");var a={method:t,headers:{"Content-type":i||"application/json",authorization:"Bearer ".concat(this.bearerToken)}};return r&&(a.body=o?JSON.stringify(r):r),fetch("".concat(this.baseUrl).concat(e),a).then((function(e){return n?e.json():e}))}},{key:"bearerToken",get:function(){return this._bearerToken},set:function(e){this._bearerToken=e}}])&&o(t.prototype,n),a&&o(t,a),e}();a._buildNewWorkbookItem=function(e){return Object.assign(Object.assign({},e),{_graphEndpoint:a._buildGraphEndpoint(e),call:function(){return fetch(r.d+a._buildGraphEndpoint(e))}})},t.b=a},46:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return d}));var r=n(0);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){o=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},u=/\D+/,c=/\d+/,l=function(e,t){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function n(){var r,a,c,l,f,d,h,p,m,g,v,y,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e&&t){n.next=2;break}return n.abrupt("return",null);case 2:return r=e.id,a=e.parentReference,n.next=5,t.getWorkbook(a.driveId,r);case 5:return c=n.sent,l=c.webUrl,d=function(e){var t=u.exec(e);return t?t[0]:""},h=function(e){var t=i(e.split(":"),2),n=t[0],r=t[1];return r?[n,d(r)].join(":"):""},p=function(e){return function(t){var n;return o(n={},"".concat(e,"Sheet"),t.name),o(n,"".concat(e,"Range"),h(t.address.split("!")[1])),n}},m=function(e){var t={},n=p("data");if(1===e.length)return n(e[0]);for(var r=0;r<e.length;r++){var o=e[r];if("data"===o.name.toLowerCase())return n(o);"template"!==o.name.toLowerCase()&&void 0===f&&(t=n(o),f=r)}return t},g=function(e){if(1===e.length)return null;for(var t=null,n=p("template"),r=0;r<e.length;r++){var o=e[r];if("template"===o.name.toLowerCase())return n(o);"data"!==o.name.toLowerCase()&&f!==r&&(t=n(o))}return t},v=function(e){return t.workBookSheetByDriveAndWorkbookId(a.driveId,r,e,void 0,"address")},y=function(){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.workBookWorkSheetsInfos(a.driveId,r);case 2:return n=e.sent,o=n.value,e.next=6,Promise.all(o.map((function(e){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Object,t.t1={name:e.name},t.next=4,v(e.name);case 4:return t.t2=t.sent,t.next=7,t.t0.assign.call(t.t0,t.t1,t.t2);case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})))})));case 6:return i=e.sent,e.abrupt("return",{data:m(i),template:g(i)});case 8:case"end":return e.stop()}}),e)})))},_=function(){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return t=e.sent,n=t.data,o=t.template,e.abrupt("return",Object.assign(Object.assign({webUrl:l,driveId:a.driveId,workbookId:r},n),o||{}));case 6:case"end":return e.stop()}}),e)})))},n.abrupt("return",{getViewEditWorkSheetInfo:_,getUsedRangeForWorkSheet:v,createValues:p,id:r,parentReference:a});case 16:case"end":return n.stop()}}),n)})))},f=function e(t,n,r,o,i){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function a(){var s,u;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return s={parentReference:{driveId:n.driveId,id:n.folderId},name:"".concat(r).concat(i?" ("+i+")":"",".xlsx")},a.next=3,o.copyWorkbook(t.id,t.driveId,s);case 3:if(409!==(u=a.sent).status){a.next=8;break}return i||(i=0),i++,a.abrupt("return",e(t,n,r,o,i));case 8:return a.abrupt("return",h(u,n,o));case 9:case"end":return a.stop()}}),a)})))},d=function(e,t,n,o){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function i(){var a,u,c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a="Awesome Table Template ".concat((new Date).toLocaleDateString().replace(/\//g,"-"),".xlsx"),3,u=0,c=function i(){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function s(){var c,l;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,fetch(e).catch((function(e){throw new Error(e)}));case 2:return c=s.sent,s.t0=o,s.t1=t.driveId,s.t2=t.folderId,s.next=8,c.arrayBuffer();case 8:return s.t3=s.sent,s.t4=n,s.next=12,s.t0.uploadWorkbookFromBinaryValue.call(s.t0,s.t1,s.t2,s.t3,s.t4);case 12:if((l=s.sent).id&&l.webUrl){s.next=19;break}if(!(++u<=3)){s.next=18;break}return 3===u&&(n=a),s.abrupt("return",i());case 18:throw"Failed to copy workbook";case 19:return s.abrupt("return",{type:r.a.EXCEL,spsResult:l});case 20:case"end":return s.stop()}}),s)})))},i.next=6,c();case 6:return i.abrupt("return",i.sent);case 7:case"end":return i.stop()}}),i)})))},h=function(e,t,n){return s(void 0,void 0,void 0,regeneratorRuntime.mark((function o(){var i,a,s,u;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=e.headers.get("location"),o.next=3,fetch(i);case 3:return a=o.sent,o.next=6,a.json();case 6:return s=o.sent,o.next=9,n.retrieveWorkbookAfterCopy(t.driveId,s.resourceId);case 9:return u=o.sent,o.abrupt("return",{type:r.a.EXCEL,spsResult:u});case 11:case"end":return o.stop()}}),o)})))}},47:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},48:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.source=r.a.AODOCS,this.source=r.a.AODOCS,this.libraryId=t.libraryId||"",this.domain=t.domain||"",this.views=t.views||{},this.securityCode=t.securityCode||"",this.templateDocId=t.templateDocId||""}var t,n,i;return t=e,(n=[{key:"_buildCacheKey",value:function(){return this.libraryId+Object.keys(this.views).join("")}},{key:"cacheKey",get:function(){return this._buildCacheKey()}}])&&o(t.prototype,n),i&&o(t,i),e}();i.libraryId_SourceSettings={key:"libraryId",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"library-id"},i.securityCode_SourceSettings={key:"",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"security-code"},i.domain_SourceSettings={key:"domain",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"domain"},i.views_SourceSettings={key:"views",type:r.c.LIST,defaultValue:{defaultId:{docClass:"doc class",index:"default index"}},required:!0,descriptionRef:"views"},i.templateDocId_SourceSettings={key:"templateDocId",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"template-doc-id"},i.default_SourceSettings=[i.domain_SourceSettings,i.libraryId_SourceSettings,i.securityCode_SourceSettings,i.templateDocId_SourceSettings,i.views_SourceSettings]},49:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);var o=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.source=r.a.EXCEL,this.source=r.a.EXCEL,this.workbookId=t.workbookId||"",this.dataSheet=t.dataSheet||"",this.dataRange=t.dataRange||"",this.templateSheet=t.templateSheet||"",this.templateRange=t.templateRange||"",this.driveId=t.driveId||"",this.webUrl=t.webUrl||""};o.workbookId_SourceSettings={key:"workbookId",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"workbook-id"},o.dataSheet_SourceSettings={key:"dataSheet",type:r.c.STRING,defaultValue:"Data",required:!0,descriptionRef:"data-sheet-name",label:"Data Sheet"},o.dataRange_SourceSettings={key:"dataRange",type:r.c.STRING,defaultValue:"",required:!1,descriptionRef:"data-range"},o.templateSheet_SourceSettings={key:"templateSheet",type:r.c.STRING,defaultValue:"",required:!1,descriptionRef:"template-sheet"},o.templateRange_SourceSettings={key:"templateRange",type:r.c.STRING,defaultValue:"",itemPerRow:2,required:!1,descriptionRef:"template-range"},o.driveId_SourceSettings={key:"driveId",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"driveId"},o.webUrl_SourceSettings={key:"webUrl",type:r.c.STRING,defaultValue:"",required:!0,descriptionRef:"workbook-web-url"},o.default_SourceSettings=[o.webUrl_SourceSettings,o.driveId_SourceSettings,o.workbookId_SourceSettings,o.dataRange_SourceSettings,o.dataSheet_SourceSettings,o.templateSheet_SourceSettings,o.templateRange_SourceSettings]},58:function(e,t,n){"use strict";function r(e){return new Promise((function(t,n){e.then(t,n)}))}n.d(t,"a",(function(){return p}));var o=n(27),i=n.n(o),a=n(31),s=n(12),u=n(11),c=n(2).b.ms_oauth_proxy_url;function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(){var e,t=(l(e={},u.e,u.a),l(e,s.b,s.d),e),n=l({},u.e,{base:u.d,get:{driveId:"me/drive",me:"me",sharedSheet:"users/@{userId}/drive/items/{@workbookId}/worksheets('@{sheetName}')/usedRange",sheet:"me/drive/items/@{workbookId}/workbook/worksheets('@{sheetName}')/usedRange?$select=values",sheetsList:"me/drive/root/search(q='.xlsx')?select=name,id,webUrl"},name:"".concat(u.e," ").concat(u.b),oauth:{auth:u.f.AUTH,grant:u.f.GRANT,response_type:"code",version:2},scope_delim:" ",xhr:function(e){var t=e.query.access_token;return delete e.query.access_token,t&&(e.headers=Object.assign(Object.assign({},e.headers),{Authorization:"Bearer ".concat(t)})),!0}}),r={response_type:"code",oauth_proxy:c,redirect_uri:a.b.MICROSOFT.OAUTH_REDIRECT_URL};i.a.init(t,r),i.a.init(n);var o=window.at_debug;return o&&(i.a.on("auth",(function(){o.log("HelloJS on auth")})),i.a.on("auth.init",(function(){o.log("HelloJS on auth.init")})),i.a.on("auth.login",(function(){o.log("HelloJS on auth.login")})),i.a.on("auth.logout",(function(){o.log("HelloJS on auth.logout")})),i.a.on("auth.update",(function(){o.log("HelloJS on auth.update")}))),i.a}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},p=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._login=function(e){return h(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(f(this.networkName).login(e)));case 1:case"end":return t.stop()}}),t,this)})))},this._logout=function(){return r(f(t.networkName).logout())},this._onLogin=function(e){return f.on("auth.login",e)},this.api=function(e){if(!e)throw new Error("API name is missing");return r(f(t.networkName).api(e))},this.isTokenStillValid=function(e){return Boolean(e&&e.access_token&&e.expires>(new Date).getTime()/1e3)}}var t,n,o;return t=e,(n=[{key:"hasValidSession",value:function(){var e=this.getSession();return!!this.isTokenStillValid(e)&&e}},{key:"getSession",value:function(){return f(this.networkName).getAuthResponse()}},{key:"token",get:function(){var e;return null===(e=this.getSession())||void 0===e?void 0:e.access_token}}])&&d(t.prototype,n),o&&d(t,o),e}()},59:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(97),o=n.n(r);function i(){var e=o.a.getParser(window.navigator.userAgent);return{safari:"safari"===e.getBrowserName(!0),chrome:"chrome"===e.getBrowserName(!0),firefox:"firefox"===e.getBrowserName(!0)}}},60:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(12),o=n(58);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(s,e);var t,n,o,i=f(s);function s(){var e;return u(this,s),(e=i.apply(this,arguments)).networkName=r.b,e.onLogin=function(t){e._onLogin(t)},e.logout=function(){return e._logout()},e}return t=s,(n=[{key:"login",value:function(e,t){return p(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,i,s,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(o=this.hasValidSession())){n.next=3;break}return n.abrupt("return",o);case 3:if(i=void 0!==(null==e?void 0:e.authUser)?e.authUser:-1,s=i>-1||1==t?{display:"none",prompt:"none"}:{prompt:"consent"},void 0!==(null==e?void 0:e.immediate)&&delete e.immediate,!e||"number"!=typeof i){n.next=15;break}if(delete e.authUser,-1===i){n.next=12;break}e.authuser=i,n.next=15;break;case 12:if(!this.getSession()){n.next=15;break}return n.next=15,this.logout().catch((function(e){}));case 15:return u=Object.assign(Object.assign(Object.assign(Object.assign({},s),{scope:[].concat(a(r.g),[r.f]),response_type:"code"}),e),{access_type:"offline"}),n.abrupt("return",this._login(u).then((function(e){if(!e.authResponse)throw"Issue while login with Hello JS";return e.authResponse})));case 17:case"end":return n.stop()}}),n,this)})))}}])&&c(t.prototype,n),o&&c(t,o),s}(o.a)},67:function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(69),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(14))},68:function(e,t,n){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){"use strict";var n,r=e.URLSearchParams&&e.URLSearchParams.prototype.get?e.URLSearchParams:null,o=r&&"a=1"===new r({a:1}).toString(),i=r&&"+"===new r("s=%2B").get("s"),a=!r||((n=new r).append("s"," &"),"s=+%26"===n.toString()),s=f.prototype,u=!(!e.Symbol||!e.Symbol.iterator);if(!(r&&o&&i&&a)){s.append=function(e,t){g(this.__URLSearchParams__,e,t)},s.delete=function(e){delete this.__URLSearchParams__[e]},s.get=function(e){var t=this.__URLSearchParams__;return this.has(e)?t[e][0]:null},s.getAll=function(e){var t=this.__URLSearchParams__;return this.has(e)?t[e].slice(0):[]},s.has=function(e){return y(this.__URLSearchParams__,e)},s.set=function(e,t){this.__URLSearchParams__[e]=[""+t]},s.toString=function(){var e,t,n,r,o=this.__URLSearchParams__,i=[];for(t in o)for(n=d(t),e=0,r=o[t];e<r.length;e++)i.push(n+"="+d(r[e]));return i.join("&")};var c=!!i&&r&&!o&&e.Proxy;Object.defineProperty(e,"URLSearchParams",{value:c?new Proxy(r,{construct:function(e,t){return new e(new f(t[0]).toString())}}):f});var l=e.URLSearchParams.prototype;l.polyfill=!0,l.forEach=l.forEach||function(e,t){var n=m(this.toString());Object.getOwnPropertyNames(n).forEach((function(r){n[r].forEach((function(n){e.call(t,n,r,this)}),this)}),this)},l.sort=l.sort||function(){var e,t,n,r=m(this.toString()),o=[];for(e in r)o.push(e);for(o.sort(),t=0;t<o.length;t++)this.delete(o[t]);for(t=0;t<o.length;t++){var i=o[t],a=r[i];for(n=0;n<a.length;n++)this.append(i,a[n])}},l.keys=l.keys||function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},l.values=l.values||function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},l.entries=l.entries||function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},u&&(l[e.Symbol.iterator]=l[e.Symbol.iterator]||l.entries)}function f(e){((e=e||"")instanceof URLSearchParams||e instanceof f)&&(e=e.toString()),this.__URLSearchParams__=m(e)}function d(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'\(\)~]|%20|%00/g,(function(e){return t[e]}))}function h(e){return e.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,(function(e){return decodeURIComponent(e)}))}function p(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return u&&(n[e.Symbol.iterator]=function(){return n}),n}function m(e){var n={};if("object"===t(e))if(v(e))for(var r=0;r<e.length;r++){var o=e[r];if(!v(o)||2!==o.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");g(n,o[0],o[1])}else for(var i in e)e.hasOwnProperty(i)&&g(n,i,e[i]);else{0===e.indexOf("?")&&(e=e.slice(1));for(var a=e.split("&"),s=0;s<a.length;s++){var u=a[s],c=u.indexOf("=");-1<c?g(n,h(u.slice(0,c)),h(u.slice(c+1))):u&&g(n,h(u),"")}}return n}function g(e,t,n){var r="string"==typeof n?n:null!=n&&"function"==typeof n.toString?n.toString():JSON.stringify(n);y(e,t)?e[t].push(r):e[t]=[r]}function v(e){return!!e&&"[object Array]"===Object.prototype.toString.call(e)}function y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(void 0!==e?e:"undefined"!=typeof window?window:this)}).call(this,n(14))},69:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,o,i,a,s,u=1,c={},l=!1,f=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):f&&"onreadystatechange"in f.createElement("script")?(o=f.documentElement,r=function(e){var t=f.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return c[u]=o,r(u),u++},d.clearImmediate=h}function h(e){delete c[e]}function p(e){if(l)setTimeout(p,0,e);else{var t=c[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{h(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(14),n(10))},7:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r={REQUEST_TIMEOUT:"REQUEST_TIMEOUT",ACCESS_DENIED:"ACCESS_DENIED",LOADING_ERROR:"LOADING_ERROR",INVALID_QUERY:"INVALID_QUERY",INVALID_RANGE:"INVALID_RANGE",PERMISSION_DENIED:"PERMISSION_DENIED",NOT_MODIFIED:"NOT_MODIFIED",RESOURCE_EXHAUSTED:"RESOURCE_EXHAUSTED",VIEW_CANT_LOAD:"VIEW_CANT_LOAD"},o={ACCESS_DENIED:r.ACCESS_DENIED,LOADING_ERROR:r.LOADING_ERROR},i={INVALID_RANGE:r.INVALID_RANGE,INVALID_QUERY:r.INVALID_QUERY,REQUEST_TIMEOUT:r.REQUEST_TIMEOUT},a={RESOURCE_EXHAUSTED:r.RESOURCE_EXHAUSTED,REQUEST_TIMEOUT:r.REQUEST_TIMEOUT};t.d=r},9:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));var r="<style>",o="<script>",i="<global_html>",a="<simple_template></simple_template>",s="GeoChartOptions",u=/chartOptions\((.*)\)/},91:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f}));var r=n(11),o=n(45),i=n(46),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},s="".concat(window.location.origin,"/ms_picker"),u="Issue with One Drive SDK",c=function(e){return function(t){e&&e(t)}},l=function(e,t){var n,l,f={accountSwitchEnabled:!1,action:"query",clientId:r.a,multiSelect:!1,advanced:{redirectUri:s}},d=(n=e.success,l=e.error,function(e){return a(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var r,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.accessToken&&e.value.length){t.next=2;break}return t.abrupt("return",l(new Error(u)));case 2:return r=new o.b({session:{access_token:e.accessToken}}),t.next=5,Object(i.c)(e.value[0],r);case 5:if(a=t.sent){t.next=8;break}return t.abrupt("return",l(new Error(u)));case 8:return t.next=10,a.getViewEditWorkSheetInfo();case 10:return(s=t.sent)||l(new Error("Error with file")),t.abrupt("return",n(Object.assign(Object.assign({},s),{accessToken:e.accessToken})));case 13:case"end":return t.stop()}}),t)})))});t&&t.trueRender&&(d=function(e,t){return function(n){return n.value.length?n.value[0].folder?e({accessToken:n.accessToken,folder:{folderId:n.value[0].id,driveId:n.value[0].parentReference.driveId}}):e({accessToken:n.accessToken,file:n.value[0]}):t(new Error(u))}}(e.success,e.error));var h=Object.assign(Object.assign(Object.assign({},f),e),{error:c(e.error),success:d});OneDrive.open(h)},f=function(){localStorage.removeItem("odpickerv7cache")}},92:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return l}));var r=n(59),o=n(60),i={};function a(e){return function(t){new Promise((function(t,n){window.gapi||n(u.GAPI_NOT_LOADED),window.gapi.load(e,t)})).then((function(){i[e]=Promise.resolve(window.gapi[e]),t(i[e])}))}}var s={get client(){return i.client||new Promise(a("client"))},get auth(){return i.auth||new Promise(a("auth"))},load:function(e){return new Promise((function(t,n){window.gapi||n(u.GAPI_NOT_LOADED),window.gapi.load(e,{callback:t})}))}},u={GAPI_NOT_LOADED:"gapi not loaded"},c=function(e){return Object(r.a)().safari?(new o.a).login({login_hint:e.login_hint},!0).then((function(e){var t=gapi.client.setToken;return(null==e?void 0:e.access_token)&&t({access_token:e.access_token}),e})):s.auth.then((function(t){return new Promise((function(n){return new Promise((function(r,o){var i=setTimeout((function(){return n()}),1e4);t.authorize(e,(function(e){clearTimeout(i),r(n(e))}))}))}))}))},l=function(e,t,n){var r={client_id:t,scope:Array.isArray(n)?n.join(" "):n};return r.immediate=!("immediate"in e)||e.immediate,"login_hint"in e?(r.authuser=-1,r.login_hint=e.login_hint):"authUser"in e&&(r.authuser=e.authUser,!1===r.immediate&&-1===r.authuser&&(delete r.immediate,r.prompt="select_account")),c(r).then((function(e){if(!e.access_token)throw e;return e}))}},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(31),o=n(58),i=n(11),a=n(45),s=n(91);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(d,e);var t,n,o,u=f(d);function d(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),(e=u.call(this)).networkName=i.e,e.userInformation=function(){return m(h(e),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.graph.userInfos();case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})))},e.onLogin=function(t){e._onLogin(t)},e._graph=null,e}return t=d,(n=[{key:"getDriveId",value:function(){return this.api("driveId")}},{key:"login",value:function(e,t){var n=e?{display:"none",force:!0,prompt:"none"}:{},o=Object.assign(Object.assign(Object.assign({},n),{scope:r.b.MICROSOFT.OAUTH_SCOPE_EDIT}),t);return this._login(o)}},{key:"logout",value:function(e){return m(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._logout();case 2:return t=e.sent,delete this._graph,this._graph=null,Object(s.b)(),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"graph",get:function(){return!this._graph&&this.token?(this._graph=new a.a({session:this.getSession()}),this._graph):this.hasValidSession()?(this._graph.bearerToken||this._graph.bearerToken===this.token||(delete this._graph,this._graph=new a.a({session:this.getSession()})),this._graph):null}}])&&c(t.prototype,n),o&&c(t,o),d}(o.a);t.b=g;new g},97:function(e,t,n){(function(e){var n,r,o,i;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==a(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),o=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var o=e.getVersionPrecision(t),i=e.getVersionPrecision(n),a=Math.max(o,i),s=0,u=e.map([t,n],(function(t){var n=a-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=a-Math.min(o,i)),a-=1;a>=s;){if(u[0][a]>u[1][a])return 1;if(u[0][a]===u[1][a]){if(a===s)return 0;a-=1}else if(u[0][a]<u[1][a])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var o=e[n];if(t(o,n))return o}},e.assign=function(e){for(var t,n,r=e,o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var u=function(){var e=i[t];"object"==a(e)&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=i.length;t<n;t+=1)u();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=o,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(91))&&r.__esModule?r:{default:r},i=n(18);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){}var t,n;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new o.default(e,t)},e.parse=function(e){return new o.default(e).getResult()},t=e,(n=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}])&&a(t,n),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=c(n(92)),o=c(n(93)),i=c(n(94)),s=c(n(95)),u=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=u.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=u.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=u.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=u.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return u.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,o={},i=0;if(Object.keys(e).forEach((function(t){var s=e[t];"string"==typeof s?(o[t]=s,i+=1):"object"==a(s)&&(n[t]=s,r+=1)})),r>0){var s=Object.keys(n),c=u.default.find(s,(function(e){return t.isOS(e)}));if(c){var l=this.satisfies(n[c]);if(void 0!==l)return l}var f=u.default.find(s,(function(e){return t.isPlatform(e)}));if(f){var d=this.satisfies(n[f]);if(void 0!==d)return d}}if(i>0){var h=Object.keys(o),p=u.default.find(h,(function(e){return t.isBrowser(e,!0)}));if(void 0!==p)return this.compareVersion(o[p])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),o=u.default.getBrowserTypeByAlias(r);return t&&o&&(r=o.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,o=this.getBrowserVersion();if("string"==typeof o)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(u.default.compareVersions(o,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=l,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=o.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=o.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=o.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=o.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=o.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=o.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=o.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=o.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=o.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=o.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=o.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=o.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=o.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=o.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=o.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=o.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=o.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=o.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=o.default.getFirstMatch(i,e)||o.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=o.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=o.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=o.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=o.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=o.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=o.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=o.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=o.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=o.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=o.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:o.default.getFirstMatch(t,e),version:o.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=o.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=o.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=o.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=o.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},n=o.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=o.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=o.default.getMacOSVersionName(t),r={name:i.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=o.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=o.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=o.default.getAndroidVersionName(t),r={name:i.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=o.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:i.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=o.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||o.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||o.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=o.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=o.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=o.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=o.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=o.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,o=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=o.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},n=o.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},n=o.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},n=o.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},n=o.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=a,e.exports=t.default}})},"object"==a(t)&&"object"==a(e)?e.exports=i():(r=[],void 0===(o="function"==typeof(n=i)?n.apply(t,r):n)||(e.exports=o))}).call(this,n(47)(e))}});